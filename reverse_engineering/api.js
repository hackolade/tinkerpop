"use strict";var bw=Object.create;var br=Object.defineProperty;var ww=Object.getOwnPropertyDescriptor;var mw=Object.getOwnPropertyNames;var _w=Object.getPrototypeOf,Sw=Object.prototype.hasOwnProperty;var o=(t,e)=>br(t,"name",{value:e,configurable:!0});var ie=(t,e)=>()=>(t&&(e=t(t=0)),e);var m=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Xu=(t,e)=>{for(var r in e)br(t,r,{get:e[r],enumerable:!0})},Ju=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of mw(e))!Sw.call(t,i)&&i!==r&&br(t,i,{get:()=>e[i],enumerable:!(n=ww(e,i))||n.enumerable});return t};var Pe=(t,e,r)=>(r=t!=null?bw(_w(t)):{},Ju(e||!t||!t.__esModule?br(r,"default",{value:t,enumerable:!0}):r,t)),Ew=t=>Ju(br({},"__esModule",{value:!0}),t);var Zu=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var Fe=(t,e,r)=>(Zu(t,e,"read from private field"),r?r.call(t):e.get(t)),Ge=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)};var ot=(t,e,r)=>(Zu(t,e,"access private method"),r);var me=m((RT,ef)=>{"use strict";var xw=Object.freeze({value:null,done:!0}),vw=Symbol.asyncIterator||Symbol("@@asyncIterator"),Rs=class Rs{constructor(e,r,n){this.graph=e,this.traversalStrategies=r,this.bytecode=n,this.traversers=null,this.sideEffects=null,this._traversalStrategiesPromise=null,this._traversersIteratorIndex=0}[vw](){return this}getBytecode(){return this.bytecode}toList(){return this._applyStrategies().then(()=>{let e=[],r;for(;(r=this._getNext())&&!r.done;)e.push(r.value);return e})}hasNext(){return this._applyStrategies().then(()=>this.traversers&&this.traversers.length>0&&this._traversersIteratorIndex<this.traversers.length&&this.traversers[this._traversersIteratorIndex].bulk>0)}iterate(){return this.bytecode.addStep("none"),this._applyStrategies().then(()=>{let e;for(;(e=this._getNext())&&!e.done;);})}next(){return this._applyStrategies().then(()=>this._getNext())}_getNext(){for(;this.traversers&&this._traversersIteratorIndex<this.traversers.length;){let e=this.traversers[this._traversersIteratorIndex];if(e.bulk>0)return e.bulk--,{value:e.object,done:!1};this._traversersIteratorIndex++}return xw}_applyStrategies(){return this._traversalStrategiesPromise?this._traversalStrategiesPromise:this._traversalStrategiesPromise=this.traversalStrategies.applyStrategies(this)}toJSON(){return this.bytecode.stepInstructions}toString(){return this.bytecode.toString()}};o(Rs,"Traversal");var xs=Rs,As=class As{static get graphml(){return"graphml"}static get graphson(){return"graphson"}static get gryo(){return"gryo"}static get reader(){return"~tinkerpop.io.reader"}static get registry(){return"~tinkerpop.io.registry"}static get writer(){return"~tinkerpop.io.writer"}};o(As,"IO");var vs=As,He=class He{constructor(e,r,n){this.operator=e,this.value=r,this.other=n}toString(){function e(r){if(Array.isArray(r)){let n=[];for(let i of r)n.push(e(i));return n}return r&&typeof r=="string"?`'${r}'`:r}return o(e,"formatValue"),this.other===void 0||this.other===null?this.operator+"("+e(this.value)+")":this.operator+"("+e(this.value)+", "+e(this.other)+")"}and(e){return new He("and",this,e)}or(e){return new He("or",this,e)}static within(...e){return e.length===1&&Array.isArray(e[0])?new He("within",e[0],null):new He("within",e,null)}static without(...e){return e.length===1&&Array.isArray(e[0])?new He("without",e[0],null):new He("without",e,null)}static between(...e){return Ae("between",e)}static eq(...e){return Ae("eq",e)}static gt(...e){return Ae("gt",e)}static gte(...e){return Ae("gte",e)}static inside(...e){return Ae("inside",e)}static lt(...e){return Ae("lt",e)}static lte(...e){return Ae("lte",e)}static neq(...e){return Ae("neq",e)}static not(...e){return Ae("not",e)}static outside(...e){return Ae("outside",e)}static test(...e){return Ae("test",e)}};o(He,"P");var Bt=He;function Ae(t,e){return e.unshift(null,t),new(Function.prototype.bind.apply(Bt,e))}o(Ae,"createP");var Os=class Os{constructor(e,r,n){this.operator=e,this.value=r,this.other=n}toString(){function e(r){return r&&typeof r=="string"?`'${r}'`:r}return o(e,"formatValue"),this.other===void 0?this.operator+"("+e(this.value)+")":this.operator+"("+e(this.value)+", "+e(this.other)+")"}and(e){return new Bt("and",this,e)}or(e){return new Bt("or",this,e)}static containing(...e){return at("containing",e)}static endingWith(...e){return at("endingWith",e)}static notContaining(...e){return at("notContaining",e)}static notEndingWith(...e){return at("notEndingWith",e)}static notStartingWith(...e){return at("notStartingWith",e)}static startingWith(...e){return at("startingWith",e)}static regex(...e){return at("regex",e)}static notRegex(...e){return at("notRegex",e)}};o(Os,"TextP");var Zn=Os;function at(t,e){return e.unshift(null,t),new(Function.prototype.bind.apply(Zn,e))}o(at,"createTextP");var zs=class zs{constructor(e,r){this.object=e,this.bulk=r||1}};o(zs,"Traverser");var Ts=zs,Ns=class Ns{};o(Ns,"TraversalSideEffects");var Is=Ns,Tw={tokens:"~tinkerpop.valueMap.tokens",none:0,ids:1,labels:2,keys:4,values:8,all:15,indexer:"~tinkerpop.index.indexer",list:0,map:1};function ye(t,e){let r={};return e.split(" ").forEach(n=>{let i=n;i===i.toUpperCase()&&(i=i.toLowerCase()),r[i]=new Qn(t,n)}),r}o(ye,"toEnum");var Qu={from_:"out",to:"in"};function Iw(t,e){let r=ye(t,e);return Object.keys(Qu).forEach(n=>{r[n]=r[Qu[n]]}),r}o(Iw,"toDirectionEnum");var ks=class ks{constructor(e,r){this.typeName=e,this.elementName=r}toString(){return this.elementName}};o(ks,"EnumValue");var Qn=ks;ef.exports={EnumValue:Qn,P:Bt,TextP:Zn,withOptions:Tw,IO:vs,Traversal:xs,TraversalSideEffects:Is,Traverser:Ts,barrier:ye("Barrier","normSack"),cardinality:ye("Cardinality","list set single"),column:ye("Column","keys values"),direction:Iw("Direction","BOTH IN OUT from_ to"),dt:ye("DT","second minute hour day"),graphSONVersion:ye("GraphSONVersion","V1_0 V2_0 V3_0"),gryoVersion:ye("GryoVersion","V1_0 V3_0"),merge:ye("Merge","onCreate onMatch outV inV"),operator:ye("Operator","addAll and assign div max min minus mult or sum sumLong"),order:ye("Order","asc desc shuffle"),pick:ye("Pick","any none"),pop:ye("Pop","all first last mixed"),scope:ye("Scope","global local"),t:ye("T","id key label value")}});var Ye=m((OT,tf)=>{"use strict";var Ps=me().Traversal,co=class co{constructor(e){e?this.strategies=[...e.strategies]:this.strategies=[]}addStrategy(e){this.strategies.push(e)}removeStrategy(e){let r=this.strategies.findIndex(n=>n.fqcn===e.fqcn);if(r!==-1)return this.strategies.splice(r,1)[0]}applyStrategies(e){return this.strategies.reduce((r,n)=>r.then(()=>n.apply(e)),Promise.resolve())}};o(co,"TraversalStrategies");var Ds=co,uo=class uo{constructor(e,r={}){this.fqcn=e,this.configuration=r}apply(e){}};o(uo,"TraversalStrategy");var q=uo,fo=class fo extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.ConnectiveStrategy")}};o(fo,"ConnectiveStrategy");var Cs=fo,ho=class ho extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.ElementIdStrategy")}};o(ho,"ElementIdStrategy");var Ls=ho,po=class po extends q{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.HaltedTraverserStrategy"),e!==void 0&&(this.configuration.haltedTraverserFactory=e)}};o(po,"HaltedTraverserStrategy");var qs=po,go=class go extends q{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.OptionsStrategy",e)}};o(go,"OptionsStrategy");var Bs=go,yo=class yo extends q{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.PartitionStrategy",e)}};o(yo,"PartitionStrategy");var Ms=yo,bo=class bo extends q{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.SubgraphStrategy",e),this.configuration.vertices instanceof Ps&&(this.configuration.vertices=this.configuration.vertices.bytecode),this.configuration.edges instanceof Ps&&(this.configuration.edges=this.configuration.edges.bytecode),this.configuration.vertexProperties instanceof Ps&&(this.configuration.vertexProperties=this.configuration.vertexProperties.bytecode)}};o(bo,"SubgraphStrategy");var Us=bo,wo=class wo extends q{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.ProductiveByStrategy",e)}};o(wo,"ProductiveByStrategy");var js=wo,mo=class mo extends q{constructor(e){super("org.apache.tinkerpop.gremlin.process.computer.traversal.strategy.decoration.VertexProgramStrategy",e)}};o(mo,"VertexProgramStrategy");var Vs=mo,_o=class _o extends q{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.finalization.MatchAlgorithmStrategy"),e!==void 0&&(this.configuration.matchAlgorithm=e)}};o(_o,"MatchAlgorithmStrategy");var $s=_o,So=class So extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.AdjacentToIncidentStrategy")}};o(So,"AdjacentToIncidentStrategy");var Ws=So,Eo=class Eo extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.FilterRankingStrategy")}};o(Eo,"FilterRankingStrategy");var Fs=Eo,xo=class xo extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.IdentityRemovalStrategy")}};o(xo,"IdentityRemovalStrategy");var Gs=xo,vo=class vo extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.IncidentToAdjacentStrategy")}};o(vo,"IncidentToAdjacentStrategy");var Hs=vo,To=class To extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.InlineFilterStrategy")}};o(To,"InlineFilterStrategy");var Ys=To,Io=class Io extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.LazyBarrierStrategy")}};o(Io,"LazyBarrierStrategy");var Ks=Io,Ro=class Ro extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.MatchPredicateStrategy")}};o(Ro,"MatchPredicateStrategy");var Xs=Ro,Ao=class Ao extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.OrderLimitStrategy")}};o(Ao,"OrderLimitStrategy");var Js=Ao,Oo=class Oo extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.PathProcessorStrategy")}};o(Oo,"PathProcessorStrategy");var Zs=Oo,zo=class zo extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.PathRetractionStrategy")}};o(zo,"PathRetractionStrategy");var Qs=zo,No=class No extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.CountStrategy")}};o(No,"CountStrategy");var eo=No,ko=class ko extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.RepeatUnrollStrategy")}};o(ko,"RepeatUnrollStrategy");var to=ko,Po=class Po extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.GraphFilterStrategy")}};o(Po,"GraphFilterStrategy");var ro=Po,Do=class Do extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.EarlyLimitStrategy")}};o(Do,"EarlyLimitStrategy");var no=Do,Co=class Co extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.verification.LambdaRestrictionStrategy")}};o(Co,"LambdaRestrictionStrategy");var io=Co,Lo=class Lo extends q{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.verification.ReadOnlyStrategy")}};o(Lo,"ReadOnlyStrategy");var so=Lo,qo=class qo extends q{constructor(e=!1,r=!1){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.verification.EdgeLabelVerificationStrategy",{logWarnings:e,throwException:r})}};o(qo,"EdgeLabelVerificationStrategy");var oo=qo,Bo=class Bo extends q{constructor(e=!1,r=!1,n=["id","label"]){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.verification.ReservedKeysVerificationStrategy",{logWarnings:e,throwException:r,keys:n})}};o(Bo,"ReservedKeysVerificationStrategy");var ao=Bo,Mo=class Mo extends q{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.SeedStrategy",{seed:e.seed})}};o(Mo,"SeedStrategy");var lo=Mo;tf.exports={TraversalStrategies:Ds,TraversalStrategy:q,ConnectiveStrategy:Cs,ElementIdStrategy:Ls,HaltedTraverserStrategy:qs,OptionsStrategy:Bs,PartitionStrategy:Ms,SeedStrategy:lo,SubgraphStrategy:Us,VertexProgramStrategy:Vs,MatchAlgorithmStrategy:$s,AdjacentToIncidentStrategy:Ws,FilterRankingStrategy:Fs,IdentityRemovalStrategy:Gs,IncidentToAdjacentStrategy:Hs,InlineFilterStrategy:Ys,LazyBarrierStrategy:Ks,MatchPredicateStrategy:Xs,OrderLimitStrategy:Js,PathProcessorStrategy:Zs,PathRetractionStrategy:Qs,ProductiveByStrategy:js,CountStrategy:eo,RepeatUnrollStrategy:to,GraphFilterStrategy:ro,EarlyLimitStrategy:no,EdgeLabelVerificationStrategy:oo,LambdaRestrictionStrategy:io,ReadOnlyStrategy:so,ReservedKeysVerificationStrategy:ao}});var wr=m((NT,rf)=>{"use strict";var Rw=me(),Aw=Ye().TraversalStrategy,$o=class $o{constructor(e,r={}){this.url=e,this.options=r}open(){throw new Error("open() must be implemented")}get isOpen(){throw new Error("isOpen() must be implemented")}get isSessionBound(){return!1}submit(e){throw new Error("submit() must be implemented")}createSession(){throw new Error("createSession() must be implemented")}commit(){throw new Error("commit() must be implemented")}rollback(){throw new Error("rollback() must be implemented")}close(){throw new Error("close() must be implemented")}};o($o,"RemoteConnection");var Uo=$o,Wo=class Wo extends Rw.Traversal{constructor(e,r){super(null,null,null),this.traversers=e,this.sideEffects=r}};o(Wo,"RemoteTraversal");var jo=Wo,Fo=class Fo extends Aw{constructor(e){super("js:RemoteStrategy"),this.connection=e}apply(e){return e.traversers?Promise.resolve():this.connection.submit(e.getBytecode()).then(function(r){e.sideEffects=r.sideEffects,e.traversers=r.traversers})}};o(Fo,"RemoteStrategy");var Vo=Fo;rf.exports={RemoteConnection:Uo,RemoteStrategy:Vo,RemoteTraversal:jo}});var De=m((PT,nf)=>{"use strict";var{Traversal:Ow}=me(),lt=class lt{constructor(e){e?(this.sourceInstructions=[...e.sourceInstructions],this.stepInstructions=[...e.stepInstructions]):(this.sourceInstructions=[],this.stepInstructions=[])}addSource(e,r){if(e===void 0)throw new Error("Name is not defined");let n=new Array(r.length+1);n[0]=e;for(let i=0;i<r.length;++i)n[i+1]=r[i];return this.sourceInstructions.push(lt._generateInstruction(e,r)),this}addStep(e,r){if(e===void 0)throw new Error("Name is not defined");return this.stepInstructions.push(lt._generateInstruction(e,r)),this}static _generateInstruction(e,r){let n=(r?r.length:0)+1,i=new Array(n);i[0]=e;for(let s=1;s<n;s++){let a=r[s-1];if(a instanceof Ow&&a.graph!=null)throw new Error(`The child traversal of ${a} was not spawned anonymously - use the __ class rather than a TraversalSource to construct the child traversal`);i[s]=a}return i}toString(){return JSON.stringify([this.sourceInstructions,this.stepInstructions])}static _createGraphOp(e,r){let n=new lt;return n.addSource(e,r),n}static get GraphOp(){return{commit:lt._createGraphOp("tx",["commit"]),rollback:lt._createGraphOp("tx",["rollback"])}}};o(lt,"Bytecode");var Go=lt;nf.exports=Go});var of=m((CT,sf)=>{"use strict";var zw=wr(),Nw=De(),{TraversalStrategies:kw}=Ye(),Yo=class Yo{constructor(e){this._g=e,this._sessionBasedConnection=void 0}begin(){if(this._sessionBasedConnection)throw new Error("Transaction already started on this object");this._sessionBasedConnection=this._g.remoteConnection.createSession();let e=new kw;return e.addStrategy(new zw.RemoteStrategy(this._sessionBasedConnection)),new this._g.graphTraversalSourceClass(this._g.graph,e,new Nw(this._g.bytecode),this._g.graphTraversalSourceClass,this._g.graphTraversalClass)}commit(){if(!this._sessionBasedConnection)throw new Error("Cannot commit a transaction that is not started");return this._sessionBasedConnection.commit().finally(()=>this.close())}rollback(){if(!this._sessionBasedConnection)throw new Error("Cannot rollback a transaction that is not started");return this._sessionBasedConnection.rollback().finally(()=>this.close())}get isOpen(){return this._sessionBasedConnection.isOpen}close(){this._sessionBasedConnection&&this._sessionBasedConnection.close()}};o(Yo,"Transaction");var Ho=Yo;sf.exports={Transaction:Ho}});var ri=m((qT,lf)=>{"use strict";var{Traversal:Pw,cardinality:Ko}=me(),{Transaction:Dw}=of(),Cw=wr(),X=De(),{TraversalStrategies:re,VertexProgramStrategy:Lw,OptionsStrategy:af}=Ye(),ei=class ei{constructor(e,r,n,i,s){this.graph=e,this.traversalStrategies=r,this.bytecode=n||new X,this.graphTraversalSourceClass=i||ei,this.graphTraversalClass=s||mr;let a=r.strategies.find(l=>l.fqcn==="js:RemoteStrategy");this.remoteConnection=a!==void 0?a.connection:void 0}withRemote(e){let r=new re(this.traversalStrategies);return r.addStrategy(new Cw.RemoteStrategy(e)),new this.graphTraversalSourceClass(this.graph,r,new X(this.bytecode),this.graphTraversalSourceClass,this.graphTraversalClass)}tx(){if(this.remoteConnection&&this.remoteConnection.isSessionBound)throw new Error("This TraversalSource is already bound to a transaction - child transactions are not supported");return new Dw(this)}withComputer(e,r,n,i,s,a,l){let c={};return e!==void 0&&(c.graphComputer=e),r!==void 0&&(c.workers=r),n!==void 0&&(c.result=n),i!==void 0&&(c.graphComputer=i),s!==void 0&&(c.vertices=s),a!==void 0&&(c.edges=a),l!==void 0&&(c.configuration=l),this.withStrategies(new Lw(c))}with_(e,r=void 0){let n=r===void 0?!0:r,i=this.bytecode.sourceInstructions.find(s=>s[0]==="withStrategies"&&s[1]instanceof af);return i===void 0?(i=new af({[e]:n}),this.withStrategies(i)):(i[1].configuration[e]=n,new this.graphTraversalSourceClass(this.graph,new re(this.traversalStrategies),this.bytecode,this.graphTraversalSourceClass,this.graphTraversalClass))}toString(){return"graphtraversalsource["+this.graph.toString()+"]"}withBulk(...e){let r=new X(this.bytecode).addSource("withBulk",e);return new this.graphTraversalSourceClass(this.graph,new re(this.traversalStrategies),r,this.graphTraversalSourceClass,this.graphTraversalClass)}withPath(...e){let r=new X(this.bytecode).addSource("withPath",e);return new this.graphTraversalSourceClass(this.graph,new re(this.traversalStrategies),r,this.graphTraversalSourceClass,this.graphTraversalClass)}withSack(...e){let r=new X(this.bytecode).addSource("withSack",e);return new this.graphTraversalSourceClass(this.graph,new re(this.traversalStrategies),r,this.graphTraversalSourceClass,this.graphTraversalClass)}withSideEffect(...e){let r=new X(this.bytecode).addSource("withSideEffect",e);return new this.graphTraversalSourceClass(this.graph,new re(this.traversalStrategies),r,this.graphTraversalSourceClass,this.graphTraversalClass)}withStrategies(...e){let r=new X(this.bytecode).addSource("withStrategies",e);return new this.graphTraversalSourceClass(this.graph,new re(this.traversalStrategies),r,this.graphTraversalSourceClass,this.graphTraversalClass)}withoutStrategies(...e){let r=new X(this.bytecode).addSource("withoutStrategies",e);return new this.graphTraversalSourceClass(this.graph,new re(this.traversalStrategies),r,this.graphTraversalSourceClass,this.graphTraversalClass)}E(...e){let r=new X(this.bytecode).addStep("E",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}V(...e){let r=new X(this.bytecode).addStep("V",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}addE(...e){let r=new X(this.bytecode).addStep("addE",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}mergeE(...e){let r=new X(this.bytecode).addStep("mergeE",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}addV(...e){let r=new X(this.bytecode).addStep("addV",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}mergeV(...e){let r=new X(this.bytecode).addStep("mergeV",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}inject(...e){let r=new X(this.bytecode).addStep("inject",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}io(...e){let r=new X(this.bytecode).addStep("io",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}call(...e){let r=new X(this.bytecode).addStep("call",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}union(...e){let r=new X(this.bytecode).addStep("union",e);return new this.graphTraversalClass(this.graph,new re(this.traversalStrategies),r)}};o(ei,"GraphTraversalSource");var Xo=ei,ti=class ti extends Pw{constructor(e,r,n){super(e,r,n)}clone(){return new ti(this.graph,this.traversalStrategies,this.getBytecode())}V(...e){return this.bytecode.addStep("V",e),this}E(...e){return this.bytecode.addStep("E",e),this}addE(...e){return this.bytecode.addStep("addE",e),this}addV(...e){return this.bytecode.addStep("addV",e),this}aggregate(...e){return this.bytecode.addStep("aggregate",e),this}all(...e){return this.bytecode.addStep("all",e),this}and(...e){return this.bytecode.addStep("and",e),this}any(...e){return this.bytecode.addStep("any",e),this}as(...e){return this.bytecode.addStep("as",e),this}asDate(...e){return this.bytecode.addStep("asDate",e),this}asString(...e){return this.bytecode.addStep("asString",e),this}barrier(...e){return this.bytecode.addStep("barrier",e),this}both(...e){return this.bytecode.addStep("both",e),this}bothE(...e){return this.bytecode.addStep("bothE",e),this}bothV(...e){return this.bytecode.addStep("bothV",e),this}branch(...e){return this.bytecode.addStep("branch",e),this}by(...e){return this.bytecode.addStep("by",e),this}call(...e){return this.bytecode.addStep("call",e),this}cap(...e){return this.bytecode.addStep("cap",e),this}choose(...e){return this.bytecode.addStep("choose",e),this}coalesce(...e){return this.bytecode.addStep("coalesce",e),this}coin(...e){return this.bytecode.addStep("coin",e),this}combine(...e){return this.bytecode.addStep("combine",e),this}concat(...e){return this.bytecode.addStep("concat",e),this}conjoin(...e){return this.bytecode.addStep("conjoin",e),this}connectedComponent(...e){return this.bytecode.addStep("connectedComponent",e),this}constant(...e){return this.bytecode.addStep("constant",e),this}count(...e){return this.bytecode.addStep("count",e),this}cyclicPath(...e){return this.bytecode.addStep("cyclicPath",e),this}dateAdd(...e){return this.bytecode.addStep("dateAdd",e),this}dateDiff(...e){return this.bytecode.addStep("dateDiff",e),this}dedup(...e){return this.bytecode.addStep("dedup",e),this}difference(...e){return this.bytecode.addStep("difference",e),this}disjunct(...e){return this.bytecode.addStep("disjunct",e),this}drop(...e){return this.bytecode.addStep("drop",e),this}element(...e){return this.bytecode.addStep("element",e),this}elementMap(...e){return this.bytecode.addStep("elementMap",e),this}emit(...e){return this.bytecode.addStep("emit",e),this}fail(...e){return this.bytecode.addStep("fail",e),this}filter(...e){return this.bytecode.addStep("filter",e),this}flatMap(...e){return this.bytecode.addStep("flatMap",e),this}fold(...e){return this.bytecode.addStep("fold",e),this}format(...e){return this.bytecode.addStep("format",e),this}from_(...e){return this.bytecode.addStep("from",e),this}group(...e){return this.bytecode.addStep("group",e),this}groupCount(...e){return this.bytecode.addStep("groupCount",e),this}has(...e){return this.bytecode.addStep("has",e),this}hasId(...e){return this.bytecode.addStep("hasId",e),this}hasKey(...e){return this.bytecode.addStep("hasKey",e),this}hasLabel(...e){return this.bytecode.addStep("hasLabel",e),this}hasNot(...e){return this.bytecode.addStep("hasNot",e),this}hasValue(...e){return this.bytecode.addStep("hasValue",e),this}id(...e){return this.bytecode.addStep("id",e),this}identity(...e){return this.bytecode.addStep("identity",e),this}in_(...e){return this.bytecode.addStep("in",e),this}inE(...e){return this.bytecode.addStep("inE",e),this}inV(...e){return this.bytecode.addStep("inV",e),this}index(...e){return this.bytecode.addStep("index",e),this}inject(...e){return this.bytecode.addStep("inject",e),this}intersect(...e){return this.bytecode.addStep("intersect",e),this}is(...e){return this.bytecode.addStep("is",e),this}key(...e){return this.bytecode.addStep("key",e),this}label(...e){return this.bytecode.addStep("label",e),this}length(...e){return this.bytecode.addStep("length",e),this}limit(...e){return this.bytecode.addStep("limit",e),this}local(...e){return this.bytecode.addStep("local",e),this}loops(...e){return this.bytecode.addStep("loops",e),this}lTrim(...e){return this.bytecode.addStep("lTrim",e),this}map(...e){return this.bytecode.addStep("map",e),this}match(...e){return this.bytecode.addStep("match",e),this}math(...e){return this.bytecode.addStep("math",e),this}max(...e){return this.bytecode.addStep("max",e),this}mean(...e){return this.bytecode.addStep("mean",e),this}merge(...e){return this.bytecode.addStep("merge",e),this}mergeE(...e){return this.bytecode.addStep("mergeE",e),this}mergeV(...e){return this.bytecode.addStep("mergeV",e),this}min(...e){return this.bytecode.addStep("min",e),this}none(...e){return this.bytecode.addStep("none",e),this}not(...e){return this.bytecode.addStep("not",e),this}option(...e){return this.bytecode.addStep("option",e),this}optional(...e){return this.bytecode.addStep("optional",e),this}or(...e){return this.bytecode.addStep("or",e),this}order(...e){return this.bytecode.addStep("order",e),this}otherV(...e){return this.bytecode.addStep("otherV",e),this}out(...e){return this.bytecode.addStep("out",e),this}outE(...e){return this.bytecode.addStep("outE",e),this}outV(...e){return this.bytecode.addStep("outV",e),this}pageRank(...e){return this.bytecode.addStep("pageRank",e),this}path(...e){return this.bytecode.addStep("path",e),this}peerPressure(...e){return this.bytecode.addStep("peerPressure",e),this}product(...e){return this.bytecode.addStep("product",e),this}profile(...e){return this.bytecode.addStep("profile",e),this}program(...e){return this.bytecode.addStep("program",e),this}project(...e){return this.bytecode.addStep("project",e),this}properties(...e){return this.bytecode.addStep("properties",e),this}property(...e){return this.bytecode.addStep("property",e),this}propertyMap(...e){return this.bytecode.addStep("propertyMap",e),this}range(...e){return this.bytecode.addStep("range",e),this}read(...e){return this.bytecode.addStep("read",e),this}repeat(...e){return this.bytecode.addStep("repeat",e),this}replace(...e){return this.bytecode.addStep("replace",e),this}reverse(...e){return this.bytecode.addStep("reverse",e),this}rTrim(...e){return this.bytecode.addStep("rTrim",e),this}sack(...e){return this.bytecode.addStep("sack",e),this}sample(...e){return this.bytecode.addStep("sample",e),this}select(...e){return this.bytecode.addStep("select",e),this}shortestPath(...e){return this.bytecode.addStep("shortestPath",e),this}sideEffect(...e){return this.bytecode.addStep("sideEffect",e),this}simplePath(...e){return this.bytecode.addStep("simplePath",e),this}skip(...e){return this.bytecode.addStep("skip",e),this}split(...e){return this.bytecode.addStep("split",e),this}store(...e){return this.bytecode.addStep("store",e),this}subgraph(...e){return this.bytecode.addStep("subgraph",e),this}substring(...e){return this.bytecode.addStep("substring",e),this}sum(...e){return this.bytecode.addStep("sum",e),this}tail(...e){return this.bytecode.addStep("tail",e),this}timeLimit(...e){return this.bytecode.addStep("timeLimit",e),this}times(...e){return this.bytecode.addStep("times",e),this}to(...e){return this.bytecode.addStep("to",e),this}toE(...e){return this.bytecode.addStep("toE",e),this}toLower(...e){return this.bytecode.addStep("toLower",e),this}toUpper(...e){return this.bytecode.addStep("toUpper",e),this}toV(...e){return this.bytecode.addStep("toV",e),this}tree(...e){return this.bytecode.addStep("tree",e),this}trim(...e){return this.bytecode.addStep("trim",e),this}unfold(...e){return this.bytecode.addStep("unfold",e),this}union(...e){return this.bytecode.addStep("union",e),this}until(...e){return this.bytecode.addStep("until",e),this}value(...e){return this.bytecode.addStep("value",e),this}valueMap(...e){return this.bytecode.addStep("valueMap",e),this}values(...e){return this.bytecode.addStep("values",e),this}where(...e){return this.bytecode.addStep("where",e),this}with_(...e){return this.bytecode.addStep("with",e),this}write(...e){return this.bytecode.addStep("write",e),this}};o(ti,"GraphTraversal");var mr=ti,Mt=class Mt extends X{constructor(e,r){super(),this.addSource("CardinalityValueTraversal",[e,r])}static single(e){return new Mt(Ko.single,e)}static list(e){return new Mt(Ko.list,e)}static set(e){return new Mt(Ko.set,e)}};o(Mt,"CardinalityValue");var Jo=Mt;function b(t,e){let r=new mr(null,null,new X);return r[t].apply(r,e)}o(b,"callOnEmptyTraversal");var qw={E:(...t)=>b("E",t),V:(...t)=>b("V",t),addE:(...t)=>b("addE",t),addV:(...t)=>b("addV",t),aggregate:(...t)=>b("aggregate",t),all:(...t)=>b("all",t),and:(...t)=>b("and",t),any:(...t)=>b("any",t),as:(...t)=>b("as",t),asDate:(...t)=>b("asDate",t),asString:(...t)=>b("asString",t),barrier:(...t)=>b("barrier",t),both:(...t)=>b("both",t),bothE:(...t)=>b("bothE",t),bothV:(...t)=>b("bothV",t),branch:(...t)=>b("branch",t),call:(...t)=>b("call",t),cap:(...t)=>b("cap",t),choose:(...t)=>b("choose",t),coalesce:(...t)=>b("coalesce",t),coin:(...t)=>b("coin",t),concat:(...t)=>b("concat",t),constant:(...t)=>b("constant",t),count:(...t)=>b("count",t),cyclicPath:(...t)=>b("cyclicPath",t),dateAdd:(...t)=>b("dateAdd",t),dateDiff:(...t)=>b("dateDiff",t),dedup:(...t)=>b("dedup",t),drop:(...t)=>b("drop",t),element:(...t)=>b("element",t),elementMap:(...t)=>b("elementMap",t),emit:(...t)=>b("emit",t),fail:(...t)=>b("fail",t),filter:(...t)=>b("filter",t),flatMap:(...t)=>b("flatMap",t),fold:(...t)=>b("fold",t),format:(...t)=>b("format",t),group:(...t)=>b("group",t),groupCount:(...t)=>b("groupCount",t),has:(...t)=>b("has",t),hasId:(...t)=>b("hasId",t),hasKey:(...t)=>b("hasKey",t),hasLabel:(...t)=>b("hasLabel",t),hasNot:(...t)=>b("hasNot",t),hasValue:(...t)=>b("hasValue",t),id:(...t)=>b("id",t),identity:(...t)=>b("identity",t),in_:(...t)=>b("in_",t),inE:(...t)=>b("inE",t),inV:(...t)=>b("inV",t),index:(...t)=>b("index",t),inject:(...t)=>b("inject",t),is:(...t)=>b("is",t),key:(...t)=>b("key",t),label:(...t)=>b("label",t),length:(...t)=>b("length",t),limit:(...t)=>b("limit",t),local:(...t)=>b("local",t),loops:(...t)=>b("loops",t),lTrim:(...t)=>b("lTrim",t),map:(...t)=>b("map",t),match:(...t)=>b("match",t),math:(...t)=>b("math",t),max:(...t)=>b("max",t),mean:(...t)=>b("mean",t),mergeE:(...t)=>b("mergeE",t),mergeV:(...t)=>b("mergeV",t),min:(...t)=>b("min",t),not:(...t)=>b("not",t),optional:(...t)=>b("optional",t),or:(...t)=>b("or",t),order:(...t)=>b("order",t),otherV:(...t)=>b("otherV",t),out:(...t)=>b("out",t),outE:(...t)=>b("outE",t),outV:(...t)=>b("outV",t),path:(...t)=>b("path",t),project:(...t)=>b("project",t),properties:(...t)=>b("properties",t),property:(...t)=>b("property",t),propertyMap:(...t)=>b("propertyMap",t),range:(...t)=>b("range",t),repeat:(...t)=>b("repeat",t),replace:(...t)=>b("replace",t),reverse:(...t)=>b("reverse",t),rTrim:(...t)=>b("rTrim",t),sack:(...t)=>b("sack",t),sample:(...t)=>b("sample",t),select:(...t)=>b("select",t),sideEffect:(...t)=>b("sideEffect",t),simplePath:(...t)=>b("simplePath",t),skip:(...t)=>b("skip",t),split:(...t)=>b("split",t),store:(...t)=>b("store",t),subgraph:(...t)=>b("subgraph",t),substring:(...t)=>b("substring",t),sum:(...t)=>b("sum",t),tail:(...t)=>b("tail",t),timeLimit:(...t)=>b("timeLimit",t),times:(...t)=>b("times",t),to:(...t)=>b("to",t),toE:(...t)=>b("toE",t),toLower:(...t)=>b("toLower",t),toUpper:(...t)=>b("toUpper",t),toV:(...t)=>b("toV",t),tree:(...t)=>b("tree",t),trim:(...t)=>b("trim",t),unfold:(...t)=>b("unfold",t),union:(...t)=>b("union",t),until:(...t)=>b("until",t),value:(...t)=>b("value",t),valueMap:(...t)=>b("valueMap",t),values:(...t)=>b("values",t),where:(...t)=>b("where",t)};lf.exports={GraphTraversal:mr,GraphTraversalSource:Xo,CardinalityValue:Jo,statics:qw}});var Ke=m((MT,uf)=>{"use strict";var Bw=ri(),{TraversalStrategies:Mw}=Ye(),sa=class sa{traversal(e){let r=e||Bw.GraphTraversalSource;return new r(this,new Mw)}toString(){return"graph[]"}};o(sa,"Graph");var Zo=sa,ni=class ni{constructor(e,r){this.id=e,this.label=r}equals(e){return e instanceof ni&&this.id===e.id}};o(ni,"Element");var _r=ni,oa=class oa extends _r{constructor(e,r,n){super(e,r),this.properties=n}toString(){return`v[${this.id}]`}};o(oa,"Vertex");var Qo=oa,aa=class aa extends _r{constructor(e,r,n,i,s){if(super(e,n),this.outV=r,this.inV=i,this.properties={},s){let a=Object.keys(s);for(let l=0;l<a.length;l++){let c=a[l];this.properties[c]=s[c].value}}}toString(){let e=this.outV?this.outV.id:"?",r=this.inV?this.inV.id:"?";return`e[${this.id}][${e}-${this.label}->${r}]`}};o(aa,"Edge");var ea=aa,la=class la extends _r{constructor(e,r,n,i){super(e,r),this.value=n,this.key=this.label,this.properties=i}toString(){return`vp[${this.label}->${cf(this.value)}]`}};o(la,"VertexProperty");var ta=la,ii=class ii{constructor(e,r){this.key=e,this.value=r}toString(){return`p[${this.key}->${cf(this.value)}]`}equals(e){return e instanceof ii&&this.key===e.key&&this.value===e.value}};o(ii,"Property");var ra=ii,si=class si{constructor(e,r){this.labels=e,this.objects=r}toString(){return`path[${(this.objects||[]).join(", ")}]`}equals(e){return e instanceof si?e===this?!0:ia(this.objects,e.objects)&&ia(this.labels,e.labels):!1}};o(si,"Path");var na=si;function ia(t,e){if(t===e)return!0;if(typeof t.equals=="function")return t.equals(e);if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!ia(t[r],e[r]))return!1;return!0}return!1}o(ia,"areEqual");function cf(t){if(t==null)return t;let e=t.toString();return e.length>20?e.substr(0,20):e}o(cf,"summarize");uf.exports={Edge:ea,Graph:Zo,Path:na,Property:ra,Vertex:Qo,VertexProperty:ta}});function Sr(){return oi>ai.length-16&&(ff.default.randomFillSync(ai),oi=0),ai.slice(oi,oi+=16)}var ff,ai,oi,ca=ie(()=>{ff=Pe(require("crypto")),ai=new Uint8Array(256),oi=ai.length;o(Sr,"rng")});var df,hf=ie(()=>{df=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function Uw(t){return typeof t=="string"&&df.test(t)}var ct,Er=ie(()=>{hf();o(Uw,"validate");ct=Uw});function mt(t,e=0){return se[t[e+0]]+se[t[e+1]]+se[t[e+2]]+se[t[e+3]]+"-"+se[t[e+4]]+se[t[e+5]]+"-"+se[t[e+6]]+se[t[e+7]]+"-"+se[t[e+8]]+se[t[e+9]]+"-"+se[t[e+10]]+se[t[e+11]]+se[t[e+12]]+se[t[e+13]]+se[t[e+14]]+se[t[e+15]]}function jw(t,e=0){let r=mt(t,e);if(!ct(r))throw TypeError("Stringified UUID is invalid");return r}var se,pf,xr=ie(()=>{Er();se=[];for(let t=0;t<256;++t)se.push((t+256).toString(16).slice(1));o(mt,"unsafeStringify");o(jw,"stringify");pf=jw});function Vw(t,e,r){let n=e&&r||0,i=e||new Array(16);t=t||{};let s=t.node||gf,a=t.clockseq!==void 0?t.clockseq:ua;if(s==null||a==null){let p=t.random||(t.rng||Sr)();s==null&&(s=gf=[p[0]|1,p[1],p[2],p[3],p[4],p[5]]),a==null&&(a=ua=(p[6]<<8|p[7])&16383)}let l=t.msecs!==void 0?t.msecs:Date.now(),c=t.nsecs!==void 0?t.nsecs:da+1,u=l-fa+(c-da)/1e4;if(u<0&&t.clockseq===void 0&&(a=a+1&16383),(u<0||l>fa)&&t.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");fa=l,da=c,ua=a,l+=122192928e5;let f=((l&268435455)*1e4+c)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=f&255;let d=l/4294967296*1e4&268435455;i[n++]=d>>>8&255,i[n++]=d&255,i[n++]=d>>>24&15|16,i[n++]=d>>>16&255,i[n++]=a>>>8|128,i[n++]=a&255;for(let p=0;p<6;++p)i[n+p]=s[p];return e||mt(i)}var gf,ua,fa,da,yf,bf=ie(()=>{ca();xr();fa=0,da=0;o(Vw,"v1");yf=Vw});function $w(t){if(!ct(t))throw TypeError("Invalid UUID");let e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var li,ha=ie(()=>{Er();o($w,"parse");li=$w});function Ww(t){t=unescape(encodeURIComponent(t));let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}function vr(t,e,r){function n(i,s,a,l){var c;if(typeof i=="string"&&(i=Ww(i)),typeof s=="string"&&(s=li(s)),((c=s)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+i.length);if(u.set(s),u.set(i,s.length),u=r(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,a){l=l||0;for(let f=0;f<16;++f)a[l+f]=u[f];return a}return mt(u)}o(n,"generateUUID");try{n.name=t}catch{}return n.DNS=Fw,n.URL=Gw,n}var Fw,Gw,pa=ie(()=>{xr();ha();o(Ww,"stringToBytes");Fw="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Gw="6ba7b811-9dad-11d1-80b4-00c04fd430c8";o(vr,"v35")});function Hw(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),wf.default.createHash("md5").update(t).digest()}var wf,mf,_f=ie(()=>{wf=Pe(require("crypto"));o(Hw,"md5");mf=Hw});var Yw,Sf,Ef=ie(()=>{pa();_f();Yw=vr("v3",48,mf),Sf=Yw});var xf,ga,vf=ie(()=>{xf=Pe(require("crypto")),ga={randomUUID:xf.default.randomUUID}});function Kw(t,e,r){if(ga.randomUUID&&!e&&!t)return ga.randomUUID();t=t||{};let n=t.random||(t.rng||Sr)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return mt(n)}var Tf,If=ie(()=>{vf();ca();xr();o(Kw,"v4");Tf=Kw});function Xw(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),Rf.default.createHash("sha1").update(t).digest()}var Rf,Af,Of=ie(()=>{Rf=Pe(require("crypto"));o(Xw,"sha1");Af=Xw});var Jw,zf,Nf=ie(()=>{pa();Of();Jw=vr("v5",80,Af),zf=Jw});var kf,Pf=ie(()=>{kf="00000000-0000-0000-0000-000000000000"});function Zw(t){if(!ct(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}var Df,Cf=ie(()=>{Er();o(Zw,"version");Df=Zw});var Lf={};Xu(Lf,{NIL:()=>kf,parse:()=>li,stringify:()=>pf,v1:()=>yf,v3:()=>Sf,v4:()=>Tf,v5:()=>zf,validate:()=>ct,version:()=>Df});var qf=ie(()=>{bf();Ef();If();Nf();Pf();Cf();Er();xr();ha()});var _t=m((Xe,Bf)=>{"use strict";var Qw=(qf(),Ew(Lf)),em="3.7.2";Xe.toLong=o(function(e){return new tm(e)},"toLong");var tm=Xe.Long=o(function(e){if(typeof e!="string"&&typeof e!="number")throw new TypeError("The value must be a string or a number");this.value=e.toString()},"Long");Xe.getUuid=o(function(){return Qw.v4()},"getUuid");Xe.emptyArray=Object.freeze([]);var ba=class ba extends Map{constructor(e){super(e)}set(){return this}delete(){return!1}clear(){}};o(ba,"ImmutableMap");var ya=ba;Xe.ImmutableMap=ya;async function rm(){let t=await import("node:os"),e=((process==null?void 0:process.env.npm_package_name)??"NotAvailable").replace("_"," "),r,n,i,s;return r=n=i=s="NotAvailable",process!=null&&(process.version&&(r=process.version.replace(" ","_")),process.arch&&(s=process.arch.replace(" ","_"))),t!=null&&(n=t.platform().replace(" ","_"),i=t.release().replace(" ","_")),`${e} Gremlin-Javascript.${em} ${r} ${n}.${i} ${s}`}o(rm,"generateNodeUserAgent");Xe.getUserAgentHeader=o(function(){return"User-Agent"},"getUserAgentHeader");Xe.getUserAgent=async()=>{var t;if("navigator"in globalThis)return globalThis.navigator.userAgent;if(((t=process==null?void 0:process.versions)==null?void 0:t.node)!==void 0)return await rm()};var nm=o(t=>t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),"toArrayBuffer");Xe.toArrayBuffer=nm;var im=o(()=>{let t=o(n=>{},"resolve"),e=o(n=>{},"reject"),r=new Promise((n,i)=>{t=n,e=i});return Object.assign(r,{resolve:t,reject:e})},"DeferredPromise");Bf.exports.DeferredPromise=im});var ui=m((q1,Mf)=>{"use strict";var Je=me(),sm=Ye(),om=De(),Ce=Ke(),am=_t(),B="@value",oe="@type",Ua=class Ua{serialize(){throw new Error("serialize() method not implemented for "+this.constructor.name)}deserialize(){throw new Error("deserialize() method not implemented for "+this.constructor.name)}canBeUsedFor(){throw new Error("canBeUsedFor() method not implemented for "+this.constructor.name)}};o(Ua,"TypeSerializer");var V=Ua,ja=class ja extends V{serialize(e){return isNaN(e)?{[oe]:"g:Double",[B]:"NaN"}:e===Number.POSITIVE_INFINITY?{[oe]:"g:Double",[B]:"Infinity"}:e===Number.NEGATIVE_INFINITY?{[oe]:"g:Double",[B]:"-Infinity"}:e}deserialize(e){let r=e[B];return r==="NaN"?NaN:r==="Infinity"?Number.POSITIVE_INFINITY:r==="-Infinity"?Number.NEGATIVE_INFINITY:parseFloat(r)}canBeUsedFor(e){return typeof e=="number"}};o(ja,"NumberSerializer");var wa=ja,Va=class Va extends V{serialize(e){return{[oe]:"g:Date",[B]:e.getTime()}}deserialize(e){return new Date(e[B])}canBeUsedFor(e){return e instanceof Date}};o(Va,"DateSerializer");var ma=Va,$a=class $a extends V{serialize(e){return{[oe]:"g:Int64",[B]:e.value}}canBeUsedFor(e){return e instanceof am.Long}};o($a,"LongSerializer");var _a=$a,Wa=class Wa extends V{serialize(e){let r=e;e instanceof Je.Traversal&&(r=e.getBytecode());let n={};n[oe]="g:Bytecode";let i=n[B]={},s=this._serializeInstructions(r.sourceInstructions);s&&(i.source=s);let a=this._serializeInstructions(r.stepInstructions);return a&&(i.step=a),n}_serializeInstructions(e){if(e.length===0)return null;let r=new Array(e.length);r[0]=e[0];for(let n=0;n<e.length;n++)r[n]=e[n].map(i=>this.writer.adaptObject(i));return r}canBeUsedFor(e){return e instanceof om||e instanceof Je.Traversal}};o(Wa,"BytecodeSerializer");var Sa=Wa,Fa=class Fa extends V{serialize(e){let r={};r[oe]="g:P";let n=r[B]={predicate:e.operator};return e.other===void 0||e.other===null?n.value=this.writer.adaptObject(e.value):n.value=[this.writer.adaptObject(e.value),this.writer.adaptObject(e.other)],r}canBeUsedFor(e){return e instanceof Je.P}};o(Fa,"PSerializer");var Ea=Fa,Ga=class Ga extends V{serialize(e){let r={};r[oe]="g:TextP";let n=r[B]={predicate:e.operator};return e.other===void 0||e.other===null?n.value=this.writer.adaptObject(e.value):n.value=[this.writer.adaptObject(e.value),this.writer.adaptObject(e.other)],r}canBeUsedFor(e){return e instanceof Je.TextP}};o(Ga,"TextPSerializer");var xa=Ga,Ha=class Ha extends V{serialize(e){let r=e(),n=typeof r=="string",i=n?r:r[0],s=n?"gremlin-groovy":r[1],a=s==="gremlin-groovy"&&i.includes("->")?i.substring(0,i.indexOf("->")).includes(",")?2:1:-1;return{[oe]:"g:Lambda",[B]:{arguments:a,language:s,script:i}}}canBeUsedFor(e){return typeof e=="function"}};o(Ha,"LambdaSerializer");var va=Ha,Ya=class Ya extends V{serialize(e){return{[oe]:"g:"+e.typeName,[B]:e.elementName}}canBeUsedFor(e){return e&&e.typeName&&e instanceof Je.EnumValue}};o(Ya,"EnumSerializer");var Ta=Ya,Ka=class Ka extends V{serialize(e){return{[oe]:"g:Traverser",[B]:{value:this.writer.adaptObject(e.object),bulk:this.writer.adaptObject(e.bulk)}}}deserialize(e){let r=e[B];return new Je.Traverser(this.reader.read(r.value),this.reader.read(r.bulk))}canBeUsedFor(e){return e instanceof Je.Traverser}};o(Ka,"TraverserSerializer");var Ia=Ka,Xa=class Xa extends V{serialize(e){let r={};for(let n in e.configuration)e.configuration.hasOwnProperty(n)&&(r[n]=this.writer.adaptObject(e.configuration[n]));return{[oe]:"g:"+e.constructor.name,[B]:r}}canBeUsedFor(e){return e instanceof sm.TraversalStrategy}};o(Xa,"TraversalStrategySerializer");var Ra=Xa,Ja=class Ja extends V{deserialize(e){let r=e[B];return new Ce.Vertex(this.reader.read(r.id),r.label,this.reader.read(r.properties))}serialize(e){return{[oe]:"g:Vertex",[B]:{id:this.writer.adaptObject(e.id),label:e.label}}}canBeUsedFor(e){return e instanceof Ce.Vertex}};o(Ja,"VertexSerializer");var Aa=Ja,Za=class Za extends V{deserialize(e){let r=e[B];return new Ce.VertexProperty(this.reader.read(r.id),r.label,this.reader.read(r.value),this.reader.read(r.properties))}};o(Za,"VertexPropertySerializer");var Oa=Za,Qa=class Qa extends V{deserialize(e){let r=e[B];return new Ce.Property(r.key,this.reader.read(r.value))}};o(Qa,"PropertySerializer");var za=Qa,el=class el extends V{deserialize(e){let r=e[B];return new Ce.Edge(this.reader.read(r.id),new Ce.Vertex(this.reader.read(r.outV),this.reader.read(r.outVLabel)),r.label,new Ce.Vertex(this.reader.read(r.inV),this.reader.read(r.inVLabel)),this.reader.read(r.properties))}serialize(e){return{[oe]:"g:Edge",[B]:{id:this.writer.adaptObject(e.id),label:e.label,outV:this.writer.adaptObject(e.outV.id),outVLabel:e.outV.label,inV:this.writer.adaptObject(e.inV.id),inVLabel:e.inV.label}}}canBeUsedFor(e){return e instanceof Ce.Edge}};o(el,"EdgeSerializer");var Na=el,tl=class tl extends V{deserialize(e){let r=e[B],n=r.objects.map(i=>this.reader.read(i));return new Ce.Path(this.reader.read(r.labels),n)}};o(tl,"PathSerializer");var ka=tl,rl=class rl extends V{deserialize(e){let r=e[B];return new Ce.Path(this.reader.read(r.labels),this.reader.read(r.objects))}};o(rl,"Path3Serializer");var Pa=rl,nl=class nl extends V{deserialize(e){return Je.t[e[B]]}};o(nl,"TSerializer");var Da=nl,il=class il extends V{deserialize(e){return Je.direction[e[B].toLowerCase()]}};o(il,"DirectionSerializer");var Ca=il,sl=class sl extends V{constructor(e){super(),this.typeKey=e}deserialize(e){let r=e[B];if(!Array.isArray(r))throw new Error("Expected Array, obtained: "+r);return r.map(n=>this.reader.read(n))}serialize(e){return{[oe]:this.typeKey,[B]:e.map(r=>this.writer.adaptObject(r))}}canBeUsedFor(e){return Array.isArray(e)}};o(sl,"ArraySerializer");var ci=sl,ol=class ol extends V{deserialize(e){let r=e[B];if(!Array.isArray(r))throw new Error("Expected Array, obtained: "+r);let n=[];for(let i=0,s=r.length;i<s;i+=2){let a=r.slice(i,i+2);n=n.concat(Array(this.reader.read(a[1])).fill(this.reader.read(a[0])))}return n}};o(ol,"BulkSetSerializer");var La=ol,al=class al extends V{deserialize(e){let r=e[B];if(!Array.isArray(r))throw new Error("Expected Array, obtained: "+r);let n=new Map;for(let i=0;i<r.length;i+=2)n.set(this.reader.read(r[i]),this.reader.read(r[i+1]));return n}serialize(e){let r=[];return e.forEach((n,i)=>{r.push(this.writer.adaptObject(i)),r.push(this.writer.adaptObject(n))}),{[oe]:"g:Map",[B]:r}}canBeUsedFor(e){return e instanceof Map}};o(al,"MapSerializer");var qa=al,ll=class ll extends ci{constructor(){super("g:List")}};o(ll,"ListSerializer");var Ba=ll,cl=class cl extends ci{constructor(){super("g:Set")}};o(cl,"SetSerializer");var Ma=cl;Mf.exports={BulkSetSerializer:La,BytecodeSerializer:Sa,DateSerializer:ma,DirectionSerializer:Ca,EdgeSerializer:Na,EnumSerializer:Ta,LambdaSerializer:va,ListSerializer:Ba,LongSerializer:_a,MapSerializer:qa,NumberSerializer:wa,Path3Serializer:Pa,PathSerializer:ka,PropertySerializer:za,PSerializer:Ea,TextPSerializer:xa,SetSerializer:Ma,TSerializer:Da,TraverserSerializer:Ia,TraversalStrategySerializer:Ra,typeKey:oe,valueKey:B,VertexPropertySerializer:Oa,VertexSerializer:Aa}});var pl=m((M1,Vf)=>{"use strict";var{Buffer:lm}=require("buffer"),C=ui(),cm=De(),ul=class ul{constructor(e){this._options=e||{},this._serializers=this.getDefaultSerializers().map(n=>{let i=new n;return i.writer=this,i});let r=this._options.serializers||{};Object.keys(r).forEach(n=>{let i=r[n];i.serialize&&(i.writer=this,this._serializers.unshift(i))})}getDefaultSerializers(){return jf}adaptObject(e){let r;for(let n=0;n<this._serializers.length;n++){let i=this._serializers[n];if(i.canBeUsedFor&&i.canBeUsedFor(e)){r=i;break}}return r?r.serialize(e):Array.isArray(e)?e.map(n=>this.adaptObject(n)):e}write(e){return JSON.stringify(this.adaptObject(e))}writeRequest({requestId:e,op:r,processor:n,args:i}){let s={requestId:{"@type":"g:UUID","@value":e},op:r,processor:n,args:this._adaptArgs(i,!0)};return s.args.gremlin instanceof cm&&(s.args.gremlin=this.adaptObject(s.args.gremlin)),lm.from(JSON.stringify(s))}_adaptArgs(e,r){if(e instanceof Object){let n={};return Object.keys(e).forEach(i=>{r&&i==="bindings"?n[i]=this._adaptArgs(e[i],!1):n[i]=this.adaptObject(e[i])}),n}return e}};o(ul,"GraphSON2Writer");var fi=ul,fl=class fl extends fi{getDefaultSerializers(){return fm}};o(fl,"GraphSON3Writer");var di=fl,dl=class dl{constructor(e){this._options=e||{},this._deserializers={};let r=this.getDefaultDeserializers();if(Object.keys(r).forEach(n=>{let i=r[n],s=new i;s.reader=this,this._deserializers[n]=s}),this._options.serializers){let n=this._options.serializers||{};Object.keys(n).forEach(i=>{let s=n[i];s.deserialize&&(s.reader=this,this._deserializers[i]=s)})}}getDefaultDeserializers(){return Uf}read(e){if(e===void 0)return;if(e===null)return null;if(Array.isArray(e))return e.map(n=>this.read(n));let r=e[C.typeKey];if(r){let n=this._deserializers[r];return n?n.deserialize(e):e[C.valueKey]}return e&&typeof e=="object"&&e.constructor===Object?this._deserializeObject(e):e}readResponse(e){return this.read(JSON.parse(e.toString()))}_deserializeObject(e){let r=Object.keys(e),n={};for(let i=0;i<r.length;i++)n[r[i]]=this.read(e[r[i]]);return n}};o(dl,"GraphSON2Reader");var hi=dl,hl=class hl extends hi{getDefaultDeserializers(){return um}};o(hl,"GraphSON3Reader");var pi=hl,Uf={"g:Traverser":C.TraverserSerializer,"g:TraversalStrategy":C.TraversalStrategySerializer,"g:Int32":C.NumberSerializer,"g:Int64":C.NumberSerializer,"g:Float":C.NumberSerializer,"g:Double":C.NumberSerializer,"g:Date":C.DateSerializer,"g:Direction":C.DirectionSerializer,"g:Vertex":C.VertexSerializer,"g:Edge":C.EdgeSerializer,"g:VertexProperty":C.VertexPropertySerializer,"g:Property":C.PropertySerializer,"g:Path":C.Path3Serializer,"g:TextP":C.TextPSerializer,"g:T":C.TSerializer,"g:BulkSet":C.BulkSetSerializer},um=Object.assign({},Uf,{"g:List":C.ListSerializer,"g:Set":C.SetSerializer,"g:Map":C.MapSerializer}),jf=[C.NumberSerializer,C.DateSerializer,C.BytecodeSerializer,C.TraverserSerializer,C.TraversalStrategySerializer,C.PSerializer,C.TextPSerializer,C.LambdaSerializer,C.EnumSerializer,C.VertexSerializer,C.EdgeSerializer,C.LongSerializer],fm=jf.concat([C.ListSerializer,C.SetSerializer,C.MapSerializer]);Vf.exports={GraphSON3Writer:di,GraphSON3Reader:pi,GraphSON2Writer:fi,GraphSON2Reader:hi,GraphSONWriter:di,GraphSONReader:pi}});var Wf=m((j1,$f)=>{"use strict";var dm=me().Traversal,hm=De(),yl=class yl{constructor(e){this._traversalSource=e}getTraversalSource(){return this._traversalSource}getTargetLanguage(){return"gremlin-groovy"}of(e){this._traversalSource=e}translate(e,r=!1){let n=r?"__":this._traversalSource,s=(e instanceof hm?e:e.getBytecode()).stepInstructions;for(let a=0;a<s.length;a++){let l=s[a].slice(1);if(n+="."+s[a][0]+"(",l.length)for(let c=0;c<l.length;c++)c>0&&(n+=", "),n+=this.convert(l[c]);n+=")"}return n}convert(e){let r="";if(Object(e)===e)if(e instanceof dm)r+=this.translate(e.getBytecode(),!0);else if(e.toString()==="[object Object]")Object.keys(e).forEach(function(n,i){i>0&&(r+=", "),r+=`('${n}', `,e[n]instanceof String||typeof e[n]=="string"?r+=`'${e[n]}'`:r+=e[n],r+=")"});else if(Array.isArray(e)){let n=[];for(let i of e)n.push(this.convert(i));r+="["+n.join(", ")+"]"}else r+=e.toString();else e===void 0?r+="":typeof e=="number"||typeof e=="boolean"?r+=e:r+=`'${e}'`;return r}};o(yl,"Translator");var gl=yl;$f.exports=gl});var Gf=m(($1,bl)=>{"use strict";var pm=Object.prototype.hasOwnProperty,he="~";function Tr(){}o(Tr,"Events");Object.create&&(Tr.prototype=Object.create(null),new Tr().__proto__||(he=!1));function gm(t,e,r){this.fn=t,this.context=e,this.once=r||!1}o(gm,"EE");function Ff(t,e,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new gm(r,n||t,i),a=he?he+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],s]:t._events[a].push(s):(t._events[a]=s,t._eventsCount++),t}o(Ff,"addListener");function gi(t,e){--t._eventsCount===0?t._events=new Tr:delete t._events[e]}o(gi,"clearEvent");function le(){this._events=new Tr,this._eventsCount=0}o(le,"EventEmitter");le.prototype.eventNames=o(function(){var e=[],r,n;if(this._eventsCount===0)return e;for(n in r=this._events)pm.call(r,n)&&e.push(he?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e},"eventNames");le.prototype.listeners=o(function(e){var r=he?he+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,a=new Array(s);i<s;i++)a[i]=n[i].fn;return a},"listeners");le.prototype.listenerCount=o(function(e){var r=he?he+e:e,n=this._events[r];return n?n.fn?1:n.length:0},"listenerCount");le.prototype.emit=o(function(e,r,n,i,s,a){var l=he?he+e:e;if(!this._events[l])return!1;var c=this._events[l],u=arguments.length,f,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,n),!0;case 4:return c.fn.call(c.context,r,n,i),!0;case 5:return c.fn.call(c.context,r,n,i,s),!0;case 6:return c.fn.call(c.context,r,n,i,s,a),!0}for(d=1,f=new Array(u-1);d<u;d++)f[d-1]=arguments[d];c.fn.apply(c.context,f)}else{var p=c.length,y;for(d=0;d<p;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,r);break;case 3:c[d].fn.call(c[d].context,r,n);break;case 4:c[d].fn.call(c[d].context,r,n,i);break;default:if(!f)for(y=1,f=new Array(u-1);y<u;y++)f[y-1]=arguments[y];c[d].fn.apply(c[d].context,f)}}return!0},"emit");le.prototype.on=o(function(e,r,n){return Ff(this,e,r,n,!1)},"on");le.prototype.once=o(function(e,r,n){return Ff(this,e,r,n,!0)},"once");le.prototype.removeListener=o(function(e,r,n,i){var s=he?he+e:e;if(!this._events[s])return this;if(!r)return gi(this,s),this;var a=this._events[s];if(a.fn)a.fn===r&&(!i||a.once)&&(!n||a.context===n)&&gi(this,s);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==r||i&&!a[l].once||n&&a[l].context!==n)&&c.push(a[l]);c.length?this._events[s]=c.length===1?c[0]:c:gi(this,s)}return this},"removeListener");le.prototype.removeAllListeners=o(function(e){var r;return e?(r=he?he+e:e,this._events[r]&&gi(this,r)):(this._events=new Tr,this._eventsCount=0),this},"removeAllListeners");le.prototype.off=le.prototype.removeListener;le.prototype.addListener=le.prototype.on;le.prefixed=he;le.EventEmitter=le;typeof bl<"u"&&(bl.exports=le)});var $=m((F1,Hf)=>{"use strict";Hf.exports={ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,e){return t.includes(e)},ArrayPrototypeIndexOf(t,e){return t.indexOf(e)},ArrayPrototypeJoin(t,e){return t.join(e)},ArrayPrototypeMap(t,e){return t.map(e)},ArrayPrototypePop(t,e){return t.pop(e)},ArrayPrototypePush(t,e){return t.push(e)},ArrayPrototypeSlice(t,e,r){return t.slice(e,r)},Error,FunctionPrototypeCall(t,e,...r){return t.call(e,...r)},FunctionPrototypeSymbolHasInstance(t,e){return Function.prototype[Symbol.hasInstance].call(t,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,e){return Object.defineProperties(t,e)},ObjectDefineProperty(t,e,r){return Object.defineProperty(t,e,r)},ObjectGetOwnPropertyDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,e){return Object.setPrototypeOf(t,e)},Promise,PromisePrototypeCatch(t,e){return t.catch(e)},PromisePrototypeThen(t,e,r){return t.then(e,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,e){return t.test(e)},SafeSet:Set,String,StringPrototypeSlice(t,e,r){return t.slice(e,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,e,r){return t.set(e,r)},Boolean,Uint8Array}});var nd=m((Ar,Rr)=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});var Qf=new WeakMap,wl=new WeakMap;function M(t){let e=Qf.get(t);return console.assert(e!=null,"'this' is expected an Event object, but got",t),e}o(M,"pd");function Yf(t){if(t.passiveListener!=null){typeof console<"u"&&typeof console.error=="function"&&console.error("Unable to preventDefault inside passive event listener invocation.",t.passiveListener);return}t.event.cancelable&&(t.canceled=!0,typeof t.event.preventDefault=="function"&&t.event.preventDefault())}o(Yf,"setCancelFlag");function Ut(t,e){Qf.set(this,{eventTarget:t,event:e,eventPhase:2,currentTarget:t,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:e.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});let r=Object.keys(e);for(let n=0;n<r.length;++n){let i=r[n];i in this||Object.defineProperty(this,i,ed(i))}}o(Ut,"Event");Ut.prototype={get type(){return M(this).event.type},get target(){return M(this).eventTarget},get currentTarget(){return M(this).currentTarget},composedPath(){let t=M(this).currentTarget;return t==null?[]:[t]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return M(this).eventPhase},stopPropagation(){let t=M(this);t.stopped=!0,typeof t.event.stopPropagation=="function"&&t.event.stopPropagation()},stopImmediatePropagation(){let t=M(this);t.stopped=!0,t.immediateStopped=!0,typeof t.event.stopImmediatePropagation=="function"&&t.event.stopImmediatePropagation()},get bubbles(){return!!M(this).event.bubbles},get cancelable(){return!!M(this).event.cancelable},preventDefault(){Yf(M(this))},get defaultPrevented(){return M(this).canceled},get composed(){return!!M(this).event.composed},get timeStamp(){return M(this).timeStamp},get srcElement(){return M(this).eventTarget},get cancelBubble(){return M(this).stopped},set cancelBubble(t){if(!t)return;let e=M(this);e.stopped=!0,typeof e.event.cancelBubble=="boolean"&&(e.event.cancelBubble=!0)},get returnValue(){return!M(this).canceled},set returnValue(t){t||Yf(M(this))},initEvent(){}};Object.defineProperty(Ut.prototype,"constructor",{value:Ut,configurable:!0,writable:!0});typeof window<"u"&&typeof window.Event<"u"&&(Object.setPrototypeOf(Ut.prototype,window.Event.prototype),wl.set(window.Event.prototype,Ut));function ed(t){return{get(){return M(this).event[t]},set(e){M(this).event[t]=e},configurable:!0,enumerable:!0}}o(ed,"defineRedirectDescriptor");function ym(t){return{value(){let e=M(this).event;return e[t].apply(e,arguments)},configurable:!0,enumerable:!0}}o(ym,"defineCallDescriptor");function bm(t,e){let r=Object.keys(e);if(r.length===0)return t;function n(i,s){t.call(this,i,s)}o(n,"CustomEvent"),n.prototype=Object.create(t.prototype,{constructor:{value:n,configurable:!0,writable:!0}});for(let i=0;i<r.length;++i){let s=r[i];if(!(s in t.prototype)){let l=typeof Object.getOwnPropertyDescriptor(e,s).value=="function";Object.defineProperty(n.prototype,s,l?ym(s):ed(s))}}return n}o(bm,"defineWrapper");function td(t){if(t==null||t===Object.prototype)return Ut;let e=wl.get(t);return e==null&&(e=bm(td(Object.getPrototypeOf(t)),t),wl.set(t,e)),e}o(td,"getWrapper");function wm(t,e){let r=td(Object.getPrototypeOf(e));return new r(t,e)}o(wm,"wrapEvent");function mm(t){return M(t).immediateStopped}o(mm,"isStopped");function _m(t,e){M(t).eventPhase=e}o(_m,"setEventPhase");function Sm(t,e){M(t).currentTarget=e}o(Sm,"setCurrentTarget");function Kf(t,e){M(t).passiveListener=e}o(Kf,"setPassiveListener");var rd=new WeakMap,Xf=1,Jf=2,yi=3;function bi(t){return t!==null&&typeof t=="object"}o(bi,"isObject");function Ir(t){let e=rd.get(t);if(e==null)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return e}o(Ir,"getListeners");function Em(t){return{get(){let r=Ir(this).get(t);for(;r!=null;){if(r.listenerType===yi)return r.listener;r=r.next}return null},set(e){typeof e!="function"&&!bi(e)&&(e=null);let r=Ir(this),n=null,i=r.get(t);for(;i!=null;)i.listenerType===yi?n!==null?n.next=i.next:i.next!==null?r.set(t,i.next):r.delete(t):n=i,i=i.next;if(e!==null){let s={listener:e,listenerType:yi,passive:!1,once:!1,next:null};n===null?r.set(t,s):n.next=s}},configurable:!0,enumerable:!0}}o(Em,"defineEventAttributeDescriptor");function ml(t,e){Object.defineProperty(t,`on${e}`,Em(e))}o(ml,"defineEventAttribute");function Zf(t){function e(){Oe.call(this)}o(e,"CustomEventTarget"),e.prototype=Object.create(Oe.prototype,{constructor:{value:e,configurable:!0,writable:!0}});for(let r=0;r<t.length;++r)ml(e.prototype,t[r]);return e}o(Zf,"defineCustomEventTarget");function Oe(){if(this instanceof Oe){rd.set(this,new Map);return}if(arguments.length===1&&Array.isArray(arguments[0]))return Zf(arguments[0]);if(arguments.length>0){let t=new Array(arguments.length);for(let e=0;e<arguments.length;++e)t[e]=arguments[e];return Zf(t)}throw new TypeError("Cannot call a class as a function")}o(Oe,"EventTarget");Oe.prototype={addEventListener(t,e,r){if(e==null)return;if(typeof e!="function"&&!bi(e))throw new TypeError("'listener' should be a function or an object.");let n=Ir(this),i=bi(r),a=(i?!!r.capture:!!r)?Xf:Jf,l={listener:e,listenerType:a,passive:i&&!!r.passive,once:i&&!!r.once,next:null},c=n.get(t);if(c===void 0){n.set(t,l);return}let u=null;for(;c!=null;){if(c.listener===e&&c.listenerType===a)return;u=c,c=c.next}u.next=l},removeEventListener(t,e,r){if(e==null)return;let n=Ir(this),s=(bi(r)?!!r.capture:!!r)?Xf:Jf,a=null,l=n.get(t);for(;l!=null;){if(l.listener===e&&l.listenerType===s){a!==null?a.next=l.next:l.next!==null?n.set(t,l.next):n.delete(t);return}a=l,l=l.next}},dispatchEvent(t){if(t==null||typeof t.type!="string")throw new TypeError('"event.type" should be a string.');let e=Ir(this),r=t.type,n=e.get(r);if(n==null)return!0;let i=wm(this,t),s=null;for(;n!=null;){if(n.once?s!==null?s.next=n.next:n.next!==null?e.set(r,n.next):e.delete(r):s=n,Kf(i,n.passive?n.listener:null),typeof n.listener=="function")try{n.listener.call(this,i)}catch(a){typeof console<"u"&&typeof console.error=="function"&&console.error(a)}else n.listenerType!==yi&&typeof n.listener.handleEvent=="function"&&n.listener.handleEvent(i);if(mm(i))break;n=n.next}return Kf(i,null),_m(i,0),Sm(i,null),!i.defaultPrevented}};Object.defineProperty(Oe.prototype,"constructor",{value:Oe,configurable:!0,writable:!0});typeof window<"u"&&typeof window.EventTarget<"u"&&Object.setPrototypeOf(Oe.prototype,window.EventTarget.prototype);Ar.defineEventAttribute=ml;Ar.EventTarget=Oe;Ar.default=Oe;Rr.exports=Oe;Rr.exports.EventTarget=Rr.exports.default=Oe;Rr.exports.defineEventAttribute=ml});var jt=m((zr,Or)=>{"use strict";Object.defineProperty(zr,"__esModule",{value:!0});var _l=nd(),Sl=class Sl extends _l.EventTarget{constructor(){throw super(),new TypeError("AbortSignal cannot be constructed directly")}get aborted(){let e=wi.get(this);if(typeof e!="boolean")throw new TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`);return e}};o(Sl,"AbortSignal");var ut=Sl;_l.defineEventAttribute(ut.prototype,"abort");function xm(){let t=Object.create(ut.prototype);return _l.EventTarget.call(t),wi.set(t,!1),t}o(xm,"createAbortSignal");function vm(t){wi.get(t)===!1&&(wi.set(t,!0),t.dispatchEvent({type:"abort"}))}o(vm,"abortSignal");var wi=new WeakMap;Object.defineProperties(ut.prototype,{aborted:{enumerable:!0}});typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ut.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});var El=class El{constructor(){sd.set(this,xm())}get signal(){return id(this)}abort(){vm(id(this))}};o(El,"AbortController");var ft=El,sd=new WeakMap;function id(t){let e=sd.get(t);if(e==null)throw new TypeError(`Expected 'this' to be an 'AbortController' object, but got ${t===null?"null":typeof t}`);return e}o(id,"getSignal");Object.defineProperties(ft.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}});typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ft.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"});zr.AbortController=ft;zr.AbortSignal=ut;zr.default=ft;Or.exports=ft;Or.exports.AbortController=Or.exports.default=ft;Or.exports.AbortSignal=ut});var ce=m((Y1,vl)=>{"use strict";var Tm=require("buffer"),{kResistStopPropagation:Im,SymbolDispose:Rm}=$(),Am=globalThis.AbortSignal||jt().AbortSignal,Om=globalThis.AbortController||jt().AbortController,zm=Object.getPrototypeOf(async function(){}).constructor,od=globalThis.Blob||Tm.Blob,Nm=o(typeof od<"u"?function(e){return e instanceof od}:function(e){return!1},"isBlob"),ad=o((t,e)=>{if(t!==void 0&&(t===null||typeof t!="object"||!("aborted"in t)))throw new ERR_INVALID_ARG_TYPE(e,"AbortSignal",t)},"validateAbortSignal"),km=o((t,e)=>{if(typeof t!="function")throw new ERR_INVALID_ARG_TYPE(e,"Function",t)},"validateFunction"),Tl=class Tl extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);let r="";for(let n=0;n<e.length;n++)r+=`    ${e[n].stack}
`;super(r),this.name="AggregateError",this.errors=e}};o(Tl,"AggregateError");var xl=Tl;vl.exports={AggregateError:xl,kEmptyObject:Object.freeze({}),once(t){let e=!1;return function(...r){e||(e=!0,t.apply(this,r))}},createDeferredPromise:function(){let t,e;return{promise:new Promise((n,i)=>{t=n,e=i}),resolve:t,reject:e}},promisify(t){return new Promise((e,r)=>{t((n,...i)=>n?r(n):e(...i))})},debuglog(){return function(){}},format(t,...e){return t.replace(/%([sdifj])/g,function(...[r,n]){let i=e.shift();return n==="f"?i.toFixed(6):n==="j"?JSON.stringify(i):n==="s"&&typeof i=="object"?`${i.constructor!==Object?i.constructor.name:""} {}`.trim():i.toString()})},inspect(t){switch(typeof t){case"string":if(t.includes("'"))if(t.includes('"')){if(!t.includes("`")&&!t.includes("${"))return`\`${t}\``}else return`"${t}"`;return`'${t}'`;case"number":return isNaN(t)?"NaN":Object.is(t,-0)?String(t):t;case"bigint":return`${String(t)}n`;case"boolean":case"undefined":return String(t);case"object":return"{}"}},types:{isAsyncFunction(t){return t instanceof zm},isArrayBufferView(t){return ArrayBuffer.isView(t)}},isBlob:Nm,deprecate(t,e){return t},addAbortListener:require("events").addAbortListener||o(function(e,r){if(e===void 0)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",e);ad(e,"signal"),km(r,"listener");let n;return e.aborted?queueMicrotask(()=>r()):(e.addEventListener("abort",r,{__proto__:null,once:!0,[Im]:!0}),n=o(()=>{e.removeEventListener("abort",r)},"removeEventListener")),{__proto__:null,[Rm](){var i;(i=n)===null||i===void 0||i()}}},"addAbortListener"),AbortSignalAny:Am.any||o(function(e){if(e.length===1)return e[0];let r=new Om,n=o(()=>r.abort(),"abort");return e.forEach(i=>{ad(i,"signals"),i.addEventListener("abort",n,{once:!0})}),r.signal.addEventListener("abort",()=>{e.forEach(i=>i.removeEventListener("abort",n))},{once:!0}),r.signal},"AbortSignalAny")};vl.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")});var pe=m((X1,ud)=>{"use strict";var{format:Pm,inspect:mi,AggregateError:Dm}=ce(),Cm=globalThis.AggregateError||Dm,Lm=Symbol("kIsNodeError"),qm=["string","function","number","object","Function","Object","boolean","bigint","symbol"],Bm=/^([A-Z][a-z0-9]*)+$/,Mm="__node_internal_",_i={};function St(t,e){if(!t)throw new _i.ERR_INTERNAL_ASSERTION(e)}o(St,"assert");function ld(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}o(ld,"addNumericalSeparator");function Um(t,e,r){if(typeof e=="function")return St(e.length<=r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${e.length}).`),e(...r);let n=(e.match(/%[dfijoOs]/g)||[]).length;return St(n===r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${n}).`),r.length===0?e:Pm(e,...r)}o(Um,"getMessage");function ae(t,e,r){r||(r=Error);let i=class i extends r{constructor(...a){super(Um(t,e,a))}toString(){return`${this.name} [${t}]: ${this.message}`}};o(i,"NodeError");let n=i;Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${t}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=t,n.prototype[Lm]=!0,_i[t]=n}o(ae,"E");function cd(t){let e=Mm+t.name;return Object.defineProperty(t,"name",{value:e}),t}o(cd,"hideStackFrames");function jm(t,e){if(t&&e&&t!==e){if(Array.isArray(e.errors))return e.errors.push(t),e;let r=new Cm([e,t],e.message);return r.code=e.code,r}return t||e}o(jm,"aggregateTwoErrors");var Rl=class Rl extends Error{constructor(e="The operation was aborted",r=void 0){if(r!==void 0&&typeof r!="object")throw new _i.ERR_INVALID_ARG_TYPE("options","Object",r);super(e,r),this.code="ABORT_ERR",this.name="AbortError"}};o(Rl,"AbortError");var Il=Rl;ae("ERR_ASSERTION","%s",Error);ae("ERR_INVALID_ARG_TYPE",(t,e,r)=>{St(typeof t=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let n="The ";t.endsWith(" argument")?n+=`${t} `:n+=`"${t}" ${t.includes(".")?"property":"argument"} `,n+="must be ";let i=[],s=[],a=[];for(let c of e)St(typeof c=="string","All expected entries have to be of type string"),qm.includes(c)?i.push(c.toLowerCase()):Bm.test(c)?s.push(c):(St(c!=="object",'The value "object" should be written as "Object"'),a.push(c));if(s.length>0){let c=i.indexOf("object");c!==-1&&(i.splice(i,c,1),s.push("Object"))}if(i.length>0){switch(i.length){case 1:n+=`of type ${i[0]}`;break;case 2:n+=`one of type ${i[0]} or ${i[1]}`;break;default:{let c=i.pop();n+=`one of type ${i.join(", ")}, or ${c}`}}(s.length>0||a.length>0)&&(n+=" or ")}if(s.length>0){switch(s.length){case 1:n+=`an instance of ${s[0]}`;break;case 2:n+=`an instance of ${s[0]} or ${s[1]}`;break;default:{let c=s.pop();n+=`an instance of ${s.join(", ")}, or ${c}`}}a.length>0&&(n+=" or ")}switch(a.length){case 0:break;case 1:a[0].toLowerCase()!==a[0]&&(n+="an "),n+=`${a[0]}`;break;case 2:n+=`one of ${a[0]} or ${a[1]}`;break;default:{let c=a.pop();n+=`one of ${a.join(", ")}, or ${c}`}}if(r==null)n+=`. Received ${r}`;else if(typeof r=="function"&&r.name)n+=`. Received function ${r.name}`;else if(typeof r=="object"){var l;if((l=r.constructor)!==null&&l!==void 0&&l.name)n+=`. Received an instance of ${r.constructor.name}`;else{let c=mi(r,{depth:-1});n+=`. Received ${c}`}}else{let c=mi(r,{colors:!1});c.length>25&&(c=`${c.slice(0,25)}...`),n+=`. Received type ${typeof r} (${c})`}return n},TypeError);ae("ERR_INVALID_ARG_VALUE",(t,e,r="is invalid")=>{let n=mi(e);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${t.includes(".")?"property":"argument"} '${t}' ${r}. Received ${n}`},TypeError);ae("ERR_INVALID_RETURN_VALUE",(t,e,r)=>{var n;let i=r!=null&&(n=r.constructor)!==null&&n!==void 0&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${t} to be returned from the "${e}" function but got ${i}.`},TypeError);ae("ERR_MISSING_ARGS",(...t)=>{St(t.length>0,"At least one arg needs to be specified");let e,r=t.length;switch(t=(Array.isArray(t)?t:[t]).map(n=>`"${n}"`).join(" or "),r){case 1:e+=`The ${t[0]} argument`;break;case 2:e+=`The ${t[0]} and ${t[1]} arguments`;break;default:{let n=t.pop();e+=`The ${t.join(", ")}, and ${n} arguments`}break}return`${e} must be specified`},TypeError);ae("ERR_OUT_OF_RANGE",(t,e,r)=>{St(e,'Missing "range" argument');let n;return Number.isInteger(r)&&Math.abs(r)>2**32?n=ld(String(r)):typeof r=="bigint"?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=ld(n)),n+="n"):n=mi(r),`The value of "${t}" is out of range. It must be ${e}. Received ${n}`},RangeError);ae("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);ae("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);ae("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);ae("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);ae("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);ae("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);ae("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);ae("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);ae("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);ae("ERR_STREAM_WRITE_AFTER_END","write after end",Error);ae("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);ud.exports={AbortError:Il,aggregateTwoErrors:cd(jm),hideStackFrames:cd,codes:_i}});var $t=m((Z1,_d)=>{"use strict";var{ArrayIsArray:Ol,ArrayPrototypeIncludes:pd,ArrayPrototypeJoin:gd,ArrayPrototypeMap:Vm,NumberIsInteger:zl,NumberIsNaN:$m,NumberMAX_SAFE_INTEGER:Wm,NumberMIN_SAFE_INTEGER:Fm,NumberParseInt:Gm,ObjectPrototypeHasOwnProperty:Hm,RegExpPrototypeExec:yd,String:Ym,StringPrototypeToUpperCase:Km,StringPrototypeTrim:Xm}=$(),{hideStackFrames:xe,codes:{ERR_SOCKET_BAD_PORT:Jm,ERR_INVALID_ARG_TYPE:ue,ERR_INVALID_ARG_VALUE:Vt,ERR_OUT_OF_RANGE:Et,ERR_UNKNOWN_SIGNAL:fd}}=pe(),{normalizeEncoding:Zm}=ce(),{isAsyncFunction:Qm,isArrayBufferView:e0}=ce().types,dd={};function t0(t){return t===(t|0)}o(t0,"isInt32");function r0(t){return t===t>>>0}o(r0,"isUint32");var n0=/^[0-7]+$/,i0="must be a 32-bit unsigned integer or an octal string";function s0(t,e,r){if(typeof t>"u"&&(t=r),typeof t=="string"){if(yd(n0,t)===null)throw new Vt(e,t,i0);t=Gm(t,8)}return bd(t,e),t}o(s0,"parseFileMode");var o0=xe((t,e,r=Fm,n=Wm)=>{if(typeof t!="number")throw new ue(e,"number",t);if(!zl(t))throw new Et(e,"an integer",t);if(t<r||t>n)throw new Et(e,`>= ${r} && <= ${n}`,t)}),a0=xe((t,e,r=-2147483648,n=2147483647)=>{if(typeof t!="number")throw new ue(e,"number",t);if(!zl(t))throw new Et(e,"an integer",t);if(t<r||t>n)throw new Et(e,`>= ${r} && <= ${n}`,t)}),bd=xe((t,e,r=!1)=>{if(typeof t!="number")throw new ue(e,"number",t);if(!zl(t))throw new Et(e,"an integer",t);let n=r?1:0,i=4294967295;if(t<n||t>i)throw new Et(e,`>= ${n} && <= ${i}`,t)});function Nl(t,e){if(typeof t!="string")throw new ue(e,"string",t)}o(Nl,"validateString");function l0(t,e,r=void 0,n){if(typeof t!="number")throw new ue(e,"number",t);if(r!=null&&t<r||n!=null&&t>n||(r!=null||n!=null)&&$m(t))throw new Et(e,`${r!=null?`>= ${r}`:""}${r!=null&&n!=null?" && ":""}${n!=null?`<= ${n}`:""}`,t)}o(l0,"validateNumber");var c0=xe((t,e,r)=>{if(!pd(r,t)){let i="must be one of: "+gd(Vm(r,s=>typeof s=="string"?`'${s}'`:Ym(s)),", ");throw new Vt(e,t,i)}});function wd(t,e){if(typeof t!="boolean")throw new ue(e,"boolean",t)}o(wd,"validateBoolean");function Al(t,e,r){return t==null||!Hm(t,e)?r:t[e]}o(Al,"getOwnPropertyValueOrDefault");var u0=xe((t,e,r=null)=>{let n=Al(r,"allowArray",!1),i=Al(r,"allowFunction",!1);if(!Al(r,"nullable",!1)&&t===null||!n&&Ol(t)||typeof t!="object"&&(!i||typeof t!="function"))throw new ue(e,"Object",t)}),f0=xe((t,e)=>{if(t!=null&&typeof t!="object"&&typeof t!="function")throw new ue(e,"a dictionary",t)}),Si=xe((t,e,r=0)=>{if(!Ol(t))throw new ue(e,"Array",t);if(t.length<r){let n=`must be longer than ${r}`;throw new Vt(e,t,n)}});function d0(t,e){Si(t,e);for(let r=0;r<t.length;r++)Nl(t[r],`${e}[${r}]`)}o(d0,"validateStringArray");function h0(t,e){Si(t,e);for(let r=0;r<t.length;r++)wd(t[r],`${e}[${r}]`)}o(h0,"validateBooleanArray");function p0(t,e){Si(t,e);for(let r=0;r<t.length;r++){let n=t[r],i=`${e}[${r}]`;if(n==null)throw new ue(i,"AbortSignal",n);md(n,i)}}o(p0,"validateAbortSignalArray");function g0(t,e="signal"){if(Nl(t,e),dd[t]===void 0)throw dd[Km(t)]!==void 0?new fd(t+" (signals must use all capital letters)"):new fd(t)}o(g0,"validateSignalName");var y0=xe((t,e="buffer")=>{if(!e0(t))throw new ue(e,["Buffer","TypedArray","DataView"],t)});function b0(t,e){let r=Zm(e),n=t.length;if(r==="hex"&&n%2!==0)throw new Vt("encoding",e,`is invalid for data of length ${n}`)}o(b0,"validateEncoding");function w0(t,e="Port",r=!0){if(typeof t!="number"&&typeof t!="string"||typeof t=="string"&&Xm(t).length===0||+t!==+t>>>0||t>65535||t===0&&!r)throw new Jm(e,t,r);return t|0}o(w0,"validatePort");var md=xe((t,e)=>{if(t!==void 0&&(t===null||typeof t!="object"||!("aborted"in t)))throw new ue(e,"AbortSignal",t)}),m0=xe((t,e)=>{if(typeof t!="function")throw new ue(e,"Function",t)}),_0=xe((t,e)=>{if(typeof t!="function"||Qm(t))throw new ue(e,"Function",t)}),S0=xe((t,e)=>{if(t!==void 0)throw new ue(e,"undefined",t)});function E0(t,e,r){if(!pd(r,t))throw new ue(e,`('${gd(r,"|")}')`,t)}o(E0,"validateUnion");var x0=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function hd(t,e){if(typeof t>"u"||!yd(x0,t))throw new Vt(e,t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}o(hd,"validateLinkHeaderFormat");function v0(t){if(typeof t=="string")return hd(t,"hints"),t;if(Ol(t)){let e=t.length,r="";if(e===0)return r;for(let n=0;n<e;n++){let i=t[n];hd(i,"hints"),r+=i,n!==e-1&&(r+=", ")}return r}throw new Vt("hints",t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}o(v0,"validateLinkHeaderValue");_d.exports={isInt32:t0,isUint32:r0,parseFileMode:s0,validateArray:Si,validateStringArray:d0,validateBooleanArray:h0,validateAbortSignalArray:p0,validateBoolean:wd,validateBuffer:y0,validateDictionary:f0,validateEncoding:b0,validateFunction:m0,validateInt32:a0,validateInteger:o0,validateNumber:l0,validateObject:u0,validateOneOf:c0,validatePlainFunction:_0,validatePort:w0,validateSignalName:g0,validateString:Nl,validateUint32:bd,validateUndefined:S0,validateUnion:E0,validateAbortSignal:md,validateLinkHeaderValue:v0}});var dt=m((eI,Sd)=>{Sd.exports=global.process});var qe=m((tI,Ld)=>{"use strict";var{SymbolAsyncIterator:Ed,SymbolIterator:xd,SymbolFor:xt}=$(),vd=xt("nodejs.stream.destroyed"),Td=xt("nodejs.stream.errored"),kl=xt("nodejs.stream.readable"),Pl=xt("nodejs.stream.writable"),Id=xt("nodejs.stream.disturbed"),T0=xt("nodejs.webstream.isClosedPromise"),I0=xt("nodejs.webstream.controllerErrorFunction");function Ei(t,e=!1){var r;return!!(t&&typeof t.pipe=="function"&&typeof t.on=="function"&&(!e||typeof t.pause=="function"&&typeof t.resume=="function")&&(!t._writableState||((r=t._readableState)===null||r===void 0?void 0:r.readable)!==!1)&&(!t._writableState||t._readableState))}o(Ei,"isReadableNodeStream");function xi(t){var e;return!!(t&&typeof t.write=="function"&&typeof t.on=="function"&&(!t._readableState||((e=t._writableState)===null||e===void 0?void 0:e.writable)!==!1))}o(xi,"isWritableNodeStream");function R0(t){return!!(t&&typeof t.pipe=="function"&&t._readableState&&typeof t.on=="function"&&typeof t.write=="function")}o(R0,"isDuplexNodeStream");function Le(t){return t&&(t._readableState||t._writableState||typeof t.write=="function"&&typeof t.on=="function"||typeof t.pipe=="function"&&typeof t.on=="function")}o(Le,"isNodeStream");function Rd(t){return!!(t&&!Le(t)&&typeof t.pipeThrough=="function"&&typeof t.getReader=="function"&&typeof t.cancel=="function")}o(Rd,"isReadableStream");function Ad(t){return!!(t&&!Le(t)&&typeof t.getWriter=="function"&&typeof t.abort=="function")}o(Ad,"isWritableStream");function Od(t){return!!(t&&!Le(t)&&typeof t.readable=="object"&&typeof t.writable=="object")}o(Od,"isTransformStream");function A0(t){return Rd(t)||Ad(t)||Od(t)}o(A0,"isWebStream");function O0(t,e){return t==null?!1:e===!0?typeof t[Ed]=="function":e===!1?typeof t[xd]=="function":typeof t[Ed]=="function"||typeof t[xd]=="function"}o(O0,"isIterable");function vi(t){if(!Le(t))return null;let e=t._writableState,r=t._readableState,n=e||r;return!!(t.destroyed||t[vd]||n!=null&&n.destroyed)}o(vi,"isDestroyed");function zd(t){if(!xi(t))return null;if(t.writableEnded===!0)return!0;let e=t._writableState;return e!=null&&e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}o(zd,"isWritableEnded");function z0(t,e){if(!xi(t))return null;if(t.writableFinished===!0)return!0;let r=t._writableState;return r!=null&&r.errored?!1:typeof(r==null?void 0:r.finished)!="boolean"?null:!!(r.finished||e===!1&&r.ended===!0&&r.length===0)}o(z0,"isWritableFinished");function N0(t){if(!Ei(t))return null;if(t.readableEnded===!0)return!0;let e=t._readableState;return!e||e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}o(N0,"isReadableEnded");function Nd(t,e){if(!Ei(t))return null;let r=t._readableState;return r!=null&&r.errored?!1:typeof(r==null?void 0:r.endEmitted)!="boolean"?null:!!(r.endEmitted||e===!1&&r.ended===!0&&r.length===0)}o(Nd,"isReadableFinished");function kd(t){return t&&t[kl]!=null?t[kl]:typeof(t==null?void 0:t.readable)!="boolean"?null:vi(t)?!1:Ei(t)&&t.readable&&!Nd(t)}o(kd,"isReadable");function Pd(t){return t&&t[Pl]!=null?t[Pl]:typeof(t==null?void 0:t.writable)!="boolean"?null:vi(t)?!1:xi(t)&&t.writable&&!zd(t)}o(Pd,"isWritable");function k0(t,e){return Le(t)?vi(t)?!0:!((e==null?void 0:e.readable)!==!1&&kd(t)||(e==null?void 0:e.writable)!==!1&&Pd(t)):null}o(k0,"isFinished");function P0(t){var e,r;return Le(t)?t.writableErrored?t.writableErrored:(e=(r=t._writableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}o(P0,"isWritableErrored");function D0(t){var e,r;return Le(t)?t.readableErrored?t.readableErrored:(e=(r=t._readableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}o(D0,"isReadableErrored");function C0(t){if(!Le(t))return null;if(typeof t.closed=="boolean")return t.closed;let e=t._writableState,r=t._readableState;return typeof(e==null?void 0:e.closed)=="boolean"||typeof(r==null?void 0:r.closed)=="boolean"?(e==null?void 0:e.closed)||(r==null?void 0:r.closed):typeof t._closed=="boolean"&&Dd(t)?t._closed:null}o(C0,"isClosed");function Dd(t){return typeof t._closed=="boolean"&&typeof t._defaultKeepAlive=="boolean"&&typeof t._removedConnection=="boolean"&&typeof t._removedContLen=="boolean"}o(Dd,"isOutgoingMessage");function Cd(t){return typeof t._sent100=="boolean"&&Dd(t)}o(Cd,"isServerResponse");function L0(t){var e;return typeof t._consuming=="boolean"&&typeof t._dumped=="boolean"&&((e=t.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}o(L0,"isServerRequest");function q0(t){if(!Le(t))return null;let e=t._writableState,r=t._readableState,n=e||r;return!n&&Cd(t)||!!(n&&n.autoDestroy&&n.emitClose&&n.closed===!1)}o(q0,"willEmitClose");function B0(t){var e;return!!(t&&((e=t[Id])!==null&&e!==void 0?e:t.readableDidRead||t.readableAborted))}o(B0,"isDisturbed");function M0(t){var e,r,n,i,s,a,l,c,u,f;return!!(t&&((e=(r=(n=(i=(s=(a=t[Td])!==null&&a!==void 0?a:t.readableErrored)!==null&&s!==void 0?s:t.writableErrored)!==null&&i!==void 0?i:(l=t._readableState)===null||l===void 0?void 0:l.errorEmitted)!==null&&n!==void 0?n:(c=t._writableState)===null||c===void 0?void 0:c.errorEmitted)!==null&&r!==void 0?r:(u=t._readableState)===null||u===void 0?void 0:u.errored)!==null&&e!==void 0?e:!((f=t._writableState)===null||f===void 0)&&f.errored))}o(M0,"isErrored");Ld.exports={isDestroyed:vi,kIsDestroyed:vd,isDisturbed:B0,kIsDisturbed:Id,isErrored:M0,kIsErrored:Td,isReadable:kd,kIsReadable:kl,kIsClosedPromise:T0,kControllerErrorFunction:I0,kIsWritable:Pl,isClosed:C0,isDuplexNodeStream:R0,isFinished:k0,isIterable:O0,isReadableNodeStream:Ei,isReadableStream:Rd,isReadableEnded:N0,isReadableFinished:Nd,isReadableErrored:D0,isNodeStream:Le,isWebStream:A0,isWritable:Pd,isWritableNodeStream:xi,isWritableStream:Ad,isWritableEnded:zd,isWritableFinished:z0,isWritableErrored:P0,isServerRequest:L0,isServerResponse:Cd,willEmitClose:q0,isTransformStream:Od}});var Ze=m((nI,Bl)=>{var ht=dt(),{AbortError:Fd,codes:U0}=pe(),{ERR_INVALID_ARG_TYPE:j0,ERR_STREAM_PREMATURE_CLOSE:qd}=U0,{kEmptyObject:Cl,once:Ll}=ce(),{validateAbortSignal:V0,validateFunction:$0,validateObject:W0,validateBoolean:F0}=$t(),{Promise:G0,PromisePrototypeThen:H0,SymbolDispose:Gd}=$(),{isClosed:Y0,isReadable:Bd,isReadableNodeStream:Dl,isReadableStream:K0,isReadableFinished:Md,isReadableErrored:Ud,isWritable:jd,isWritableNodeStream:Vd,isWritableStream:X0,isWritableFinished:$d,isWritableErrored:Wd,isNodeStream:J0,willEmitClose:Z0,kIsClosedPromise:Q0}=qe(),Wt;function e_(t){return t.setHeader&&typeof t.abort=="function"}o(e_,"isRequest");var ql=o(()=>{},"nop");function Hd(t,e,r){var n,i;if(arguments.length===2?(r=e,e=Cl):e==null?e=Cl:W0(e,"options"),$0(r,"callback"),V0(e.signal,"options.signal"),r=Ll(r),K0(t)||X0(t))return t_(t,e,r);if(!J0(t))throw new j0("stream",["ReadableStream","WritableStream","Stream"],t);let s=(n=e.readable)!==null&&n!==void 0?n:Dl(t),a=(i=e.writable)!==null&&i!==void 0?i:Vd(t),l=t._writableState,c=t._readableState,u=o(()=>{t.writable||p()},"onlegacyfinish"),f=Z0(t)&&Dl(t)===s&&Vd(t)===a,d=$d(t,!1),p=o(()=>{d=!0,t.destroyed&&(f=!1),!(f&&(!t.readable||s))&&(!s||y)&&r.call(t)},"onfinish"),y=Md(t,!1),_=o(()=>{y=!0,t.destroyed&&(f=!1),!(f&&(!t.writable||a))&&(!a||d)&&r.call(t)},"onend"),g=o(x=>{r.call(t,x)},"onerror"),I=Y0(t),T=o(()=>{I=!0;let x=Wd(t)||Ud(t);if(x&&typeof x!="boolean")return r.call(t,x);if(s&&!y&&Dl(t,!0)&&!Md(t,!1))return r.call(t,new qd);if(a&&!d&&!$d(t,!1))return r.call(t,new qd);r.call(t)},"onclose"),R=o(()=>{I=!0;let x=Wd(t)||Ud(t);if(x&&typeof x!="boolean")return r.call(t,x);r.call(t)},"onclosed"),D=o(()=>{t.req.on("finish",p)},"onrequest");e_(t)?(t.on("complete",p),f||t.on("abort",T),t.req?D():t.on("request",D)):a&&!l&&(t.on("end",u),t.on("close",u)),!f&&typeof t.aborted=="boolean"&&t.on("aborted",T),t.on("end",_),t.on("finish",p),e.error!==!1&&t.on("error",g),t.on("close",T),I?ht.nextTick(T):l!=null&&l.errorEmitted||c!=null&&c.errorEmitted?f||ht.nextTick(R):(!s&&(!f||Bd(t))&&(d||jd(t)===!1)||!a&&(!f||jd(t))&&(y||Bd(t)===!1)||c&&t.req&&t.aborted)&&ht.nextTick(R);let z=o(()=>{r=ql,t.removeListener("aborted",T),t.removeListener("complete",p),t.removeListener("abort",T),t.removeListener("request",D),t.req&&t.req.removeListener("finish",p),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",p),t.removeListener("end",_),t.removeListener("error",g),t.removeListener("close",T)},"cleanup");if(e.signal&&!I){let x=o(()=>{let de=r;z(),de.call(t,new Fd(void 0,{cause:e.signal.reason}))},"abort");if(e.signal.aborted)ht.nextTick(x);else{Wt=Wt||ce().addAbortListener;let de=Wt(e.signal,x),te=r;r=Ll((...Re)=>{de[Gd](),te.apply(t,Re)})}}return z}o(Hd,"eos");function t_(t,e,r){let n=!1,i=ql;if(e.signal)if(i=o(()=>{n=!0,r.call(t,new Fd(void 0,{cause:e.signal.reason}))},"abort"),e.signal.aborted)ht.nextTick(i);else{Wt=Wt||ce().addAbortListener;let a=Wt(e.signal,i),l=r;r=Ll((...c)=>{a[Gd](),l.apply(t,c)})}let s=o((...a)=>{n||ht.nextTick(()=>r.apply(t,a))},"resolverFn");return H0(t[Q0].promise,s,s),ql}o(t_,"eosWeb");function r_(t,e){var r;let n=!1;return e===null&&(e=Cl),(r=e)!==null&&r!==void 0&&r.cleanup&&(F0(e.cleanup,"cleanup"),n=e.cleanup),new G0((i,s)=>{let a=Hd(t,e,l=>{n&&a(),l?s(l):i()})})}o(r_,"finished");Bl.exports=Hd;Bl.exports.finished=r_});var vt=m((sI,th)=>{"use strict";var Be=dt(),{aggregateTwoErrors:n_,codes:{ERR_MULTIPLE_CALLBACK:i_},AbortError:s_}=pe(),{Symbol:Xd}=$(),{kIsDestroyed:o_,isDestroyed:a_,isFinished:l_,isServerRequest:c_}=qe(),Jd=Xd("kDestroy"),Ml=Xd("kConstruct");function Zd(t,e,r){t&&(t.stack,e&&!e.errored&&(e.errored=t),r&&!r.errored&&(r.errored=t))}o(Zd,"checkError");function u_(t,e){let r=this._readableState,n=this._writableState,i=n||r;return n!=null&&n.destroyed||r!=null&&r.destroyed?(typeof e=="function"&&e(),this):(Zd(t,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),i.constructed?Yd(this,t,e):this.once(Jd,function(s){Yd(this,n_(s,t),e)}),this)}o(u_,"destroy");function Yd(t,e,r){let n=!1;function i(s){if(n)return;n=!0;let a=t._readableState,l=t._writableState;Zd(s,l,a),l&&(l.closed=!0),a&&(a.closed=!0),typeof r=="function"&&r(s),s?Be.nextTick(f_,t,s):Be.nextTick(Qd,t)}o(i,"onDestroy");try{t._destroy(e||null,i)}catch(s){i(s)}}o(Yd,"_destroy");function f_(t,e){Ul(t,e),Qd(t)}o(f_,"emitErrorCloseNT");function Qd(t){let e=t._readableState,r=t._writableState;r&&(r.closeEmitted=!0),e&&(e.closeEmitted=!0),(r!=null&&r.emitClose||e!=null&&e.emitClose)&&t.emit("close")}o(Qd,"emitCloseNT");function Ul(t,e){let r=t._readableState,n=t._writableState;n!=null&&n.errorEmitted||r!=null&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),t.emit("error",e))}o(Ul,"emitErrorNT");function d_(){let t=this._readableState,e=this._writableState;t&&(t.constructed=!0,t.closed=!1,t.closeEmitted=!1,t.destroyed=!1,t.errored=null,t.errorEmitted=!1,t.reading=!1,t.ended=t.readable===!1,t.endEmitted=t.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}o(d_,"undestroy");function jl(t,e,r){let n=t._readableState,i=t._writableState;if(i!=null&&i.destroyed||n!=null&&n.destroyed)return this;n!=null&&n.autoDestroy||i!=null&&i.autoDestroy?t.destroy(e):e&&(e.stack,i&&!i.errored&&(i.errored=e),n&&!n.errored&&(n.errored=e),r?Be.nextTick(Ul,t,e):Ul(t,e))}o(jl,"errorOrDestroy");function h_(t,e){if(typeof t._construct!="function")return;let r=t._readableState,n=t._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),t.once(Ml,e),!(t.listenerCount(Ml)>1)&&Be.nextTick(p_,t)}o(h_,"construct");function p_(t){let e=!1;function r(n){if(e){jl(t,n??new i_);return}e=!0;let i=t._readableState,s=t._writableState,a=s||i;i&&(i.constructed=!0),s&&(s.constructed=!0),a.destroyed?t.emit(Jd,n):n?jl(t,n,!0):Be.nextTick(g_,t)}o(r,"onConstruct");try{t._construct(n=>{Be.nextTick(r,n)})}catch(n){Be.nextTick(r,n)}}o(p_,"constructNT");function g_(t){t.emit(Ml)}o(g_,"emitConstructNT");function Kd(t){return(t==null?void 0:t.setHeader)&&typeof t.abort=="function"}o(Kd,"isRequest");function eh(t){t.emit("close")}o(eh,"emitCloseLegacy");function y_(t,e){t.emit("error",e),Be.nextTick(eh,t)}o(y_,"emitErrorCloseLegacy");function b_(t,e){!t||a_(t)||(!e&&!l_(t)&&(e=new s_),c_(t)?(t.socket=null,t.destroy(e)):Kd(t)?t.abort():Kd(t.req)?t.req.abort():typeof t.destroy=="function"?t.destroy(e):typeof t.close=="function"?t.close():e?Be.nextTick(y_,t,e):Be.nextTick(eh,t),t.destroyed||(t[o_]=!0))}o(b_,"destroyer");th.exports={construct:h_,destroyer:b_,destroy:u_,undestroy:d_,errorOrDestroy:jl}});var Ri=m((aI,nh)=>{"use strict";var{ArrayIsArray:w_,ObjectSetPrototypeOf:rh}=$(),{EventEmitter:Ti}=require("events");function Ii(t){Ti.call(this,t)}o(Ii,"Stream");rh(Ii.prototype,Ti.prototype);rh(Ii,Ti);Ii.prototype.pipe=function(t,e){let r=this;function n(f){t.writable&&t.write(f)===!1&&r.pause&&r.pause()}o(n,"ondata"),r.on("data",n);function i(){r.readable&&r.resume&&r.resume()}o(i,"ondrain"),t.on("drain",i),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",a),r.on("close",l));let s=!1;function a(){s||(s=!0,t.end())}o(a,"onend");function l(){s||(s=!0,typeof t.destroy=="function"&&t.destroy())}o(l,"onclose");function c(f){u(),Ti.listenerCount(this,"error")===0&&this.emit("error",f)}o(c,"onerror"),Vl(r,"error",c),Vl(t,"error",c);function u(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",a),r.removeListener("close",l),r.removeListener("error",c),t.removeListener("error",c),r.removeListener("end",u),r.removeListener("close",u),t.removeListener("close",u)}return o(u,"cleanup"),r.on("end",u),r.on("close",u),t.on("close",u),t.emit("pipe",r),t};function Vl(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):w_(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}o(Vl,"prependListener");nh.exports={Stream:Ii,prependListener:Vl}});var Nr=m((cI,Ai)=>{"use strict";var{SymbolDispose:m_}=$(),{AbortError:ih,codes:__}=pe(),{isNodeStream:sh,isWebStream:S_,kControllerErrorFunction:E_}=qe(),x_=Ze(),{ERR_INVALID_ARG_TYPE:oh}=__,$l,v_=o((t,e)=>{if(typeof t!="object"||!("aborted"in t))throw new oh(e,"AbortSignal",t)},"validateAbortSignal");Ai.exports.addAbortSignal=o(function(e,r){if(v_(e,"signal"),!sh(r)&&!S_(r))throw new oh("stream",["ReadableStream","WritableStream","Stream"],r);return Ai.exports.addAbortSignalNoValidate(e,r)},"addAbortSignal");Ai.exports.addAbortSignalNoValidate=function(t,e){if(typeof t!="object"||!("aborted"in t))return e;let r=sh(e)?()=>{e.destroy(new ih(void 0,{cause:t.reason}))}:()=>{e[E_](new ih(void 0,{cause:t.reason}))};if(t.aborted)r();else{$l=$l||ce().addAbortListener;let n=$l(t,r);x_(e,n[m_])}return e}});var ch=m((fI,lh)=>{"use strict";var{StringPrototypeSlice:ah,SymbolIterator:T_,TypedArrayPrototypeSet:Oi,Uint8Array:I_}=$(),{Buffer:Wl}=require("buffer"),{inspect:R_}=ce(),kr;lh.exports=(kr=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){let r={data:e,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}unshift(e){let r={data:e,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}shift(){if(this.length===0)return;let e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let r=this.head,n=""+r.data;for(;(r=r.next)!==null;)n+=e+r.data;return n}concat(e){if(this.length===0)return Wl.alloc(0);let r=Wl.allocUnsafe(e>>>0),n=this.head,i=0;for(;n;)Oi(r,n.data,i),i+=n.data.length,n=n.next;return r}consume(e,r){let n=this.head.data;if(e<n.length){let i=n.slice(0,e);return this.head.data=n.slice(e),i}return e===n.length?this.shift():r?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[T_](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let r="",n=this.head,i=0;do{let s=n.data;if(e>s.length)r+=s,e-=s.length;else{e===s.length?(r+=s,++i,n.next?this.head=n.next:this.head=this.tail=null):(r+=ah(s,0,e),this.head=n,n.data=ah(s,e));break}++i}while((n=n.next)!==null);return this.length-=i,r}_getBuffer(e){let r=Wl.allocUnsafe(e),n=e,i=this.head,s=0;do{let a=i.data;if(e>a.length)Oi(r,a,n-e),e-=a.length;else{e===a.length?(Oi(r,a,n-e),++s,i.next?this.head=i.next:this.head=this.tail=null):(Oi(r,new I_(a.buffer,a.byteOffset,e),n-e),this.head=i,i.data=a.slice(e));break}++s}while((i=i.next)!==null);return this.length-=s,r}[Symbol.for("nodejs.util.inspect.custom")](e,r){return R_(this,{...r,depth:0,customInspect:!1})}},o(kr,"BufferList"),kr)});var Pr=m((hI,hh)=>{"use strict";var{MathFloor:A_,NumberIsInteger:O_}=$(),{validateInteger:z_}=$t(),{ERR_INVALID_ARG_VALUE:N_}=pe().codes,uh=16*1024,fh=16;function k_(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}o(k_,"highWaterMarkFrom");function dh(t){return t?fh:uh}o(dh,"getDefaultHighWaterMark");function P_(t,e){z_(e,"value",0),t?fh=e:uh=e}o(P_,"setDefaultHighWaterMark");function D_(t,e,r,n){let i=k_(e,n,r);if(i!=null){if(!O_(i)||i<0){let s=n?`options.${r}`:"options.highWaterMark";throw new N_(s,i)}return A_(i)}return dh(t.objectMode)}o(D_,"getHighWaterMark");hh.exports={getHighWaterMark:D_,getDefaultHighWaterMark:dh,setDefaultHighWaterMark:P_}});var Fl=m((gI,bh)=>{"use strict";var ph=dt(),{PromisePrototypeThen:C_,SymbolAsyncIterator:gh,SymbolIterator:yh}=$(),{Buffer:L_}=require("buffer"),{ERR_INVALID_ARG_TYPE:q_,ERR_STREAM_NULL_VALUES:B_}=pe().codes;function M_(t,e,r){let n;if(typeof e=="string"||e instanceof L_)return new t({objectMode:!0,...r,read(){this.push(e),this.push(null)}});let i;if(e&&e[gh])i=!0,n=e[gh]();else if(e&&e[yh])i=!1,n=e[yh]();else throw new q_("iterable",["Iterable"],e);let s=new t({objectMode:!0,highWaterMark:1,...r}),a=!1;s._read=function(){a||(a=!0,c())},s._destroy=function(u,f){C_(l(u),()=>ph.nextTick(f,u),d=>ph.nextTick(f,d||u))};async function l(u){let f=u!=null,d=typeof n.throw=="function";if(f&&d){let{value:p,done:y}=await n.throw(u);if(await p,y)return}if(typeof n.return=="function"){let{value:p}=await n.return();await p}}o(l,"close");async function c(){for(;;){try{let{value:u,done:f}=i?await n.next():n.next();if(f)s.push(null);else{let d=u&&typeof u.then=="function"?await u:u;if(d===null)throw a=!1,new B_;if(s.push(d))continue;a=!1}}catch(u){s.destroy(u)}break}}return o(c,"next"),s}o(M_,"from");bh.exports=M_});var Cr=m((bI,Ch)=>{var ze=dt(),{ArrayPrototypeIndexOf:U_,NumberIsInteger:j_,NumberIsNaN:V_,NumberParseInt:$_,ObjectDefineProperties:Ql,ObjectKeys:W_,ObjectSetPrototypeOf:_h,Promise:Sh,SafeSet:F_,SymbolAsyncDispose:G_,SymbolAsyncIterator:H_,Symbol:Y_}=$();Ch.exports=N;N.ReadableState=Pi;var{EventEmitter:K_}=require("events"),{Stream:pt,prependListener:X_}=Ri(),{Buffer:Gl}=require("buffer"),{addAbortSignal:J_}=Nr(),Eh=Ze(),L=ce().debuglog("stream",t=>{L=t}),Z_=ch(),Ht=vt(),{getHighWaterMark:Q_,getDefaultHighWaterMark:eS}=Pr(),{aggregateTwoErrors:wh,codes:{ERR_INVALID_ARG_TYPE:tS,ERR_METHOD_NOT_IMPLEMENTED:rS,ERR_OUT_OF_RANGE:nS,ERR_STREAM_PUSH_AFTER_EOF:iS,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:sS},AbortError:oS}=pe(),{validateObject:aS}=$t(),Tt=Y_("kPaused"),{StringDecoder:xh}=require("string_decoder"),lS=Fl();_h(N.prototype,pt.prototype);_h(N,pt);var Hl=o(()=>{},"nop"),{errorOrDestroy:Ft}=Ht,Gt=1,cS=2,vh=4,Dr=8,Th=16,zi=32,Ni=64,Ih=128,uS=256,fS=512,dS=1024,Jl=2048,Zl=4096,hS=8192,pS=16384,gS=32768,Rh=65536,yS=1<<17,bS=1<<18;function Z(t){return{enumerable:!1,get(){return(this.state&t)!==0},set(e){e?this.state|=t:this.state&=~t}}}o(Z,"makeBitMapDescriptor");Ql(Pi.prototype,{objectMode:Z(Gt),ended:Z(cS),endEmitted:Z(vh),reading:Z(Dr),constructed:Z(Th),sync:Z(zi),needReadable:Z(Ni),emittedReadable:Z(Ih),readableListening:Z(uS),resumeScheduled:Z(fS),errorEmitted:Z(dS),emitClose:Z(Jl),autoDestroy:Z(Zl),destroyed:Z(hS),closed:Z(pS),closeEmitted:Z(gS),multiAwaitDrain:Z(Rh),readingMore:Z(yS),dataEmitted:Z(bS)});function Pi(t,e,r){typeof r!="boolean"&&(r=e instanceof Me()),this.state=Jl|Zl|Th|zi,t&&t.objectMode&&(this.state|=Gt),r&&t&&t.readableObjectMode&&(this.state|=Gt),this.highWaterMark=t?Q_(this,t,"readableHighWaterMark",r):eS(!1),this.buffer=new Z_,this.length=0,this.pipes=[],this.flowing=null,this[Tt]=null,t&&t.emitClose===!1&&(this.state&=~Jl),t&&t.autoDestroy===!1&&(this.state&=~Zl),this.errored=null,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,t&&t.encoding&&(this.decoder=new xh(t.encoding),this.encoding=t.encoding)}o(Pi,"ReadableState");function N(t){if(!(this instanceof N))return new N(t);let e=this instanceof Me();this._readableState=new Pi(t,this,e),t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.construct=="function"&&(this._construct=t.construct),t.signal&&!e&&J_(t.signal,this)),pt.call(this,t),Ht.construct(this,()=>{this._readableState.needReadable&&ki(this,this._readableState)})}o(N,"Readable");N.prototype.destroy=Ht.destroy;N.prototype._undestroy=Ht.undestroy;N.prototype._destroy=function(t,e){e(t)};N.prototype[K_.captureRejectionSymbol]=function(t){this.destroy(t)};N.prototype[G_]=function(){let t;return this.destroyed||(t=this.readableEnded?null:new oS,this.destroy(t)),new Sh((e,r)=>Eh(this,n=>n&&n!==t?r(n):e(null)))};N.prototype.push=function(t,e){return Ah(this,t,e,!1)};N.prototype.unshift=function(t,e){return Ah(this,t,e,!0)};function Ah(t,e,r,n){L("readableAddChunk",e);let i=t._readableState,s;if(i.state&Gt||(typeof e=="string"?(r=r||i.defaultEncoding,i.encoding!==r&&(n&&i.encoding?e=Gl.from(e,r).toString(i.encoding):(e=Gl.from(e,r),r=""))):e instanceof Gl?r="":pt._isUint8Array(e)?(e=pt._uint8ArrayToBuffer(e),r=""):e!=null&&(s=new tS("chunk",["string","Buffer","Uint8Array"],e))),s)Ft(t,s);else if(e===null)i.state&=~Dr,_S(t,i);else if(i.state&Gt||e&&e.length>0)if(n)if(i.state&vh)Ft(t,new sS);else{if(i.destroyed||i.errored)return!1;Yl(t,i,e,!0)}else if(i.ended)Ft(t,new iS);else{if(i.destroyed||i.errored)return!1;i.state&=~Dr,i.decoder&&!r?(e=i.decoder.write(e),i.objectMode||e.length!==0?Yl(t,i,e,!1):ki(t,i)):Yl(t,i,e,!1)}else n||(i.state&=~Dr,ki(t,i));return!i.ended&&(i.length<i.highWaterMark||i.length===0)}o(Ah,"readableAddChunk");function Yl(t,e,r,n){e.flowing&&e.length===0&&!e.sync&&t.listenerCount("data")>0?(e.state&Rh?e.awaitDrainWriters.clear():e.awaitDrainWriters=null,e.dataEmitted=!0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.state&Ni&&Di(t)),ki(t,e)}o(Yl,"addChunk");N.prototype.isPaused=function(){let t=this._readableState;return t[Tt]===!0||t.flowing===!1};N.prototype.setEncoding=function(t){let e=new xh(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;let r=this._readableState.buffer,n="";for(let i of r)n+=e.write(i);return r.clear(),n!==""&&r.push(n),this._readableState.length=n.length,this};var wS=1073741824;function mS(t){if(t>wS)throw new nS("size","<= 1GiB",t);return t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++,t}o(mS,"computeNewHighWaterMark");function mh(t,e){return t<=0||e.length===0&&e.ended?0:e.state&Gt?1:V_(t)?e.flowing&&e.length?e.buffer.first().length:e.length:t<=e.length?t:e.ended?e.length:0}o(mh,"howMuchToRead");N.prototype.read=function(t){L("read",t),t===void 0?t=NaN:j_(t)||(t=$_(t,10));let e=this._readableState,r=t;if(t>e.highWaterMark&&(e.highWaterMark=mS(t)),t!==0&&(e.state&=~Ih),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return L("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Kl(this):Di(this),null;if(t=mh(t,e),t===0&&e.ended)return e.length===0&&Kl(this),null;let n=(e.state&Ni)!==0;if(L("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,L("length less than watermark",n)),e.ended||e.reading||e.destroyed||e.errored||!e.constructed)n=!1,L("reading, ended or constructing",n);else if(n){L("do read"),e.state|=Dr|zi,e.length===0&&(e.state|=Ni);try{this._read(e.highWaterMark)}catch(s){Ft(this,s)}e.state&=~zi,e.reading||(t=mh(r,e))}let i;return t>0?i=Ph(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.multiAwaitDrain?e.awaitDrainWriters.clear():e.awaitDrainWriters=null),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&Kl(this)),i!==null&&!e.errorEmitted&&!e.closeEmitted&&(e.dataEmitted=!0,this.emit("data",i)),i};function _S(t,e){if(L("onEofChunk"),!e.ended){if(e.decoder){let r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?Di(t):(e.needReadable=!1,e.emittedReadable=!0,Oh(t))}}o(_S,"onEofChunk");function Di(t){let e=t._readableState;L("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(L("emitReadable",e.flowing),e.emittedReadable=!0,ze.nextTick(Oh,t))}o(Di,"emitReadable");function Oh(t){let e=t._readableState;L("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&!e.errored&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,Nh(t)}o(Oh,"emitReadable_");function ki(t,e){!e.readingMore&&e.constructed&&(e.readingMore=!0,ze.nextTick(SS,t,e))}o(ki,"maybeReadMore");function SS(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){let r=e.length;if(L("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}o(SS,"maybeReadMore_");N.prototype._read=function(t){throw new rS("_read()")};N.prototype.pipe=function(t,e){let r=this,n=this._readableState;n.pipes.length===1&&(n.multiAwaitDrain||(n.multiAwaitDrain=!0,n.awaitDrainWriters=new F_(n.awaitDrainWriters?[n.awaitDrainWriters]:[]))),n.pipes.push(t),L("pipe count=%d opts=%j",n.pipes.length,e);let s=(!e||e.end!==!1)&&t!==ze.stdout&&t!==ze.stderr?l:I;n.endEmitted?ze.nextTick(s):r.once("end",s),t.on("unpipe",a);function a(T,R){L("onunpipe"),T===r&&R&&R.hasUnpiped===!1&&(R.hasUnpiped=!0,f())}o(a,"onunpipe");function l(){L("onend"),t.end()}o(l,"onend");let c,u=!1;function f(){L("cleanup"),t.removeListener("close",_),t.removeListener("finish",g),c&&t.removeListener("drain",c),t.removeListener("error",y),t.removeListener("unpipe",a),r.removeListener("end",l),r.removeListener("end",I),r.removeListener("data",p),u=!0,c&&n.awaitDrainWriters&&(!t._writableState||t._writableState.needDrain)&&c()}o(f,"cleanup");function d(){u||(n.pipes.length===1&&n.pipes[0]===t?(L("false write response, pause",0),n.awaitDrainWriters=t,n.multiAwaitDrain=!1):n.pipes.length>1&&n.pipes.includes(t)&&(L("false write response, pause",n.awaitDrainWriters.size),n.awaitDrainWriters.add(t)),r.pause()),c||(c=ES(r,t),t.on("drain",c))}o(d,"pause"),r.on("data",p);function p(T){L("ondata");let R=t.write(T);L("dest.write",R),R===!1&&d()}o(p,"ondata");function y(T){if(L("onerror",T),I(),t.removeListener("error",y),t.listenerCount("error")===0){let R=t._writableState||t._readableState;R&&!R.errorEmitted?Ft(t,T):t.emit("error",T)}}o(y,"onerror"),X_(t,"error",y);function _(){t.removeListener("finish",g),I()}o(_,"onclose"),t.once("close",_);function g(){L("onfinish"),t.removeListener("close",_),I()}o(g,"onfinish"),t.once("finish",g);function I(){L("unpipe"),r.unpipe(t)}return o(I,"unpipe"),t.emit("pipe",r),t.writableNeedDrain===!0?d():n.flowing||(L("pipe resume"),r.resume()),t};function ES(t,e){return o(function(){let n=t._readableState;n.awaitDrainWriters===e?(L("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(L("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(e)),(!n.awaitDrainWriters||n.awaitDrainWriters.size===0)&&t.listenerCount("data")&&t.resume()},"pipeOnDrainFunctionResult")}o(ES,"pipeOnDrain");N.prototype.unpipe=function(t){let e=this._readableState,r={hasUnpiped:!1};if(e.pipes.length===0)return this;if(!t){let i=e.pipes;e.pipes=[],this.pause();for(let s=0;s<i.length;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}let n=U_(e.pipes,t);return n===-1?this:(e.pipes.splice(n,1),e.pipes.length===0&&this.pause(),t.emit("unpipe",this,r),this)};N.prototype.on=function(t,e){let r=pt.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,L("on readable",n.length,n.reading),n.length?Di(this):n.reading||ze.nextTick(xS,this)),r};N.prototype.addListener=N.prototype.on;N.prototype.removeListener=function(t,e){let r=pt.prototype.removeListener.call(this,t,e);return t==="readable"&&ze.nextTick(zh,this),r};N.prototype.off=N.prototype.removeListener;N.prototype.removeAllListeners=function(t){let e=pt.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&ze.nextTick(zh,this),e};function zh(t){let e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&e[Tt]===!1?e.flowing=!0:t.listenerCount("data")>0?t.resume():e.readableListening||(e.flowing=null)}o(zh,"updateReadableListening");function xS(t){L("readable nexttick read 0"),t.read(0)}o(xS,"nReadingNextTick");N.prototype.resume=function(){let t=this._readableState;return t.flowing||(L("resume"),t.flowing=!t.readableListening,vS(this,t)),t[Tt]=!1,this};function vS(t,e){e.resumeScheduled||(e.resumeScheduled=!0,ze.nextTick(TS,t,e))}o(vS,"resume");function TS(t,e){L("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),Nh(t),e.flowing&&!e.reading&&t.read(0)}o(TS,"resume_");N.prototype.pause=function(){return L("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(L("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[Tt]=!0,this};function Nh(t){let e=t._readableState;for(L("flow",e.flowing);e.flowing&&t.read()!==null;);}o(Nh,"flow");N.prototype.wrap=function(t){let e=!1;t.on("data",n=>{!this.push(n)&&t.pause&&(e=!0,t.pause())}),t.on("end",()=>{this.push(null)}),t.on("error",n=>{Ft(this,n)}),t.on("close",()=>{this.destroy()}),t.on("destroy",()=>{this.destroy()}),this._read=()=>{e&&t.resume&&(e=!1,t.resume())};let r=W_(t);for(let n=1;n<r.length;n++){let i=r[n];this[i]===void 0&&typeof t[i]=="function"&&(this[i]=t[i].bind(t))}return this};N.prototype[H_]=function(){return kh(this)};N.prototype.iterator=function(t){return t!==void 0&&aS(t,"options"),kh(this,t)};function kh(t,e){typeof t.read!="function"&&(t=N.wrap(t,{objectMode:!0}));let r=IS(t,e);return r.stream=t,r}o(kh,"streamToAsyncIterator");async function*IS(t,e){let r=Hl;function n(a){this===t?(r(),r=Hl):r=a}o(n,"next"),t.on("readable",n);let i,s=Eh(t,{writable:!1},a=>{i=a?wh(i,a):null,r(),r=Hl});try{for(;;){let a=t.destroyed?null:t.read();if(a!==null)yield a;else{if(i)throw i;if(i===null)return;await new Sh(n)}}}catch(a){throw i=wh(i,a),i}finally{(i||(e==null?void 0:e.destroyOnReturn)!==!1)&&(i===void 0||t._readableState.autoDestroy)?Ht.destroyer(t,null):(t.off("readable",n),s())}}o(IS,"createAsyncIterator");Ql(N.prototype,{readable:{__proto__:null,get(){let t=this._readableState;return!!t&&t.readable!==!1&&!t.destroyed&&!t.errorEmitted&&!t.endEmitted},set(t){this._readableState&&(this._readableState.readable=!!t)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(t){this._readableState&&(this._readableState.destroyed=t)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}});Ql(Pi.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[Tt]!==!1},set(t){this[Tt]=!!t}}});N._fromList=Ph;function Ph(t,e){if(e.length===0)return null;let r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}o(Ph,"fromList");function Kl(t){let e=t._readableState;L("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,ze.nextTick(RS,e,t))}o(Kl,"endReadable");function RS(t,e){if(L("endReadableNT",t.endEmitted,t.length),!t.errored&&!t.closeEmitted&&!t.endEmitted&&t.length===0){if(t.endEmitted=!0,e.emit("end"),e.writable&&e.allowHalfOpen===!1)ze.nextTick(AS,e);else if(t.autoDestroy){let r=e._writableState;(!r||r.autoDestroy&&(r.finished||r.writable===!1))&&e.destroy()}}}o(RS,"endReadableNT");function AS(t){t.writable&&!t.writableEnded&&!t.destroyed&&t.end()}o(AS,"endWritableNT");N.from=function(t,e){return lS(N,t,e)};var Xl;function Dh(){return Xl===void 0&&(Xl={}),Xl}o(Dh,"lazyWebStreams");N.fromWeb=function(t,e){return Dh().newStreamReadableFromReadableStream(t,e)};N.toWeb=function(t,e){return Dh().newReadableStreamFromStreamReadable(t,e)};N.wrap=function(t,e){var r,n;return new N({objectMode:(r=(n=t.readableObjectMode)!==null&&n!==void 0?n:t.objectMode)!==null&&r!==void 0?r:!0,...e,destroy(i,s){Ht.destroyer(t,i),s(i)}}).wrap(t)}});var Mi=m((mI,Hh)=>{var It=dt(),{ArrayPrototypeSlice:Bh,Error:OS,FunctionPrototypeSymbolHasInstance:Mh,ObjectDefineProperty:Uh,ObjectDefineProperties:zS,ObjectSetPrototypeOf:jh,StringPrototypeToLowerCase:NS,Symbol:kS,SymbolHasInstance:PS}=$();Hh.exports=W;W.WritableState=Br;var{EventEmitter:DS}=require("events"),Lr=Ri().Stream,{Buffer:Ci}=require("buffer"),Bi=vt(),{addAbortSignal:CS}=Nr(),{getHighWaterMark:LS,getDefaultHighWaterMark:qS}=Pr(),{ERR_INVALID_ARG_TYPE:BS,ERR_METHOD_NOT_IMPLEMENTED:MS,ERR_MULTIPLE_CALLBACK:Vh,ERR_STREAM_CANNOT_PIPE:US,ERR_STREAM_DESTROYED:qr,ERR_STREAM_ALREADY_FINISHED:jS,ERR_STREAM_NULL_VALUES:VS,ERR_STREAM_WRITE_AFTER_END:$S,ERR_UNKNOWN_ENCODING:$h}=pe().codes,{errorOrDestroy:Yt}=Bi;jh(W.prototype,Lr.prototype);jh(W,Lr);function rc(){}o(rc,"nop");var Kt=kS("kOnFinished");function Br(t,e,r){typeof r!="boolean"&&(r=e instanceof Me()),this.objectMode=!!(t&&t.objectMode),r&&(this.objectMode=this.objectMode||!!(t&&t.writableObjectMode)),this.highWaterMark=t?LS(this,t,"writableHighWaterMark",r):qS(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let n=!!(t&&t.decodeStrings===!1);this.decodeStrings=!n,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=FS.bind(void 0,e),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,qi(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!t||t.emitClose!==!1,this.autoDestroy=!t||t.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[Kt]=[]}o(Br,"WritableState");function qi(t){t.buffered=[],t.bufferedIndex=0,t.allBuffers=!0,t.allNoop=!0}o(qi,"resetBuffer");Br.prototype.getBuffer=o(function(){return Bh(this.buffered,this.bufferedIndex)},"getBuffer");Uh(Br.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function W(t){let e=this instanceof Me();if(!e&&!Mh(W,this))return new W(t);this._writableState=new Br(t,this,e),t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final),typeof t.construct=="function"&&(this._construct=t.construct),t.signal&&CS(t.signal,this)),Lr.call(this,t),Bi.construct(this,()=>{let r=this._writableState;r.writing||ic(this,r),sc(this,r)})}o(W,"Writable");Uh(W,PS,{__proto__:null,value:function(t){return Mh(this,t)?!0:this!==W?!1:t&&t._writableState instanceof Br}});W.prototype.pipe=function(){Yt(this,new US)};function Wh(t,e,r,n){let i=t._writableState;if(typeof r=="function")n=r,r=i.defaultEncoding;else{if(!r)r=i.defaultEncoding;else if(r!=="buffer"&&!Ci.isEncoding(r))throw new $h(r);typeof n!="function"&&(n=rc)}if(e===null)throw new VS;if(!i.objectMode)if(typeof e=="string")i.decodeStrings!==!1&&(e=Ci.from(e,r),r="buffer");else if(e instanceof Ci)r="buffer";else if(Lr._isUint8Array(e))e=Lr._uint8ArrayToBuffer(e),r="buffer";else throw new BS("chunk",["string","Buffer","Uint8Array"],e);let s;return i.ending?s=new $S:i.destroyed&&(s=new qr("write")),s?(It.nextTick(n,s),Yt(t,s,!0),s):(i.pendingcb++,WS(t,i,e,r,n))}o(Wh,"_write");W.prototype.write=function(t,e,r){return Wh(this,t,e,r)===!0};W.prototype.cork=function(){this._writableState.corked++};W.prototype.uncork=function(){let t=this._writableState;t.corked&&(t.corked--,t.writing||ic(this,t))};W.prototype.setDefaultEncoding=o(function(e){if(typeof e=="string"&&(e=NS(e)),!Ci.isEncoding(e))throw new $h(e);return this._writableState.defaultEncoding=e,this},"setDefaultEncoding");function WS(t,e,r,n,i){let s=e.objectMode?1:r.length;e.length+=s;let a=e.length<e.highWaterMark;return a||(e.needDrain=!0),e.writing||e.corked||e.errored||!e.constructed?(e.buffered.push({chunk:r,encoding:n,callback:i}),e.allBuffers&&n!=="buffer"&&(e.allBuffers=!1),e.allNoop&&i!==rc&&(e.allNoop=!1)):(e.writelen=s,e.writecb=i,e.writing=!0,e.sync=!0,t._write(r,n,e.onwrite),e.sync=!1),a&&!e.errored&&!e.destroyed}o(WS,"writeOrBuffer");function Lh(t,e,r,n,i,s,a){e.writelen=n,e.writecb=a,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new qr("write")):r?t._writev(i,e.onwrite):t._write(i,s,e.onwrite),e.sync=!1}o(Lh,"doWrite");function qh(t,e,r,n){--e.pendingcb,n(r),nc(e),Yt(t,r)}o(qh,"onwriteError");function FS(t,e){let r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function"){Yt(t,new Vh);return}r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,e?(e.stack,r.errored||(r.errored=e),t._readableState&&!t._readableState.errored&&(t._readableState.errored=e),n?It.nextTick(qh,t,r,e,i):qh(t,r,e,i)):(r.buffered.length>r.bufferedIndex&&ic(t,r),n?r.afterWriteTickInfo!==null&&r.afterWriteTickInfo.cb===i?r.afterWriteTickInfo.count++:(r.afterWriteTickInfo={count:1,cb:i,stream:t,state:r},It.nextTick(GS,r.afterWriteTickInfo)):Fh(t,r,1,i))}o(FS,"onwrite");function GS({stream:t,state:e,count:r,cb:n}){return e.afterWriteTickInfo=null,Fh(t,e,r,n)}o(GS,"afterWriteTick");function Fh(t,e,r,n){for(!e.ending&&!t.destroyed&&e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"));r-- >0;)e.pendingcb--,n();e.destroyed&&nc(e),sc(t,e)}o(Fh,"afterWrite");function nc(t){if(t.writing)return;for(let i=t.bufferedIndex;i<t.buffered.length;++i){var e;let{chunk:s,callback:a}=t.buffered[i],l=t.objectMode?1:s.length;t.length-=l,a((e=t.errored)!==null&&e!==void 0?e:new qr("write"))}let r=t[Kt].splice(0);for(let i=0;i<r.length;i++){var n;r[i]((n=t.errored)!==null&&n!==void 0?n:new qr("end"))}qi(t)}o(nc,"errorBuffer");function ic(t,e){if(e.corked||e.bufferProcessing||e.destroyed||!e.constructed)return;let{buffered:r,bufferedIndex:n,objectMode:i}=e,s=r.length-n;if(!s)return;let a=n;if(e.bufferProcessing=!0,s>1&&t._writev){e.pendingcb-=s-1;let l=e.allNoop?rc:u=>{for(let f=a;f<r.length;++f)r[f].callback(u)},c=e.allNoop&&a===0?r:Bh(r,a);c.allBuffers=e.allBuffers,Lh(t,e,!0,e.length,c,"",l),qi(e)}else{do{let{chunk:l,encoding:c,callback:u}=r[a];r[a++]=null;let f=i?1:l.length;Lh(t,e,!1,f,l,c,u)}while(a<r.length&&!e.writing);a===r.length?qi(e):a>256?(r.splice(0,a),e.bufferedIndex=0):e.bufferedIndex=a}e.bufferProcessing=!1}o(ic,"clearBuffer");W.prototype._write=function(t,e,r){if(this._writev)this._writev([{chunk:t,encoding:e}],r);else throw new MS("_write()")};W.prototype._writev=null;W.prototype.end=function(t,e,r){let n=this._writableState;typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null);let i;if(t!=null){let s=Wh(this,t,e);s instanceof OS&&(i=s)}return n.corked&&(n.corked=1,this.uncork()),i||(!n.errored&&!n.ending?(n.ending=!0,sc(this,n,!0),n.ended=!0):n.finished?i=new jS("end"):n.destroyed&&(i=new qr("end"))),typeof r=="function"&&(i||n.finished?It.nextTick(r,i):n[Kt].push(r)),this};function Li(t){return t.ending&&!t.destroyed&&t.constructed&&t.length===0&&!t.errored&&t.buffered.length===0&&!t.finished&&!t.writing&&!t.errorEmitted&&!t.closeEmitted}o(Li,"needFinish");function HS(t,e){let r=!1;function n(i){if(r){Yt(t,i??Vh());return}if(r=!0,e.pendingcb--,i){let s=e[Kt].splice(0);for(let a=0;a<s.length;a++)s[a](i);Yt(t,i,e.sync)}else Li(e)&&(e.prefinished=!0,t.emit("prefinish"),e.pendingcb++,It.nextTick(tc,t,e))}o(n,"onFinish"),e.sync=!0,e.pendingcb++;try{t._final(n)}catch(i){n(i)}e.sync=!1}o(HS,"callFinal");function YS(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.finalCalled=!0,HS(t,e)):(e.prefinished=!0,t.emit("prefinish")))}o(YS,"prefinish");function sc(t,e,r){Li(e)&&(YS(t,e),e.pendingcb===0&&(r?(e.pendingcb++,It.nextTick((n,i)=>{Li(i)?tc(n,i):i.pendingcb--},t,e)):Li(e)&&(e.pendingcb++,tc(t,e))))}o(sc,"finishMaybe");function tc(t,e){e.pendingcb--,e.finished=!0;let r=e[Kt].splice(0);for(let n=0;n<r.length;n++)r[n]();if(t.emit("finish"),e.autoDestroy){let n=t._readableState;(!n||n.autoDestroy&&(n.endEmitted||n.readable===!1))&&t.destroy()}}o(tc,"finish");zS(W.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(t){this._writableState&&(this._writableState.destroyed=t)}},writable:{__proto__:null,get(){let t=this._writableState;return!!t&&t.writable!==!1&&!t.destroyed&&!t.errored&&!t.ending&&!t.ended},set(t){this._writableState&&(this._writableState.writable=!!t)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let t=this._writableState;return t?!t.destroyed&&!t.ending&&t.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var KS=Bi.destroy;W.prototype.destroy=function(t,e){let r=this._writableState;return!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[Kt].length)&&It.nextTick(nc,r),KS.call(this,t,e),this};W.prototype._undestroy=Bi.undestroy;W.prototype._destroy=function(t,e){e(t)};W.prototype[DS.captureRejectionSymbol]=function(t){this.destroy(t)};var ec;function Gh(){return ec===void 0&&(ec={}),ec}o(Gh,"lazyWebStreams");W.fromWeb=function(t,e){return Gh().newStreamWritableFromWritableStream(t,e)};W.toWeb=function(t){return Gh().newWritableStreamFromStreamWritable(t)}});var lp=m((SI,ap)=>{var oc=dt(),XS=require("buffer"),{isReadable:JS,isWritable:ZS,isIterable:Yh,isNodeStream:QS,isReadableNodeStream:Kh,isWritableNodeStream:Xh,isDuplexNodeStream:eE,isReadableStream:Jh,isWritableStream:Zh}=qe(),Qh=Ze(),{AbortError:sp,codes:{ERR_INVALID_ARG_TYPE:tE,ERR_INVALID_RETURN_VALUE:ep}}=pe(),{destroyer:Jt}=vt(),rE=Me(),op=Cr(),nE=Mi(),{createDeferredPromise:tp}=ce(),rp=Fl(),np=globalThis.Blob||XS.Blob,iE=o(typeof np<"u"?function(e){return e instanceof np}:function(e){return!1},"isBlob"),sE=globalThis.AbortController||jt().AbortController,{FunctionPrototypeCall:ip}=$(),ac=class ac extends rE{constructor(e){super(e),(e==null?void 0:e.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(e==null?void 0:e.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};o(ac,"Duplexify");var gt=ac;ap.exports=o(function t(e,r){if(eE(e))return e;if(Kh(e))return Xt({readable:e});if(Xh(e))return Xt({writable:e});if(QS(e))return Xt({writable:!1,readable:!1});if(Jh(e))return Xt({readable:op.fromWeb(e)});if(Zh(e))return Xt({writable:nE.fromWeb(e)});if(typeof e=="function"){let{value:i,write:s,final:a,destroy:l}=oE(e);if(Yh(i))return rp(gt,i,{objectMode:!0,write:s,final:a,destroy:l});let c=i==null?void 0:i.then;if(typeof c=="function"){let u,f=ip(c,i,d=>{if(d!=null)throw new ep("nully","body",d)},d=>{Jt(u,d)});return u=new gt({objectMode:!0,readable:!1,write:s,final(d){a(async()=>{try{await f,oc.nextTick(d,null)}catch(p){oc.nextTick(d,p)}})},destroy:l})}throw new ep("Iterable, AsyncIterable or AsyncFunction",r,i)}if(iE(e))return t(e.arrayBuffer());if(Yh(e))return rp(gt,e,{objectMode:!0,writable:!1});if(Jh(e==null?void 0:e.readable)&&Zh(e==null?void 0:e.writable))return gt.fromWeb(e);if(typeof(e==null?void 0:e.writable)=="object"||typeof(e==null?void 0:e.readable)=="object"){let i=e!=null&&e.readable?Kh(e==null?void 0:e.readable)?e==null?void 0:e.readable:t(e.readable):void 0,s=e!=null&&e.writable?Xh(e==null?void 0:e.writable)?e==null?void 0:e.writable:t(e.writable):void 0;return Xt({readable:i,writable:s})}let n=e==null?void 0:e.then;if(typeof n=="function"){let i;return ip(n,e,s=>{s!=null&&i.push(s),i.push(null)},s=>{Jt(i,s)}),i=new gt({objectMode:!0,writable:!1,read(){}})}throw new tE(r,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],e)},"duplexify");function oE(t){let{promise:e,resolve:r}=tp(),n=new sE,i=n.signal;return{value:t(async function*(){for(;;){let a=e;e=null;let{chunk:l,done:c,cb:u}=await a;if(oc.nextTick(u),c)return;if(i.aborted)throw new sp(void 0,{cause:i.reason});({promise:e,resolve:r}=tp()),yield l}}(),{signal:i}),write(a,l,c){let u=r;r=null,u({chunk:a,done:!1,cb:c})},final(a){let l=r;r=null,l({done:!0,cb:a})},destroy(a,l){n.abort(),l(a)}}}o(oE,"fromAsyncGen");function Xt(t){let e=t.readable&&typeof t.readable.read!="function"?op.wrap(t.readable):t.readable,r=t.writable,n=!!JS(e),i=!!ZS(r),s,a,l,c,u;function f(d){let p=c;c=null,p?p(d):d&&u.destroy(d)}return o(f,"onfinished"),u=new gt({readableObjectMode:!!(e!=null&&e.readableObjectMode),writableObjectMode:!!(r!=null&&r.writableObjectMode),readable:n,writable:i}),i&&(Qh(r,d=>{i=!1,d&&Jt(e,d),f(d)}),u._write=function(d,p,y){r.write(d,p)?y():s=y},u._final=function(d){r.end(),a=d},r.on("drain",function(){if(s){let d=s;s=null,d()}}),r.on("finish",function(){if(a){let d=a;a=null,d()}})),n&&(Qh(e,d=>{n=!1,d&&Jt(e,d),f(d)}),e.on("readable",function(){if(l){let d=l;l=null,d()}}),e.on("end",function(){u.push(null)}),u._read=function(){for(;;){let d=e.read();if(d===null){l=u._read;return}if(!u.push(d))return}}),u._destroy=function(d,p){!d&&c!==null&&(d=new sp),l=null,s=null,a=null,c===null?p(d):(c=p,Jt(r,d),Jt(e,d))},u}o(Xt,"_duplexify")});var Me=m((xI,fp)=>{"use strict";var{ObjectDefineProperties:aE,ObjectGetOwnPropertyDescriptor:Qe,ObjectKeys:lE,ObjectSetPrototypeOf:cp}=$();fp.exports=Ne;var uc=Cr(),ve=Mi();cp(Ne.prototype,uc.prototype);cp(Ne,uc);{let t=lE(ve.prototype);for(let e=0;e<t.length;e++){let r=t[e];Ne.prototype[r]||(Ne.prototype[r]=ve.prototype[r])}}function Ne(t){if(!(this instanceof Ne))return new Ne(t);uc.call(this,t),ve.call(this,t),t?(this.allowHalfOpen=t.allowHalfOpen!==!1,t.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),t.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}o(Ne,"Duplex");aE(Ne.prototype,{writable:{__proto__:null,...Qe(ve.prototype,"writable")},writableHighWaterMark:{__proto__:null,...Qe(ve.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...Qe(ve.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...Qe(ve.prototype,"writableBuffer")},writableLength:{__proto__:null,...Qe(ve.prototype,"writableLength")},writableFinished:{__proto__:null,...Qe(ve.prototype,"writableFinished")},writableCorked:{__proto__:null,...Qe(ve.prototype,"writableCorked")},writableEnded:{__proto__:null,...Qe(ve.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...Qe(ve.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(t){this._readableState&&this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}});var lc;function up(){return lc===void 0&&(lc={}),lc}o(up,"lazyWebStreams");Ne.fromWeb=function(t,e){return up().newStreamDuplexFromReadableWritablePair(t,e)};Ne.toWeb=function(t){return up().newReadableWritablePairFromDuplex(t)};var cc;Ne.from=function(t){return cc||(cc=lp()),cc(t,"body")}});var hc=m((TI,hp)=>{"use strict";var{ObjectSetPrototypeOf:dp,Symbol:cE}=$();hp.exports=et;var{ERR_METHOD_NOT_IMPLEMENTED:uE}=pe().codes,dc=Me(),{getHighWaterMark:fE}=Pr();dp(et.prototype,dc.prototype);dp(et,dc);var Mr=cE("kCallback");function et(t){if(!(this instanceof et))return new et(t);let e=t?fE(this,t,"readableHighWaterMark",!0):null;e===0&&(t={...t,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:t.writableHighWaterMark||0}),dc.call(this,t),this._readableState.sync=!1,this[Mr]=null,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",dE)}o(et,"Transform");function fc(t){typeof this._flush=="function"&&!this.destroyed?this._flush((e,r)=>{if(e){t?t(e):this.destroy(e);return}r!=null&&this.push(r),this.push(null),t&&t()}):(this.push(null),t&&t())}o(fc,"final");function dE(){this._final!==fc&&fc.call(this)}o(dE,"prefinish");et.prototype._final=fc;et.prototype._transform=function(t,e,r){throw new uE("_transform()")};et.prototype._write=function(t,e,r){let n=this._readableState,i=this._writableState,s=n.length;this._transform(t,e,(a,l)=>{if(a){r(a);return}l!=null&&this.push(l),i.ended||s===n.length||n.length<n.highWaterMark?r():this[Mr]=r})};et.prototype._read=function(){if(this[Mr]){let t=this[Mr];this[Mr]=null,t()}}});var gc=m((RI,gp)=>{"use strict";var{ObjectSetPrototypeOf:pp}=$();gp.exports=Zt;var pc=hc();pp(Zt.prototype,pc.prototype);pp(Zt,pc);function Zt(t){if(!(this instanceof Zt))return new Zt(t);pc.call(this,t)}o(Zt,"PassThrough");Zt.prototype._transform=function(t,e,r){r(null,t)}});var $i=m((OI,_p)=>{var Ur=dt(),{ArrayIsArray:hE,Promise:pE,SymbolAsyncIterator:gE,SymbolDispose:yE}=$(),Vi=Ze(),{once:bE}=ce(),wE=vt(),yp=Me(),{aggregateTwoErrors:mE,codes:{ERR_INVALID_ARG_TYPE:vc,ERR_INVALID_RETURN_VALUE:yc,ERR_MISSING_ARGS:_E,ERR_STREAM_DESTROYED:SE,ERR_STREAM_PREMATURE_CLOSE:EE},AbortError:xE}=pe(),{validateFunction:vE,validateAbortSignal:TE}=$t(),{isIterable:Rt,isReadable:bc,isReadableNodeStream:ji,isNodeStream:bp,isTransformStream:Qt,isWebStream:IE,isReadableStream:wc,isReadableFinished:RE}=qe(),AE=globalThis.AbortController||jt().AbortController,mc,_c,Sc;function wp(t,e,r){let n=!1;t.on("close",()=>{n=!0});let i=Vi(t,{readable:e,writable:r},s=>{n=!s});return{destroy:s=>{n||(n=!0,wE.destroyer(t,s||new SE("pipe")))},cleanup:i}}o(wp,"destroyer");function OE(t){return vE(t[t.length-1],"streams[stream.length - 1]"),t.pop()}o(OE,"popCallback");function Ec(t){if(Rt(t))return t;if(ji(t))return zE(t);throw new vc("val",["Readable","Iterable","AsyncIterable"],t)}o(Ec,"makeAsyncIterable");async function*zE(t){_c||(_c=Cr()),yield*_c.prototype[gE].call(t)}o(zE,"fromReadable");async function Ui(t,e,r,{end:n}){let i,s=null,a=o(u=>{if(u&&(i=u),s){let f=s;s=null,f()}},"resume"),l=o(()=>new pE((u,f)=>{i?f(i):s=o(()=>{i?f(i):u()},"onresolve")}),"wait");e.on("drain",a);let c=Vi(e,{readable:!1},a);try{e.writableNeedDrain&&await l();for await(let u of t)e.write(u)||await l();n&&(e.end(),await l()),r()}catch(u){r(i!==u?mE(i,u):u)}finally{c(),e.off("drain",a)}}o(Ui,"pumpToNode");async function xc(t,e,r,{end:n}){Qt(e)&&(e=e.writable);let i=e.getWriter();try{for await(let s of t)await i.ready,i.write(s).catch(()=>{});await i.ready,n&&await i.close(),r()}catch(s){try{await i.abort(s),r(s)}catch(a){r(a)}}}o(xc,"pumpToWeb");function NE(...t){return mp(t,bE(OE(t)))}o(NE,"pipeline");function mp(t,e,r){if(t.length===1&&hE(t[0])&&(t=t[0]),t.length<2)throw new _E("streams");let n=new AE,i=n.signal,s=r==null?void 0:r.signal,a=[];TE(s,"options.signal");function l(){_(new xE)}o(l,"abort"),Sc=Sc||ce().addAbortListener;let c;s&&(c=Sc(s,l));let u,f,d=[],p=0;function y(D){_(D,--p===0)}o(y,"finish");function _(D,z){var x;if(D&&(!u||u.code==="ERR_STREAM_PREMATURE_CLOSE")&&(u=D),!(!u&&!z)){for(;d.length;)d.shift()(u);(x=c)===null||x===void 0||x[yE](),n.abort(),z&&(u||a.forEach(de=>de()),Ur.nextTick(e,u,f))}}o(_,"finishImpl");let g;for(let D=0;D<t.length;D++){let z=t[D],x=D<t.length-1,de=D>0,te=x||(r==null?void 0:r.end)!==!1,Re=D===t.length-1;if(bp(z)){let Y=function(we){we&&we.name!=="AbortError"&&we.code!=="ERR_STREAM_PREMATURE_CLOSE"&&y(we)};var R=Y;if(o(Y,"onError"),te){let{destroy:we,cleanup:Lt}=wp(z,x,de);d.push(we),bc(z)&&Re&&a.push(Lt)}z.on("error",Y),bc(z)&&Re&&a.push(()=>{z.removeListener("error",Y)})}if(D===0)if(typeof z=="function"){if(g=z({signal:i}),!Rt(g))throw new yc("Iterable, AsyncIterable or Stream","source",g)}else Rt(z)||ji(z)||Qt(z)?g=z:g=yp.from(z);else if(typeof z=="function"){if(Qt(g)){var I;g=Ec((I=g)===null||I===void 0?void 0:I.readable)}else g=Ec(g);if(g=z(g,{signal:i}),x){if(!Rt(g,!0))throw new yc("AsyncIterable",`transform[${D-1}]`,g)}else{var T;mc||(mc=gc());let Y=new mc({objectMode:!0}),we=(T=g)===null||T===void 0?void 0:T.then;if(typeof we=="function")p++,we.call(g,Ee=>{f=Ee,Ee!=null&&Y.write(Ee),te&&Y.end(),Ur.nextTick(y)},Ee=>{Y.destroy(Ee),Ur.nextTick(y,Ee)});else if(Rt(g,!0))p++,Ui(g,Y,y,{end:te});else if(wc(g)||Qt(g)){let Ee=g.readable||g;p++,Ui(Ee,Y,y,{end:te})}else throw new yc("AsyncIterable or Promise","destination",g);g=Y;let{destroy:Lt,cleanup:Ss}=wp(g,!1,!0);d.push(Lt),Re&&a.push(Ss)}}else if(bp(z)){if(ji(g)){p+=2;let Y=kE(g,z,y,{end:te});bc(z)&&Re&&a.push(Y)}else if(Qt(g)||wc(g)){let Y=g.readable||g;p++,Ui(Y,z,y,{end:te})}else if(Rt(g))p++,Ui(g,z,y,{end:te});else throw new vc("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=z}else if(IE(z)){if(ji(g))p++,xc(Ec(g),z,y,{end:te});else if(wc(g)||Rt(g))p++,xc(g,z,y,{end:te});else if(Qt(g))p++,xc(g.readable,z,y,{end:te});else throw new vc("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=z}else g=yp.from(z)}return(i!=null&&i.aborted||s!=null&&s.aborted)&&Ur.nextTick(l),g}o(mp,"pipelineImpl");function kE(t,e,r,{end:n}){let i=!1;if(e.on("close",()=>{i||r(new EE)}),t.pipe(e,{end:!1}),n){let a=function(){i=!0,e.end()};var s=a;o(a,"endFn"),RE(t)?Ur.nextTick(a):t.once("end",a)}else r();return Vi(t,{readable:!0,writable:!1},a=>{let l=t._readableState;a&&a.code==="ERR_STREAM_PREMATURE_CLOSE"&&l&&l.ended&&!l.errored&&!l.errorEmitted?t.once("end",r).once("error",r):r(a)}),Vi(e,{readable:!1,writable:!0},r)}o(kE,"pipe");_p.exports={pipelineImpl:mp,pipeline:NE}});var Ic=m((NI,Ip)=>{"use strict";var{pipeline:PE}=$i(),Wi=Me(),{destroyer:DE}=vt(),{isNodeStream:Fi,isReadable:Sp,isWritable:Ep,isWebStream:Tc,isTransformStream:At,isWritableStream:xp,isReadableStream:vp}=qe(),{AbortError:CE,codes:{ERR_INVALID_ARG_VALUE:Tp,ERR_MISSING_ARGS:LE}}=pe(),qE=Ze();Ip.exports=o(function(...e){if(e.length===0)throw new LE("streams");if(e.length===1)return Wi.from(e[0]);let r=[...e];if(typeof e[0]=="function"&&(e[0]=Wi.from(e[0])),typeof e[e.length-1]=="function"){let y=e.length-1;e[y]=Wi.from(e[y])}for(let y=0;y<e.length;++y)if(!(!Fi(e[y])&&!Tc(e[y]))){if(y<e.length-1&&!(Sp(e[y])||vp(e[y])||At(e[y])))throw new Tp(`streams[${y}]`,r[y],"must be readable");if(y>0&&!(Ep(e[y])||xp(e[y])||At(e[y])))throw new Tp(`streams[${y}]`,r[y],"must be writable")}let n,i,s,a,l;function c(y){let _=a;a=null,_?_(y):y?l.destroy(y):!p&&!d&&l.destroy()}o(c,"onfinished");let u=e[0],f=PE(e,c),d=!!(Ep(u)||xp(u)||At(u)),p=!!(Sp(f)||vp(f)||At(f));if(l=new Wi({writableObjectMode:!!(u!=null&&u.writableObjectMode),readableObjectMode:!!(f!=null&&f.readableObjectMode),writable:d,readable:p}),d){if(Fi(u))l._write=function(_,g,I){u.write(_,g)?I():n=I},l._final=function(_){u.end(),i=_},u.on("drain",function(){if(n){let _=n;n=null,_()}});else if(Tc(u)){let g=(At(u)?u.writable:u).getWriter();l._write=async function(I,T,R){try{await g.ready,g.write(I).catch(()=>{}),R()}catch(D){R(D)}},l._final=async function(I){try{await g.ready,g.close().catch(()=>{}),i=I}catch(T){I(T)}}}let y=At(f)?f.readable:f;qE(y,()=>{if(i){let _=i;i=null,_()}})}if(p){if(Fi(f))f.on("readable",function(){if(s){let y=s;s=null,y()}}),f.on("end",function(){l.push(null)}),l._read=function(){for(;;){let y=f.read();if(y===null){s=l._read;return}if(!l.push(y))return}};else if(Tc(f)){let _=(At(f)?f.readable:f).getReader();l._read=async function(){for(;;)try{let{value:g,done:I}=await _.read();if(!l.push(g))return;if(I){l.push(null);return}}catch{return}}}}return l._destroy=function(y,_){!y&&a!==null&&(y=new CE),s=null,n=null,i=null,a===null?_(y):(a=_,Fi(f)&&DE(f,y))},l},"compose")});var Lp=m((PI,Oc)=>{"use strict";var BE=globalThis.AbortController||jt().AbortController,{codes:{ERR_INVALID_ARG_VALUE:ME,ERR_INVALID_ARG_TYPE:jr,ERR_MISSING_ARGS:UE,ERR_OUT_OF_RANGE:jE},AbortError:Ue}=pe(),{validateAbortSignal:Ot,validateInteger:Rp,validateObject:zt}=$t(),VE=$().Symbol("kWeak"),$E=$().Symbol("kResistStopPropagation"),{finished:WE}=Ze(),FE=Ic(),{addAbortSignalNoValidate:GE}=Nr(),{isWritable:HE,isNodeStream:YE}=qe(),{deprecate:KE}=ce(),{ArrayPrototypePush:XE,Boolean:JE,MathFloor:Ap,Number:ZE,NumberIsNaN:QE,Promise:Op,PromiseReject:zp,PromiseResolve:ex,PromisePrototypeThen:Np,Symbol:Pp}=$(),Gi=Pp("kEmpty"),kp=Pp("kEof");function tx(t,e){if(e!=null&&zt(e,"options"),(e==null?void 0:e.signal)!=null&&Ot(e.signal,"options.signal"),YE(t)&&!HE(t))throw new ME("stream",t,"must be writable");let r=FE(this,t);return e!=null&&e.signal&&GE(e.signal,r),r}o(tx,"compose");function Hi(t,e){if(typeof t!="function")throw new jr("fn",["Function","AsyncFunction"],t);e!=null&&zt(e,"options"),(e==null?void 0:e.signal)!=null&&Ot(e.signal,"options.signal");let r=1;(e==null?void 0:e.concurrency)!=null&&(r=Ap(e.concurrency));let n=r-1;return(e==null?void 0:e.highWaterMark)!=null&&(n=Ap(e.highWaterMark)),Rp(r,"options.concurrency",1),Rp(n,"options.highWaterMark",0),n+=r,o(async function*(){let s=ce().AbortSignalAny([e==null?void 0:e.signal].filter(JE)),a=this,l=[],c={signal:s},u,f,d=!1,p=0;function y(){d=!0,_()}o(y,"onCatch");function _(){p-=1,g()}o(_,"afterItemProcessed");function g(){f&&!d&&p<r&&l.length<n&&(f(),f=null)}o(g,"maybeResume");async function I(){try{for await(let T of a){if(d)return;if(s.aborted)throw new Ue;try{if(T=t(T,c),T===Gi)continue;T=ex(T)}catch(R){T=zp(R)}p+=1,Np(T,_,y),l.push(T),u&&(u(),u=null),!d&&(l.length>=n||p>=r)&&await new Op(R=>{f=R})}l.push(kp)}catch(T){let R=zp(T);Np(R,_,y),l.push(R)}finally{d=!0,u&&(u(),u=null)}}o(I,"pump"),I();try{for(;;){for(;l.length>0;){let T=await l[0];if(T===kp)return;if(s.aborted)throw new Ue;T!==Gi&&(yield T),l.shift(),g()}await new Op(T=>{u=T})}}finally{d=!0,f&&(f(),f=null)}},"map").call(this)}o(Hi,"map");function rx(t=void 0){return t!=null&&zt(t,"options"),(t==null?void 0:t.signal)!=null&&Ot(t.signal,"options.signal"),o(async function*(){let r=0;for await(let i of this){var n;if(t!=null&&(n=t.signal)!==null&&n!==void 0&&n.aborted)throw new Ue({cause:t.signal.reason});yield[r++,i]}},"asIndexedPairs").call(this)}o(rx,"asIndexedPairs");async function Dp(t,e=void 0){for await(let r of Ac.call(this,t,e))return!0;return!1}o(Dp,"some");async function nx(t,e=void 0){if(typeof t!="function")throw new jr("fn",["Function","AsyncFunction"],t);return!await Dp.call(this,async(...r)=>!await t(...r),e)}o(nx,"every");async function ix(t,e){for await(let r of Ac.call(this,t,e))return r}o(ix,"find");async function sx(t,e){if(typeof t!="function")throw new jr("fn",["Function","AsyncFunction"],t);async function r(n,i){return await t(n,i),Gi}o(r,"forEachFn");for await(let n of Hi.call(this,r,e));}o(sx,"forEach");function Ac(t,e){if(typeof t!="function")throw new jr("fn",["Function","AsyncFunction"],t);async function r(n,i){return await t(n,i)?n:Gi}return o(r,"filterFn"),Hi.call(this,r,e)}o(Ac,"filter");var zc=class zc extends UE{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};o(zc,"ReduceAwareErrMissingArgs");var Rc=zc;async function ox(t,e,r){var n;if(typeof t!="function")throw new jr("reducer",["Function","AsyncFunction"],t);r!=null&&zt(r,"options"),(r==null?void 0:r.signal)!=null&&Ot(r.signal,"options.signal");let i=arguments.length>1;if(r!=null&&(n=r.signal)!==null&&n!==void 0&&n.aborted){let u=new Ue(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await WE(this.destroy(u)),u}let s=new BE,a=s.signal;if(r!=null&&r.signal){let u={once:!0,[VE]:this,[$E]:!0};r.signal.addEventListener("abort",()=>s.abort(),u)}let l=!1;try{for await(let u of this){var c;if(l=!0,r!=null&&(c=r.signal)!==null&&c!==void 0&&c.aborted)throw new Ue;i?e=await t(e,u,{signal:a}):(e=u,i=!0)}if(!l&&!i)throw new Rc}finally{s.abort()}return e}o(ox,"reduce");async function ax(t){t!=null&&zt(t,"options"),(t==null?void 0:t.signal)!=null&&Ot(t.signal,"options.signal");let e=[];for await(let n of this){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Ue(void 0,{cause:t.signal.reason});XE(e,n)}return e}o(ax,"toArray");function lx(t,e){let r=Hi.call(this,t,e);return o(async function*(){for await(let i of r)yield*i},"flatMap").call(this)}o(lx,"flatMap");function Cp(t){if(t=ZE(t),QE(t))return 0;if(t<0)throw new jE("number",">= 0",t);return t}o(Cp,"toIntegerOrInfinity");function cx(t,e=void 0){return e!=null&&zt(e,"options"),(e==null?void 0:e.signal)!=null&&Ot(e.signal,"options.signal"),t=Cp(t),o(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Ue;for await(let s of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new Ue;t--<=0&&(yield s)}},"drop").call(this)}o(cx,"drop");function ux(t,e=void 0){return e!=null&&zt(e,"options"),(e==null?void 0:e.signal)!=null&&Ot(e.signal,"options.signal"),t=Cp(t),o(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Ue;for await(let s of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new Ue;if(t-- >0&&(yield s),t<=0)return}},"take").call(this)}o(ux,"take");Oc.exports.streamReturningOperators={asIndexedPairs:KE(rx,"readable.asIndexedPairs will be removed in a future version."),drop:cx,filter:Ac,flatMap:lx,map:Hi,take:ux,compose:tx};Oc.exports.promiseReturningOperators={every:nx,forEach:sx,reduce:ox,toArray:ax,some:Dp,find:ix}});var Nc=m((CI,qp)=>{"use strict";var{ArrayPrototypePop:fx,Promise:dx}=$(),{isIterable:hx,isNodeStream:px,isWebStream:gx}=qe(),{pipelineImpl:yx}=$i(),{finished:bx}=Ze();kc();function wx(...t){return new dx((e,r)=>{let n,i,s=t[t.length-1];if(s&&typeof s=="object"&&!px(s)&&!hx(s)&&!gx(s)){let a=fx(t);n=a.signal,i=a.end}yx(t,(a,l)=>{a?r(a):e(l)},{signal:n,end:i})})}o(wx,"pipeline");qp.exports={finished:bx,pipeline:wx}});var kc=m((qI,Gp)=>{var{Buffer:mx}=require("buffer"),{ObjectDefineProperty:tt,ObjectKeys:Up,ReflectApply:jp}=$(),{promisify:{custom:Vp}}=ce(),{streamReturningOperators:Bp,promiseReturningOperators:Mp}=Lp(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:$p}}=pe(),_x=Ic(),{setDefaultHighWaterMark:Sx,getDefaultHighWaterMark:Ex}=Pr(),{pipeline:Wp}=$i(),{destroyer:xx}=vt(),Fp=Ze(),Pc=Nc(),Vr=qe(),U=Gp.exports=Ri().Stream;U.isDestroyed=Vr.isDestroyed;U.isDisturbed=Vr.isDisturbed;U.isErrored=Vr.isErrored;U.isReadable=Vr.isReadable;U.isWritable=Vr.isWritable;U.Readable=Cr();for(let t of Up(Bp)){let r=function(...n){if(new.target)throw $p();return U.Readable.from(jp(e,this,n))};Dc=r,o(r,"fn");let e=Bp[t];tt(r,"name",{__proto__:null,value:e.name}),tt(r,"length",{__proto__:null,value:e.length}),tt(U.Readable.prototype,t,{__proto__:null,value:r,enumerable:!1,configurable:!0,writable:!0})}var Dc;for(let t of Up(Mp)){let r=function(...i){if(new.target)throw $p();return jp(e,this,i)};Dc=r,o(r,"fn");let e=Mp[t];tt(r,"name",{__proto__:null,value:e.name}),tt(r,"length",{__proto__:null,value:e.length}),tt(U.Readable.prototype,t,{__proto__:null,value:r,enumerable:!1,configurable:!0,writable:!0})}var Dc;U.Writable=Mi();U.Duplex=Me();U.Transform=hc();U.PassThrough=gc();U.pipeline=Wp;var{addAbortSignal:vx}=Nr();U.addAbortSignal=vx;U.finished=Fp;U.destroy=xx;U.compose=_x;U.setDefaultHighWaterMark=Sx;U.getDefaultHighWaterMark=Ex;tt(U,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return Pc}});tt(Wp,Vp,{__proto__:null,enumerable:!0,get(){return Pc.pipeline}});tt(Fp,Vp,{__proto__:null,enumerable:!0,get(){return Pc.finished}});U.Stream=U;U._isUint8Array=o(function(e){return e instanceof Uint8Array},"isUint8Array");U._uint8ArrayToBuffer=o(function(e){return mx.from(e.buffer,e.byteOffset,e.byteLength)},"_uint8ArrayToBuffer")});var Hp=m((MI,P)=>{"use strict";var Q=require("stream");if(Q&&process.env.READABLE_STREAM==="disable"){let t=Q.promises;P.exports._uint8ArrayToBuffer=Q._uint8ArrayToBuffer,P.exports._isUint8Array=Q._isUint8Array,P.exports.isDisturbed=Q.isDisturbed,P.exports.isErrored=Q.isErrored,P.exports.isReadable=Q.isReadable,P.exports.Readable=Q.Readable,P.exports.Writable=Q.Writable,P.exports.Duplex=Q.Duplex,P.exports.Transform=Q.Transform,P.exports.PassThrough=Q.PassThrough,P.exports.addAbortSignal=Q.addAbortSignal,P.exports.finished=Q.finished,P.exports.destroy=Q.destroy,P.exports.pipeline=Q.pipeline,P.exports.compose=Q.compose,Object.defineProperty(Q,"promises",{configurable:!0,enumerable:!0,get(){return t}}),P.exports.Stream=Q.Stream}else{let t=kc(),e=Nc(),r=t.Readable.destroy;P.exports=t.Readable,P.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,P.exports._isUint8Array=t._isUint8Array,P.exports.isDisturbed=t.isDisturbed,P.exports.isErrored=t.isErrored,P.exports.isReadable=t.isReadable,P.exports.Readable=t.Readable,P.exports.Writable=t.Writable,P.exports.Duplex=t.Duplex,P.exports.Transform=t.Transform,P.exports.PassThrough=t.PassThrough,P.exports.addAbortSignal=t.addAbortSignal,P.exports.finished=t.finished,P.exports.destroy=t.destroy,P.exports.destroy=r,P.exports.pipeline=t.pipeline,P.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return e}}),P.exports.Stream=t.Stream}P.exports.default=P.exports});var Kp=m((UI,Yp)=>{"use strict";var Tx={INT:1,LONG:2,STRING:3,DATE:4,TIMESTAMP:5,CLASS:6,DOUBLE:7,FLOAT:8,LIST:9,MAP:10,SET:11,UUID:12,EDGE:13,PATH:14,PROPERTY:15,GRAPH:16,VERTEX:17,VERTEXPROPERTY:18,BARRIER:19,BINDING:20,BYTECODE:21,CARDINALITY:22,COLUMN:23,DIRECTION:24,OPERATOR:25,ORDER:26,PICK:27,POP:28,LAMBDA:29,P:30,SCOPE:31,T:32,TRAVERSER:33,BIGDECIMAL:34,BIGINTEGER:35,BYTE:36,BYTEBUFFER:37,SHORT:38,BOOLEAN:39,TEXTP:40,TRAVERSALSTRATEGY:41,BULKSET:42,TREE:43,METRICS:44,TRAVERSALMETRICS:45,MERGE:46,DT:47,CHAR:128,DURATION:129,INETADDRESS:130,INSTANT:131,LOCALDATE:132,LOCALDATETIME:133,LOCALTIME:134,MONTHDAY:135,OFFSETDATETIME:136,OFFSETTIME:137,PERIOD:138,YEAR:139,YEARMONTH:140,ZONEDATETIME:141,ZONEOFFSET:142,CUSTOM:0,UNSPECIFIED_NULL:254};Yp.exports=Tx});var Jp=m((jI,Xp)=>{"use strict";var{Buffer:Ix}=require("buffer"),Rx=o(({serializer:t,args:e,cursor:r,err:n})=>{r===void 0&&(r=e[0]);let i="";r instanceof Ix&&(r.length>32&&(i="..."),r=r.slice(0,32).toString("hex"));let s=e[1],a=e[2],l=`${t.constructor.name}.deserialize(cursor=${r}${i}`;return s!==void 0&&(l+=`, fullyQualifiedFormat=${s}`),a!==void 0&&(l+=`, nullable=${a}`),l+=`): ${n.message.replace(/\.$/,"")}.`,n.message=l,n},"des_error");Xp.exports={des_error:Rx}});var Qp=m(($I,Zp)=>{"use strict";var{Buffer:er}=require("buffer"),$r;Zp.exports=($r=class{get INT32_MIN(){return-2147483648}get INT32_MAX(){return 2147483647}constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.INT]=this}canBeUsedFor(e){return!(typeof e!="number"||e<this.INT32_MIN||e>this.INT32_MAX)}serialize(e,r=!0){if(e==null)return r?er.from([this.ioc.DataType.INT,1]):er.from([0,0,0,0]);let n=[];r&&n.push(er.from([this.ioc.DataType.INT,0]));let i=er.alloc(4);return i.writeInt32BE(e),n.push(i),er.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof er))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let a=i.readUInt8();if(n++,a!==this.ioc.DataType.INT)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let l=i.readUInt8();if(n++,l===1)return{v:null,len:n};if(l!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<4)throw new Error("unexpected {value} length");return n+=4,{v:i.readInt32BE(),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o($r,"IntSerializer"),$r)});var tg=m((FI,eg)=>{"use strict";var{Buffer:tr}=require("buffer"),Wr;eg.exports=(Wr=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.LONG]=this}canBeUsedFor(){}serialize(e,r=!0){if(e==null)return r?tr.from([this.ioc.DataType.LONG,1]):tr.from([0,0,0,0,0,0,0,0]);let n=[];r&&n.push(tr.from([this.ioc.DataType.LONG,0]));let i=tr.alloc(8);return i.writeBigInt64BE(BigInt(e)),n.push(i),tr.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof tr))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let a=i.readUInt8();if(n++,a!==this.ioc.DataType.LONG)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let l=i.readUInt8();if(n++,l===1)return{v:null,len:n};if(l!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<8)throw new Error("unexpected {value} length");n+=8;let s=i.readBigInt64BE();return s<Number.MIN_SAFE_INTEGER||s>Number.MAX_SAFE_INTEGER?s=parseFloat(s.toString()):s=Number(s),{v:s,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Wr,"LongSerializer"),Wr)});var ng=m((HI,rg)=>{"use strict";var{Buffer:rr}=require("buffer"),Fr;rg.exports=(Fr=class{constructor(e){this.ioc=e}canBeUsedFor(){}serialize(e,r=!0){if(e==null)return r?rr.from([this.ioc.DataType.LONG,1]):rr.from([0,0,0,0,0,0,0,0]);let n=[];r&&n.push(rr.from([this.ioc.DataType.LONG,0]));let i=rr.alloc(8);return i.writeBigInt64BE(BigInt(e)),n.push(i),rr.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof rr))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let a=i.readUInt8();if(n++,a!==this.ioc.DataType.LONG)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let l=i.readUInt8();if(n++,l===1)return{v:null,len:n};if(l!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<8)throw new Error("unexpected {value} length");return n+=8,{v:i.readBigInt64BE(),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Fr,"LongSerializerNg"),Fr)});var Cc=m((KI,ig)=>{"use strict";var{Buffer:Gr}=require("buffer"),Hr;ig.exports=(Hr=class{constructor(e,r){this.ioc=e,this.ID=r,this.ioc.serializers[r]=this}canBeUsedFor(e){return typeof e=="string"}serialize(e,r=!0){if(e==null)return r?Gr.from([this.ID,1]):this.ioc.intSerializer.serialize(0,!1);let n=[];r&&n.push(Gr.from([this.ID,0]));let i=Gr.from(String(e),"utf8");return n.push(this.ioc.intSerializer.serialize(i.length,!1)),n.push(i),Gr.concat(n)}deserialize(e,r=!0,n=!1){let i=0,s=e;try{if(e==null||!(e instanceof Gr))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let u=s.readUInt8();if(i++,u!==this.ID)throw new Error("unexpected {type_code}");s=s.slice(1)}if(r||n){if(s.length<1)throw new Error("{value_flag} is missing");let u=s.readUInt8();if(i++,u===1)return{v:null,len:i};if(u!==0)throw new Error("unexpected {value_flag}");s=s.slice(1)}let a,l;try{({v:a,len:l}=this.ioc.intSerializer.deserialize(s,!1)),i+=l}catch(u){throw u.message="{length}: "+u.message,u}if(a<0)throw new Error("{length} is less than zero");if(s=s.slice(l),s.length<a)throw new Error("unexpected {text_value} length");return i+=a,{v:s.toString("utf8",0,a),len:i}}catch(a){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:s,err:a})}}},o(Hr,"StringSerializer"),Hr)});var Lc=m((JI,sg)=>{"use strict";var{Buffer:nr}=require("buffer"),Yr;sg.exports=(Yr=class{constructor(e,r){this.ioc=e,this.ID=r,this.ioc.serializers[r]=this}canBeUsedFor(e){return e instanceof Date}serialize(e,r=!0){if(e==null)return r?nr.from([this.ID,1]):nr.from([0,0,0,0,0,0,0,0]);let n=[];r&&n.push(nr.from([this.ID,0]));let i=nr.alloc(8);return i.writeBigInt64BE(BigInt(e.getTime())),n.push(i),nr.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof nr))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let l=i.readUInt8();if(n++,l!==this.ID)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let c=i.readUInt8();if(n++,c===1)return{v:null,len:n};if(c!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<8)throw new Error("unexpected {value} length");n+=8;let s=i.readBigInt64BE();return{v:new Date(Number(s)),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Yr,"DateSerializer"),Yr)});var ag=m((QI,og)=>{"use strict";var{Buffer:ir}=require("buffer"),Kr;og.exports=(Kr=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.DOUBLE]=this}canBeUsedFor(e){return typeof e=="number"&&!Number.isInteger(e)}serialize(e,r=!0){if(e==null)return r?ir.from([this.ioc.DataType.DOUBLE,1]):ir.from([0,0,0,0,0,0,0,0]);let n=[];r&&n.push(ir.from([this.ioc.DataType.DOUBLE,0]));let i=ir.alloc(8);return i.writeDoubleBE(e),n.push(i),ir.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof ir))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let a=i.readUInt8();if(n++,a!==this.ioc.DataType.DOUBLE)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let l=i.readUInt8();if(n++,l===1)return{v:null,len:n};if(l!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<8)throw new Error("unexpected {value} length");return n+=8,{v:i.readDoubleBE(),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Kr,"DoubleSerializer"),Kr)});var cg=m((tR,lg)=>{"use strict";var{Buffer:sr}=require("buffer"),Xr;lg.exports=(Xr=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.FLOAT]=this}canBeUsedFor(e){}serialize(e,r=!0){if(e==null)return r?sr.from([this.ioc.DataType.FLOAT,1]):sr.from([0,0,0,0]);let n=[];r&&n.push(sr.from([this.ioc.DataType.FLOAT,0]));let i=sr.alloc(4);return i.writeFloatBE(e),n.push(i),sr.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof sr))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let a=i.readUInt8();if(n++,a!==this.ioc.DataType.FLOAT)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let l=i.readUInt8();if(n++,l===1)return{v:null,len:n};if(l!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<4)throw new Error("unexpected {value} length");return n+=4,{v:i.readFloatBE(),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Xr,"FloatSerializer"),Xr)});var qc=m((nR,ug)=>{"use strict";var{Buffer:Jr}=require("buffer"),Zr;ug.exports=(Zr=class{constructor(e,r){this.ioc=e,this.ID=r,this.ioc.serializers[r]=this}canBeUsedFor(e){return Array.isArray(e)}serialize(e,r=!0){if(e==null)return r?Jr.from([this.ID,1]):Jr.from([0,0,0,0]);let n=[];r&&n.push(Jr.from([this.ID,0]));let i=e.length;if(i<0&&(i=0),i>this.ioc.intSerializer.INT32_MAX)throw new Error(`Array length=${i} is greater than supported max_length=${this.ioc.intSerializer.INT32_MAX}.`);n.push(this.ioc.intSerializer.serialize(i,!1));for(let s=0;s<i;s++)n.push(this.ioc.anySerializer.serialize(e[s]));return Jr.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof Jr))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let c=i.readUInt8();if(n++,c!==this.ID)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let u=i.readUInt8();if(n++,u===1)return{v:null,len:n};if(u!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.intSerializer.deserialize(i,!1)),n+=a}catch(c){throw c.message="{length}: "+c.message,c}if(s<0)throw new Error("{length} is less than zero");i=i.slice(a);let l=[];for(let c=0;c<s;c++){let u,f;try{({v:u,len:f}=this.ioc.anySerializer.deserialize(i)),n+=f}catch(d){throw d.message=`{item_${c}}: `+d.message,d}i=i.slice(f),l.push(u)}return{v:l,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Zr,"ArraySerializer"),Zr)});var dg=m((sR,fg)=>{"use strict";var{Buffer:Yi}=require("buffer"),Qr;fg.exports=(Qr=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.MAP]=this}canBeUsedFor(e){return e==null?!1:e instanceof Map?!0:Array.isArray(e)?!1:typeof e=="object"}serialize(e,r=!0){if(e==null)return r?Yi.from([this.ioc.DataType.MAP,1]):this.ioc.intSerializer.serialize(0,!1);let n=e instanceof Map,i=n?Array.from(e.keys()):Object.keys(e),s=i.length;s<0?s=0:s>this.ioc.intSerializer.INT32_MAX&&(s=this.ioc.intSerializer.INT32_MAX);let a=[];r&&a.push(Yi.from([this.ioc.DataType.MAP,0])),a.push(this.ioc.intSerializer.serialize(s,!1));for(let l=0;l<s;l++){let c=i[l],u=n?e.get(c):e[c];a.push(this.ioc.anySerializer.serialize(c),this.ioc.anySerializer.serialize(u))}return Yi.concat(a)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof Yi))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let c=i.readUInt8();if(n++,c!==this.ioc.DataType.MAP)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let u=i.readUInt8();if(n++,u===1)return{v:null,len:n};if(u!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.intSerializer.deserialize(i,!1)),n+=a}catch(c){throw c.message="{length}: "+c.message,c}if(s<0)throw new Error("{length} is less than zero");i=i.slice(a);let l=new Map;for(let c=0;c<s;c++){let u,f;try{({v:u,len:f}=this.ioc.anySerializer.deserialize(i)),n+=f}catch(y){throw y.message=`{item_${c}} key: `+y.message,y}i=i.slice(f);let d,p;try{({v:d,len:p}=this.ioc.anySerializer.deserialize(i)),n+=p}catch(y){throw y.message=`{item_${c}} value: `+y.message,y}i=i.slice(p),l.set(u,d)}return{v:l,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Qr,"MapSerializer"),Qr)});var pg=m((aR,hg)=>{"use strict";var{Buffer:or}=require("buffer"),en;hg.exports=(en=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.UUID]=this}canBeUsedFor(e){}serialize(e,r=!0){if(e==null)return r?or.from([this.ioc.DataType.UUID,1]):or.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);let n=String(e).replace(/^urn:uuid:/,"").replace(/[{}-]/g,""),i=[];r&&i.push(or.from([this.ioc.DataType.UUID,0]));let s=or.alloc(16,0);for(let a=0;a<16&&a*2<n.length;a++)s[a]=parseInt(n.slice(a*2,a*2+2),16);return i.push(s),or.concat(i)}deserialize(e,r=!0,n=!1){let i=0,s=e;try{if(e==null||!(e instanceof or))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let l=s.readUInt8();if(i++,l!==this.ioc.DataType.UUID)throw new Error("unexpected {type_code}");s=s.slice(1)}if(r||n){if(s.length<1)throw new Error("{value_flag} is missing");let l=s.readUInt8();if(i++,l===1)return{v:null,len:i};if(l!==0)throw new Error("unexpected {value_flag}");s=s.slice(1)}if(s.length<16)throw new Error("unexpected {value} length");return i+=16,{v:s.slice(0,4).toString("hex")+"-"+s.slice(4,6).toString("hex")+"-"+s.slice(6,8).toString("hex")+"-"+s.slice(8,10).toString("hex")+"-"+s.slice(10,16).toString("hex"),len:i}}catch(a){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:s,err:a})}}},o(en,"UuidSerializer"),en)});var yg=m((cR,gg)=>{"use strict";var{Buffer:tn}=require("buffer"),Ki=Ke(),rn;gg.exports=(rn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.EDGE]=this}canBeUsedFor(e){return e instanceof Ki.Edge}serialize(e,r=!0){if(e==null){if(r)return tn.from([this.ioc.DataType.EDGE,1]);let c=[3,0,0,0,0,0],u=[0,0,0,0],f=[3,0,0,0,0,0],d=[0,0,0,0],p=[3,0,0,0,0,0],y=[0,0,0,0],_=[254,1],g=[254,1];return tn.from([...c,...u,...f,...d,...p,...y,..._,...g])}let n=[];r&&n.push(tn.from([this.ioc.DataType.EDGE,0])),n.push(this.ioc.anySerializer.serialize(e.id)),n.push(this.ioc.stringSerializer.serialize(e.label,!1));let i=e.inV&&e.inV.id;n.push(this.ioc.anySerializer.serialize(i));let s=e.inV&&e.inV.label;n.push(this.ioc.stringSerializer.serialize(s,!1));let a=e.outV&&e.outV.id;n.push(this.ioc.anySerializer.serialize(a));let l=e.outV&&e.outV.label;return n.push(this.ioc.stringSerializer.serialize(l,!1)),n.push(this.ioc.unspecifiedNullSerializer.serialize(null)),n.push(this.ioc.unspecifiedNullSerializer.serialize(null)),tn.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof tn))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let x=i.readUInt8();if(n++,x!==this.ioc.DataType.EDGE)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let de=i.readUInt8();if(n++,de===1)return{v:null,len:n};if(de!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.anySerializer.deserialize(i)),n+=a}catch(x){throw x.message="{id}: "+x.message,x}i=i.slice(a);let l,c;try{({v:l,len:c}=this.ioc.stringSerializer.deserialize(i,!1)),n+=c}catch(x){throw x.message="{label}: "+x.message,x}i=i.slice(c);let u,f;try{({v:u,len:f}=this.ioc.anySerializer.deserialize(i)),n+=f}catch(x){throw x.message="{inVId}: "+x.message,x}i=i.slice(f);let d,p;try{({v:d,len:p}=this.ioc.stringSerializer.deserialize(i,!1)),n+=p}catch(x){throw x.message="{inVLabel}: "+x.message,x}i=i.slice(p);let y,_;try{({v:y,len:_}=this.ioc.anySerializer.deserialize(i)),n+=_}catch(x){throw x.message="{outVId}: "+x.message,x}i=i.slice(_);let g,I;try{({v:g,len:I}=this.ioc.stringSerializer.deserialize(i,!1)),n+=I}catch(x){throw x.message="{outVLabel}: "+x.message,x}i=i.slice(I);let T;try{({len:T}=this.ioc.anySerializer.deserialize(i)),n+=T}catch(x){throw x.message="{parent}: "+x.message,x}i=i.slice(T);let R,D;try{({v:R,len:D}=this.ioc.anySerializer.deserialize(i)),n+=D}catch(x){throw x.message="{properties}: "+x.message,x}return i=i.slice(D),{v:new Ki.Edge(s,new Ki.Vertex(y,g,null),l,new Ki.Vertex(u,d,null),R),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(rn,"EdgeSerializer"),rn)});var mg=m((fR,wg)=>{"use strict";var{Buffer:nn}=require("buffer"),bg=Ke(),sn;wg.exports=(sn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.PATH]=this}canBeUsedFor(e){return e instanceof bg.Path}serialize(e,r=!0){if(e==null)return r?nn.from([this.ioc.DataType.PATH,1]):nn.concat([this.ioc.listSerializer.serialize([]),this.ioc.listSerializer.serialize([])]);let n=[];return r&&n.push(nn.from([this.ioc.DataType.PATH,0])),n.push(this.ioc.listSerializer.serialize(e.labels)),n.push(this.ioc.listSerializer.serialize(e.objects)),nn.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof nn))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let f=i.readUInt8();if(n++,f!==this.ioc.DataType.PATH)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let d=i.readUInt8();if(n++,d===1)return{v:null,len:n};if(d!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.listSerializer.deserialize(i)),n+=a}catch(f){throw f.message="{labels}: "+f.message,f}i=i.slice(a);let l,c;try{({v:l,len:c}=this.ioc.listSerializer.deserialize(i)),n+=c}catch(f){throw f.message="{objects}: "+f.message,f}return i=i.slice(c),{v:new bg.Path(s,l),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(sn,"PathSerializer"),sn)});var Eg=m((hR,Sg)=>{"use strict";var{Buffer:on}=require("buffer"),_g=Ke(),an;Sg.exports=(an=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.PROPERTY]=this}canBeUsedFor(e){return e instanceof _g.Property}serialize(e,r=!0){if(e==null)return r?on.from([this.ioc.DataType.PROPERTY,1]):on.concat([this.ioc.stringSerializer.serialize("",!1),this.ioc.unspecifiedNullSerializer.serialize(null),this.ioc.unspecifiedNullSerializer.serialize(null)]);let n=[];return r&&n.push(on.from([this.ioc.DataType.PROPERTY,0])),n.push(this.ioc.stringSerializer.serialize(e.key,!1)),n.push(this.ioc.anySerializer.serialize(e.value)),n.push(this.ioc.unspecifiedNullSerializer.serialize(null)),on.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof on))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let d=i.readUInt8();if(n++,d!==this.ioc.DataType.PROPERTY)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let p=i.readUInt8();if(n++,p===1)return{v:null,len:n};if(p!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.stringSerializer.deserialize(i,!1)),n+=a}catch(d){throw d.message="{key}: "+d.message,d}i=i.slice(a);let l,c;try{({v:l,len:c}=this.ioc.anySerializer.deserialize(i)),n+=c}catch(d){throw d.message="{value}: "+d.message,d}i=i.slice(c);let u;try{({len:u}=this.ioc.unspecifiedNullSerializer.deserialize(i)),n+=u}catch(d){throw d.message="{parent}: "+d.message,d}return i=i.slice(u),{v:new _g.Property(s,l),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(an,"PropertySerializer"),an)});var Tg=m((gR,vg)=>{"use strict";var{Buffer:ln}=require("buffer"),xg=Ke(),cn;vg.exports=(cn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.VERTEX]=this}canBeUsedFor(e){return e instanceof xg.Vertex}serialize(e,r=!0){if(e==null){if(r)return ln.from([this.ioc.DataType.VERTEX,1]);let i=[3,0,0,0,0,0],s=[0,0,0,0],a=[254,1];return ln.from([...i,...s,...a])}let n=[];return r&&n.push(ln.from([this.ioc.DataType.VERTEX,0])),n.push(this.ioc.anySerializer.serialize(e.id)),n.push(this.ioc.stringSerializer.serialize(e.label,!1)),n.push(this.ioc.anySerializer.serialize(e.properties)),ln.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof ln))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let p=i.readUInt8();if(n++,p!==this.ioc.DataType.VERTEX)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let y=i.readUInt8();if(n++,y===1)return{v:null,len:n};if(y!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.anySerializer.deserialize(i)),n+=a}catch(p){throw p.message="{id}: "+p.message,p}i=i.slice(a);let l,c;try{({v:l,len:c}=this.ioc.stringSerializer.deserialize(i,!1)),n+=c}catch(p){throw p.message="{label}: "+p.message,p}i=i.slice(c);let u,f;try{({v:u,len:f}=this.ioc.anySerializer.deserialize(i)),n+=f}catch(p){throw p.message="{properties}: "+p.message,p}return i=i.slice(f),{v:new xg.Vertex(s,l,u),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(cn,"VertexSerializer"),cn)});var Ag=m((bR,Rg)=>{"use strict";var{Buffer:un}=require("buffer"),Ig=Ke(),fn;Rg.exports=(fn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.VERTEXPROPERTY]=this}canBeUsedFor(e){return e instanceof Ig.VertexProperty}serialize(e,r=!0){if(e==null)return r?un.from([this.ioc.DataType.VERTEXPROPERTY,1]):un.concat([this.ioc.unspecifiedNullSerializer.serialize(null),this.ioc.stringSerializer.serialize("",!1),this.ioc.unspecifiedNullSerializer.serialize(null),this.ioc.unspecifiedNullSerializer.serialize(null),this.ioc.unspecifiedNullSerializer.serialize(null)]);let n=[];return r&&n.push(un.from([this.ioc.DataType.VERTEXPROPERTY,0])),n.push(this.ioc.anySerializer.serialize(e.id)),n.push(this.ioc.stringSerializer.serialize(e.label,!1)),n.push(this.ioc.anySerializer.serialize(e.value)),n.push(this.ioc.unspecifiedNullSerializer.serialize(null)),n.push(this.ioc.anySerializer.serialize(e.properties)),un.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof un))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let g=i.readUInt8();if(n++,g!==this.ioc.DataType.VERTEXPROPERTY)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let I=i.readUInt8();if(n++,I===1)return{v:null,len:n};if(I!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.anySerializer.deserialize(i)),n+=a}catch(g){throw g.message="{id}: "+g.message,g}i=i.slice(a);let l,c;try{({v:l,len:c}=this.ioc.stringSerializer.deserialize(i,!1)),n+=c}catch(g){throw g.message="{label}: "+g.message,g}i=i.slice(c);let u,f;try{({v:u,len:f}=this.ioc.anySerializer.deserialize(i)),n+=f}catch(g){throw g.message="{value}: "+g.message,g}i=i.slice(f);let d;try{({len:d}=this.ioc.unspecifiedNullSerializer.deserialize(i)),n+=d}catch(g){throw g.message="{parent}: "+g.message,g}i=i.slice(d);let p,y;try{({v:p,len:y}=this.ioc.anySerializer.deserialize(i)),n+=y}catch(g){throw g.message="{properties}: "+g.message,g}return i=i.slice(y),{v:new Ig.VertexProperty(s,l,u,p),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(fn,"VertexPropertySerializer"),fn)});var kg=m((mR,Ng)=>{"use strict";var{Buffer:dn}=require("buffer"),Og=De(),zg=me(),hn;Ng.exports=(hn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BYTECODE]=this}canBeUsedFor(e){return e instanceof Og||e instanceof zg.Traversal}serialize(e,r=!0){if(e==null){if(r)return dn.from([this.ioc.DataType.BYTECODE,1]);let i=[0,0,0,0],s=[0,0,0,0];return dn.from([...i,...s])}e instanceof zg.Traversal&&(e=e.getBytecode());let n=[];r&&n.push(dn.from([this.ioc.DataType.BYTECODE,0])),n.push(this.ioc.intSerializer.serialize(e.stepInstructions.length,!1));for(let i=0;i<e.stepInstructions.length;i++){let s=e.stepInstructions[i],a=s[0],l=s.length-1;n.push(this.ioc.stringSerializer.serialize(a,!1)),n.push(this.ioc.intSerializer.serialize(l,!1));for(let c=0;c<l;c++)n.push(this.ioc.anySerializer.serialize(s[1+c],!0))}n.push(this.ioc.intSerializer.serialize(e.sourceInstructions.length,!1));for(let i=0;i<e.sourceInstructions.length;i++){let s=e.sourceInstructions[i],a=s[0],l=s.length-1;n.push(this.ioc.stringSerializer.serialize(a,!1)),n.push(this.ioc.intSerializer.serialize(l,!1));for(let c=0;c<l;c++)n.push(this.ioc.anySerializer.serialize(s[1+c],!0))}return dn.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof dn))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let f=i.readUInt8();if(n++,f!==this.ioc.DataType.BYTECODE)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let d=i.readUInt8();if(n++,d===1)return{v:null,len:n};if(d!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s=new Og,a,l;try{({v:a,len:l}=this.ioc.intSerializer.deserialize(i,!1)),n+=l}catch(f){throw f.message="{steps_length}: "+f.message,f}if(a<0)throw new Error("{steps_length} is less than zero");i=i.slice(l);for(let f=0;f<a;f++){let d,p;try{({v:d,len:p}=this.ioc.stringSerializer.deserialize(i,!1)),n+=p}catch(R){throw R.message=`{step_${f}} {name}: `+R.message,R}i=i.slice(p);let y,_;try{({v:y,len:_}=this.ioc.intSerializer.deserialize(i,!1)),n+=_}catch(R){throw R.message=`{step_${f}} {values_length}: `+R.message,R}if(y<0)throw new Error(`{step_${f}} {values_length} is less than zero`);i=i.slice(_);let g=[],I,T;for(let R=0;R<y;R++){try{({v:I,len:T}=this.ioc.anySerializer.deserialize(i)),n+=T,g.push(I)}catch(D){throw D.message=`{step_${f}} {value_${R}}: `+D.message,D}i=i.slice(T)}s.addStep(d,g)}let c,u;try{({v:c,len:u}=this.ioc.intSerializer.deserialize(i,!1)),n+=u}catch(f){throw f.message="{sources_length}: "+f.message,f}if(c<0)throw new Error("{sources_length} is less than zero");i=i.slice(u);for(let f=0;f<c;f++){let d,p;try{({v:d,len:p}=this.ioc.stringSerializer.deserialize(i,!1)),n+=p}catch(R){throw R.message=`{source_${f}} {name}: `+R.message,R}i=i.slice(p);let y,_;try{({v:y,len:_}=this.ioc.intSerializer.deserialize(i,!1)),n+=_}catch(R){throw R.message=`{source_${f}} {values_length}: `+R.message,R}if(y<0)throw new Error(`{source_${f}} {values_length} is less than zero`);i=i.slice(_);let g=[],I,T;for(let R=0;R<y;R++){try{({v:I,len:T}=this.ioc.anySerializer.deserialize(i)),n+=T,g.push(I)}catch(D){throw D.message=`{source_${f}} {value_${R}}: `+D.message,D}i=i.slice(T)}s.addSource(d,g)}return{v:s,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(hn,"BytecodeSerializer"),hn)});var Dg=m((SR,Pg)=>{"use strict";var{Buffer:pn}=require("buffer"),Xi=me(),gn;Pg.exports=(gn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.P]=this}canBeUsedFor(e){return e instanceof Xi.P}serialize(e,r=!0){if(e==null){if(r)return pn.from([this.ioc.DataType.P,1]);let s=[0,0,0,0],a=[0,0,0,0];return pn.from([...s,...a])}let n=[];r&&n.push(pn.from([this.ioc.DataType.P,0])),n.push(this.ioc.stringSerializer.serialize(e.operator,!1));let i;return e.other===void 0||e.other===null?Array.isArray(e.value)?i=e.value:i=[e.value]:i=[e.value,e.other],n.push(this.ioc.listSerializer.serialize(i,!1)),pn.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof pn))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let d=i.readUInt8();if(n++,d!==this.ioc.DataType.P)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let p=i.readUInt8();if(n++,p===1)return{v:null,len:n};if(p!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.stringSerializer.deserialize(i,!1)),n+=a}catch(d){throw d.message="{name}: "+d.message,d}i=i.slice(a);let l,c;try{({v:l,len:c}=this.ioc.listSerializer.deserialize(i,!1)),n+=c}catch(d){throw d.message="{values}: "+d.message,d}if(i=i.slice(c),l.length<1)return{v:new Xi.P(""),len:n};let u,f=Xi.P[s];return typeof f=="function"?u=f(...l):u=new Xi.P(s,...l),{v:u,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(gn,"PSerializer"),gn)});var qg=m((xR,Lg)=>{"use strict";var{Buffer:yn}=require("buffer"),Cg=me(),bn;Lg.exports=(bn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.TRAVERSER]=this}canBeUsedFor(e){return e instanceof Cg.Traverser}serialize(e,r=!0){if(e==null){if(r)return yn.from([this.ioc.DataType.TRAVERSER,1]);let i=[0,0,0,0,0,0,0,1],s=[254,1];return yn.from([...i,...s])}let n=[];return r&&n.push(yn.from([this.ioc.DataType.TRAVERSER,0])),n.push(this.ioc.longSerializer.serialize(e.bulk,!1)),n.push(this.ioc.anySerializer.serialize(e.object)),yn.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof yn))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let f=i.readUInt8();if(n++,f!==this.ioc.DataType.TRAVERSER)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let d=i.readUInt8();if(n++,d===1)return{v:null,len:n};if(d!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.longSerializer.deserialize(i,!1)),n+=a}catch(f){throw f.message="{bulk}: "+f.message,f}if(s<0)throw new Error("{bulk} is less than zero");i=i.slice(a);let l,c;try{({v:l,len:c}=this.ioc.anySerializer.deserialize(i)),n+=c}catch(f){throw f.message="{value}: "+f.message,f}return i=i.slice(c),{v:new Cg.Traverser(l,s),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(bn,"TraverserSerializer"),bn)});var Mg=m((TR,Bg)=>{"use strict";var{Buffer:wn}=require("buffer"),be=me(),mn;Bg.exports=(mn=class{constructor(e){this.ioc=e;let r=o(i=>{let s={};return Object.values(i).forEach(a=>s[a.elementName]=a),s},"to_orig_enum"),n=e.DataType;this.types=[{name:"Barrier",code:n.BARRIER,enum:r(be.barrier)},{name:"Cardinality",code:n.CARDINALITY,enum:r(be.cardinality)},{name:"Column",code:n.COLUMN,enum:r(be.column)},{name:"Direction",code:n.DIRECTION,enum:r(be.direction)},{name:"DT",code:n.DT,enum:r(be.dt)},{name:"Merge",code:n.MERGE,enum:r(be.merge)},{name:"Operator",code:n.OPERATOR,enum:r(be.operator)},{name:"Order",code:n.ORDER,enum:r(be.order)},{name:"Pick",code:n.PICK,enum:r(be.pick)},{name:"Pop",code:n.POP,enum:r(be.pop)},{name:"Scope",code:n.SCOPE,enum:r(be.scope)},{name:"T",code:n.T,enum:r(be.t)}],this.byname={},this.bycode={};for(let i of this.types)this.ioc.serializers[i.code]=this,this.byname[i.name]=i,this.bycode[i.code]=i}canBeUsedFor(e){if(!(e instanceof be.EnumValue))return!1;if(!this.byname[e.typeName])throw new Error(`EnumSerializer.serialize: typeName=${e.typeName} is not supported.`);return!0}serialize(e,r=!0){let n=this.byname[e.typeName];if(e.elementName===void 0||e.elementName===null)return r?wn.from([n.code,1]):wn.from([this.ioc.DataType.STRING,0,0,0,0,0]);let i=[];return r&&i.push(wn.from([n.code,0])),i.push(this.ioc.stringSerializer.serialize(e.elementName,!0)),wn.concat(i)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof wn))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");let s;if(r){let u=i.readUInt8();if(n++,s=this.bycode[u],!s)throw new Error(`unexpected {type_code}=${u}`);if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let f=i.readUInt8();if(n++,f===1)return{v:null,len:n};if(f!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let a,l;try{({v:a,len:l}=this.ioc.stringSerializer.deserialize(i,!0)),n+=l}catch(u){throw u.message="elementName: "+u.message,u}i=i.slice(l);let c;return s?c=s.enum[a]:c=new be.EnumValue(void 0,a),{v:c,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(mn,"EnumSerializer"),mn)});var jg=m((RR,Ug)=>{"use strict";var{Buffer:Ji}=require("buffer"),{valueKey:Bc,LambdaSerializer:Ax}=ui(),_n;Ug.exports=(_n=class{constructor(e){this.ioc=e,this.graphsonLambdaSerializer=new Ax}canBeUsedFor(e){return this.graphsonLambdaSerializer.canBeUsedFor(e)}serialize(e,r=!0){if(e==null){if(r)return Ji.from([this.ioc.DataType.LAMBDA,1]);let c=[0,0,0,0],u=[0,0,0,0],f=[0,0,0,0];return Ji.from([...c,...u,...f])}let n=[];r&&n.push(Ji.from([this.ioc.DataType.LAMBDA,0]));let i=this.graphsonLambdaSerializer.serialize(e),s=i[Bc].language,a=i[Bc].script,l=i[Bc].arguments;return n.push(this.ioc.stringSerializer.serialize(s,!1)),n.push(this.ioc.stringSerializer.serialize(a,!1)),n.push(this.ioc.intSerializer.serialize(l,!1)),Ji.concat(n)}},o(_n,"LambdaSerializer"),_n)});var $g=m((OR,Vg)=>{"use strict";var{Buffer:Nt}=require("buffer"),Sn;Vg.exports=(Sn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BIGINTEGER]=this}canBeUsedFor(e){return typeof e=="bigint"}serialize(e,r=!0){if(e==null)return r?Nt.from([this.ioc.DataType.BIGINTEGER,1]):Nt.from([0,0,0,1,0]);let n=[];r&&n.push(Nt.from([this.ioc.DataType.BIGINTEGER,0]));let i;if(e>=0){let s=e.toString(16);s.length%2!==0&&(s="0"+s),Number.parseInt(s[0],16)>7&&(s="00"+s),i=Nt.from(s,"hex")}else{let s=(-e).toString(16),a=(s.length+s.length%2)/2,l=BigInt(a)*BigInt(8),c=-(BigInt(2)**(l-BigInt(1)));e<c&&(l+=BigInt(8)),s=(BigInt(2)**l+e).toString(16),s.length%2!==0&&(s="0"+s),i=Nt.from(s,"hex")}return n.push(this.ioc.intSerializer.serialize(i.length,!1)),n.push(i),Nt.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof Nt))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let u=i.readUInt8();if(n++,u!==this.ioc.DataType.BIGINTEGER)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let f=i.readUInt8();if(n++,f===1)return{v:null,len:n};if(f!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.intSerializer.deserialize(i,!1)),n+=a}catch(u){throw u.message="{length}: "+u.message,u}if(s<1)throw new Error(`{length}=${s} is less than one`);i=i.slice(a),n+=s,i=i.slice(0,s);let l=BigInt(`0x${i.toString("hex")}`);return(i[0]&128)===128&&(l=BigInt.asIntN(s*8,l)),{v:l,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Sn,"BigIntegerSerializer"),Sn)});var Fg=m((NR,Wg)=>{"use strict";var{Buffer:ar}=require("buffer"),En;Wg.exports=(En=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BYTE]=this}serialize(e,r=!0){if(e==null)return r?ar.from([this.ioc.DataType.BYTE,1]):ar.from([0]);let n=[];r&&n.push(ar.from([this.ioc.DataType.BYTE,0]));let i=ar.alloc(1);return i.writeUInt8(e),n.push(i),ar.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof ar))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let a=i.readUInt8();if(n++,a!==this.ioc.DataType.BYTE)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let l=i.readUInt8();if(n++,l===1)return{v:null,len:n};if(l!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<1)throw new Error("unexpected {value} length");return n+=1,{v:i.readUInt8(),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(En,"ByteSerializer"),En)});var Hg=m((PR,Gg)=>{"use strict";var{Buffer:lr}=require("buffer"),xn;Gg.exports=(xn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BYTEBUFFER]=this}canBeUsedFor(e){return e instanceof lr}serialize(e,r=!0){if(e==null)return r?lr.from([this.ioc.DataType.BYTEBUFFER,1]):lr.from([0,0,0,0]);let n=[];r&&n.push(lr.from([this.ioc.DataType.BYTEBUFFER,0]));let i=e.length;if(i<0&&(i=0),i>this.ioc.intSerializer.INT32_MAX)throw new Error(`Buffer length=${i} is greater than supported max_length=${this.ioc.intSerializer.INT32_MAX}.`);return n.push(this.ioc.intSerializer.serialize(i,!1)),n.push(e),lr.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof lr))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let c=i.readUInt8();if(n++,c!==this.ioc.DataType.BYTEBUFFER)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let u=i.readUInt8();if(n++,u===1)return{v:null,len:n};if(u!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.intSerializer.deserialize(i,!1)),n+=a}catch(c){throw c.message="{length}: "+c.message,c}if(s<0)throw new Error("{length} is less than zero");if(i=i.slice(a),s!==i.length)throw new Error(`{value}: unexpected actual {value} length=${i.length} when {length}=${s}`);let l=i.slice(0,s);return n+=s,{v:l,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(xn,"ByteBufferSerializer"),xn)});var Kg=m((CR,Yg)=>{"use strict";var{Buffer:cr}=require("buffer"),vn;Yg.exports=(vn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.SHORT]=this}canBeUsedFor(e){}serialize(e,r=!0){if(e==null)return r?cr.from([this.ioc.DataType.SHORT,1]):cr.from([0,0]);let n=[];r&&n.push(cr.from([this.ioc.DataType.SHORT,0]));let i=cr.alloc(2);return i.writeInt16BE(e),n.push(i),cr.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof cr))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let a=i.readUInt8();if(n++,a!==this.ioc.DataType.SHORT)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let l=i.readUInt8();if(n++,l===1)return{v:null,len:n};if(l!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<2)throw new Error("unexpected {value} length");return n+=2,{v:i.readInt16BE(),len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(vn,"ShortSerializer"),vn)});var Jg=m((qR,Xg)=>{"use strict";var{Buffer:ur}=require("buffer"),Tn;Xg.exports=(Tn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BOOLEAN]=this}canBeUsedFor(e){return typeof e=="boolean"}serialize(e,r=!0){if(e==null)return r?ur.from([this.ioc.DataType.BOOLEAN,1]):ur.from([0]);let n=[];return r&&n.push(ur.from([this.ioc.DataType.BOOLEAN,0])),n.push(ur.from([e?1:0])),ur.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof ur))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let a=i.readUInt8();if(n++,a!==this.ioc.DataType.BOOLEAN)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let l=i.readUInt8();if(n++,l===1)return{v:null,len:n};if(l!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<1)throw new Error("unexpected {value} length");n+=1;let s=i.readUInt8();if(s!==0&&s!==1)throw new Error(`unexpected boolean byte=${s}`);return s=s===1,{v:s,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Tn,"BooleanSerializer"),Tn)});var Qg=m((MR,Zg)=>{"use strict";var{Buffer:In}=require("buffer"),Zi=me(),Rn;Zg.exports=(Rn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.TEXTP]=this}canBeUsedFor(e){return e instanceof Zi.TextP}serialize(e,r=!0){if(e==null){if(r)return In.from([this.ioc.DataType.TEXTP,1]);let s=[0,0,0,0],a=[0,0,0,0];return In.from([...s,...a])}let n=[];r&&n.push(In.from([this.ioc.DataType.TEXTP,0])),n.push(this.ioc.stringSerializer.serialize(e.operator,!1));let i;return e.other===void 0||e.other===null?Array.isArray(e.value)?i=e.value:i=[e.value]:i=[e.value,e.other],n.push(this.ioc.listSerializer.serialize(i,!1)),In.concat(n)}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof In))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let d=i.readUInt8();if(n++,d!==this.ioc.DataType.TEXTP)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let p=i.readUInt8();if(n++,p===1)return{v:null,len:n};if(p!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.stringSerializer.deserialize(i,!1)),n+=a}catch(d){throw d.message="{name}: "+d.message,d}i=i.slice(a);let l,c;try{({v:l,len:c}=this.ioc.listSerializer.deserialize(i,!1)),n+=c}catch(d){throw d.message="{values}: "+d.message,d}if(i=i.slice(c),l.length<1)return{v:new Zi.TextP(""),len:n};let u,f=Zi.TextP[s];return typeof f=="function"?u=f(...l):u=new Zi.TextP(s,...l),{v:u,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(Rn,"TextPSerializer"),Rn)});var ty=m((jR,ey)=>{"use strict";var{Buffer:Qi}=require("buffer"),{TraversalStrategySerializer:Ox}=ui(),An;ey.exports=(An=class{constructor(e){this.ioc=e,this.graphsonTraversalStrategySerializer=new Ox}canBeUsedFor(e){return this.graphsonTraversalStrategySerializer.canBeUsedFor(e)}serialize(e,r=!0){if(e==null){if(r)return Qi.from([this.ioc.DataType.TRAVERSALSTRATEGY,1]);let a=[0,0,0,0],l=[0,0,0,0];return Qi.from([...a,...l])}let n=[];r&&n.push(Qi.from([this.ioc.DataType.TRAVERSALSTRATEGY,0]));let i=e.fqcn,s={};for(let a in e.configuration)e.configuration.hasOwnProperty(a)&&(s[a]=e.configuration[a]);return n.push(this.ioc.classSerializer.serialize(i,!1)),n.push(this.ioc.mapSerializer.serialize(s,!1)),Qi.concat(n)}},o(An,"TraversalStrategySerializer"),An)});var ny=m(($R,ry)=>{"use strict";var{Buffer:zx}=require("buffer"),On;ry.exports=(On=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BULKSET]=this}deserialize(e,r=!0){let n=0,i=e;try{if(e==null||!(e instanceof zx))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(r){let c=i.readUInt8();if(n++,c!==this.ioc.DataType.BULKSET)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");let u=i.readUInt8();if(n++,u===1)return{v:null,len:n};if(u!==0)throw new Error("unexpected {value_flag}");i=i.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.intSerializer.deserialize(i,!1)),n+=a}catch(c){throw c.message="{length}: "+c.message,c}if(s<0)throw new Error("{length} is less than zero");i=i.slice(a);let l=new Array;for(let c=0;c<s;c++){let u,f;try{({v:u,len:f}=this.ioc.anySerializer.deserialize(i)),n+=f}catch(_){throw _.message=`{item_${c}} value: `+_.message,_}i=i.slice(f);let d,p;try{({v:d,len:p}=this.ioc.longSerializer.deserialize(i,!1)),n+=p}catch(_){throw _.message=`{item_${c}} bulk: `+_.message,_}if(d<0)throw new Error(`{item_${c}}: bulk is less than zero`);if(d>4294967295)throw new Error(`{item_${c}}: bulk is greater than 2^32-1`);i=i.slice(p),d=Number(d);let y=new Array(d).fill(u);l=l.concat(y)}return{v:l,len:n}}catch(s){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:s})}}},o(On,"BulkSetSerializer"),On)});var oy=m((FR,sy)=>{"use strict";var{Buffer:iy}=require("buffer"),zn;sy.exports=(zn=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.UNSPECIFIED_NULL]=this}canBeUsedFor(e){return e==null}serialize(e){return iy.from([this.ioc.DataType.UNSPECIFIED_NULL,1])}deserialize(e){let r=0,n=e;try{if(e==null||!(e instanceof iy))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");let i=n.readUInt8();if(r++,i!==this.ioc.DataType.UNSPECIFIED_NULL)throw new Error("unexpected {type_code}");if(n=n.slice(1),n.length<1)throw new Error("{value_flag} is missing");let s=n.readUInt8();if(r++,s!==1)throw new Error("unexpected {value_flag}");return n=n.slice(1),{v:null,len:r}}catch(i){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:n,err:i})}}},o(zn,"UnspecifiedNullSerializer"),zn)});var ly=m((HR,ay)=>{"use strict";var Nn;ay.exports=(Nn=class{constructor(e){this.ioc=e}canBeUsedFor(e){return!!(Number.isNaN(e)||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY||typeof e=="number"||typeof e=="bigint")}serialize(e,r=!0){if(typeof e=="number")return Number.isNaN(e)||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY||!Number.isInteger(e)?this.ioc.doubleSerializer.serialize(e,r):e>=-2147483648&&e<=2147483647?this.ioc.intSerializer.serialize(e,r):this.ioc.longSerializer.serialize(e,r);if(typeof e=="bigint")return this.ioc.bigIntegerSerializer.serialize(e,r)}},o(Nn,"NumberSerializationStrategy"),Nn)});var uy=m((KR,cy)=>{"use strict";var{Buffer:Nx}=require("buffer"),kn;cy.exports=(kn=class{constructor(e){this.ioc=e,this.serializers=[e.unspecifiedNullSerializer,e.numberSerializationStrategy,e.booleanSerializer,e.dateSerializer,e.bytecodeSerializer,e.pSerializer,e.traverserSerializer,e.enumSerializer,e.listSerializer,e.uuidSerializer,e.edgeSerializer,e.pathSerializer,e.propertySerializer,e.vertexSerializer,e.vertexPropertySerializer,e.stringSerializer,e.textPSerializer,e.traversalStrategySerializer,e.byteBufferSerializer,e.lambdaSerializer,e.mapSerializer]}getSerializerCanBeUsedFor(e){for(let r=0;r<this.serializers.length;r++)if(this.serializers[r].canBeUsedFor(e))return this.serializers[r];throw new Error(`No serializer found to support item where typeof(item)='${typeof e}' and String(item)='${String(e)}'.`)}serialize(e,r=!0){return this.getSerializerCanBeUsedFor(e).serialize(e,r)}deserialize(e){try{if(e==null||!(e instanceof Nx))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");let r=e.readUInt8(),n=this.ioc.serializers[r];if(!n)throw new Error("unknown {type_code}");return n.deserialize(e)}catch(r){throw this.ioc.utils.des_error({serializer:this,args:arguments,err:r})}}},o(kn,"AnySerializer"),kn)});var dy=m((JR,fy)=>{"use strict";var{Buffer:kx}=require("buffer"),Pn;fy.exports=(Pn=class{constructor(e){this.ioc=e}readResponse(e){if(e==null)throw new Error("Buffer is missing.");if(!(e instanceof kx))throw new Error("Not an instance of Buffer.");if(e.length<1)throw new Error("Buffer is empty.");let r={status:{},result:{}},n=e,i,s=n[0];if(s!==129)throw new Error(`Unsupported version '${s}'.`);return n=n.slice(1),{v:r.requestId,len:i}=this.ioc.uuidSerializer.deserialize(n,!1,!0),n=n.slice(i),{v:r.status.code,len:i}=this.ioc.intSerializer.deserialize(n,!1),n=n.slice(i),{v:r.status.message,len:i}=this.ioc.stringSerializer.deserialize(n,!1,!0),n=n.slice(i),{v:r.status.attributes,len:i}=this.ioc.mapSerializer.deserialize(n,!1),n=n.slice(i),{v:r.result.meta,len:i}=this.ioc.mapSerializer.deserialize(n,!1),n=n.slice(i),{v:r.result.data}=this.ioc.anySerializer.deserialize(n),r}},o(Pn,"GraphBinaryReader"),Pn)});var gy=m((QR,py)=>{"use strict";var{Buffer:hy}=require("buffer"),Dn;py.exports=(Dn=class{constructor(e){this.ioc=e}writeRequest({requestId:e,op:r,processor:n,args:i}){let s=[hy.from([129]),this.ioc.uuidSerializer.serialize(e,!1),this.ioc.stringSerializer.serialize(r,!1),this.ioc.stringSerializer.serialize(n,!1),this.ioc.mapSerializer.serialize(i,!1)];return hy.concat(s)}},o(Dn,"GraphBinaryWriter"),Dn)});var by=m((tA,yy)=>{"use strict";var S={};S.DataType=Kp();S.utils=Jp();S.serializers={};S.intSerializer=new(Qp())(S);S.longSerializer=new(tg())(S);S.longSerializerNg=new(ng())(S);S.stringSerializer=new(Cc())(S,S.DataType.STRING);S.dateSerializer=new(Lc())(S,S.DataType.DATE);S.timestampSerializer=new(Lc())(S,S.DataType.TIMESTAMP);S.classSerializer=new(Cc())(S,S.DataType.CLASS);S.doubleSerializer=new(ag())(S);S.floatSerializer=new(cg())(S);S.listSerializer=new(qc())(S,S.DataType.LIST);S.mapSerializer=new(dg())(S);S.setSerializer=new(qc())(S,S.DataType.SET);S.uuidSerializer=new(pg())(S);S.edgeSerializer=new(yg())(S);S.pathSerializer=new(mg())(S);S.propertySerializer=new(Eg())(S);S.vertexSerializer=new(Tg())(S);S.vertexPropertySerializer=new(Ag())(S);S.bytecodeSerializer=new(kg())(S);S.pSerializer=new(Dg())(S);S.traverserSerializer=new(qg())(S);S.enumSerializer=new(Mg())(S);S.lambdaSerializer=new(jg())(S);S.bigIntegerSerializer=new($g())(S);S.byteSerializer=new(Fg())(S);S.byteBufferSerializer=new(Hg())(S);S.shortSerializer=new(Kg())(S);S.booleanSerializer=new(Jg())(S);S.textPSerializer=new(Qg())(S);S.traversalStrategySerializer=new(ty())(S);S.bulkSetSerializer=new(ny())(S);S.unspecifiedNullSerializer=new(oy())(S);S.numberSerializationStrategy=new(ly())(S);S.anySerializer=new(uy())(S);S.graphBinaryReader=new(dy())(S);S.graphBinaryWriter=new(gy())(S);yy.exports=S});var jc=m((rA,wy)=>{"use strict";var Px=_t(),Dx=Object.freeze(new Px.ImmutableMap),Uc=class Uc{constructor(e,r){if(!Array.isArray(e))throw new TypeError("items must be an Array instance");this._items=e,this.attributes=r||Dx,this.length=e.length}[Symbol.iterator](){return this._items[Symbol.iterator]()}toArray(){return this._items}first(){let e=this._items[0];return e!==void 0?e:null}};o(Uc,"ResultSet");var Mc=Uc;wy.exports=Mc});var Wc=m((iA,my)=>{"use strict";var $c=class $c extends Error{constructor(e,r){super(e),this.name="ResponseError",this.statusCode=r.code,this.statusMessage=r.message,this.statusAttributes=r.attributes||{}}};o($c,"ResponseError");var Vc=$c;my.exports=Vc});var xy=m((oA,Ey)=>{"use strict";var{Duplex:Cx}=require("stream");function _y(t){t.emit("close")}o(_y,"emitClose");function Lx(){!this.destroyed&&this._writableState.finished&&this.destroy()}o(Lx,"duplexOnEnd");function Sy(t){this.removeListener("error",Sy),this.destroy(),this.listenerCount("error")===0&&this.emit("error",t)}o(Sy,"duplexOnError");function qx(t,e){let r=!0,n=new Cx({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return t.on("message",o(function(s,a){let l=!a&&n._readableState.objectMode?s.toString():s;n.push(l)||t.pause()},"message")),t.once("error",o(function(s){n.destroyed||(r=!1,n.destroy(s))},"error")),t.once("close",o(function(){n.destroyed||n.push(null)},"close")),n._destroy=function(i,s){if(t.readyState===t.CLOSED){s(i),process.nextTick(_y,n);return}let a=!1;t.once("error",o(function(c){a=!0,s(c)},"error")),t.once("close",o(function(){a||s(i),process.nextTick(_y,n)},"close")),r&&t.terminate()},n._final=function(i){if(t.readyState===t.CONNECTING){t.once("open",o(function(){n._final(i)},"open"));return}t._socket!==null&&(t._socket._writableState.finished?(i(),n._readableState.endEmitted&&n.destroy()):(t._socket.once("finish",o(function(){i()},"finish")),t.close()))},n._read=function(){t.isPaused&&t.resume()},n._write=function(i,s,a){if(t.readyState===t.CONNECTING){t.once("open",o(function(){n._write(i,s,a)},"open"));return}t.send(i,a)},n.on("end",Lx),n.on("error",Sy),n}o(qx,"createWebSocketStream");Ey.exports=qx});var yt=m((lA,vy)=>{"use strict";vy.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Cn=m((cA,es)=>{"use strict";var{EMPTY_BUFFER:Bx}=yt(),Fc=Buffer[Symbol.species];function Mx(t,e){if(t.length===0)return Bx;if(t.length===1)return t[0];let r=Buffer.allocUnsafe(e),n=0;for(let i=0;i<t.length;i++){let s=t[i];r.set(s,n),n+=s.length}return n<e?new Fc(r.buffer,r.byteOffset,n):r}o(Mx,"concat");function Ty(t,e,r,n,i){for(let s=0;s<i;s++)r[n+s]=t[s]^e[s&3]}o(Ty,"_mask");function Iy(t,e){for(let r=0;r<t.length;r++)t[r]^=e[r&3]}o(Iy,"_unmask");function Ux(t){return t.length===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.length)}o(Ux,"toArrayBuffer");function Gc(t){if(Gc.readOnly=!0,Buffer.isBuffer(t))return t;let e;return t instanceof ArrayBuffer?e=new Fc(t):ArrayBuffer.isView(t)?e=new Fc(t.buffer,t.byteOffset,t.byteLength):(e=Buffer.from(t),Gc.readOnly=!1),e}o(Gc,"toBuffer");es.exports={concat:Mx,mask:Ty,toArrayBuffer:Ux,toBuffer:Gc,unmask:Iy};if(!process.env.WS_NO_BUFFER_UTIL)try{let t=require("bufferutil");es.exports.mask=function(e,r,n,i,s){s<48?Ty(e,r,n,i,s):t.mask(e,r,n,i,s)},es.exports.unmask=function(e,r){e.length<32?Iy(e,r):t.unmask(e,r)}}catch{}});var Oy=m((fA,Ay)=>{"use strict";var Ry=Symbol("kDone"),Hc=Symbol("kRun"),Kc=class Kc{constructor(e){this[Ry]=()=>{this.pending--,this[Hc]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[Hc]()}[Hc](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[Ry])}}};o(Kc,"Limiter");var Yc=Kc;Ay.exports=Yc});var Bn=m((hA,Py)=>{"use strict";var Ln=require("zlib"),zy=Cn(),jx=Oy(),{kStatusCode:Ny}=yt(),Vx=Buffer[Symbol.species],$x=Buffer.from([0,0,255,255]),ns=Symbol("permessage-deflate"),rt=Symbol("total-length"),qn=Symbol("callback"),bt=Symbol("buffers"),rs=Symbol("error"),ts,Jc=class Jc{constructor(e,r,n){if(this._maxPayload=n|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!ts){let i=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;ts=new jx(i)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[qn];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let r=this._options,n=e.find(i=>!(r.serverNoContextTakeover===!1&&i.server_no_context_takeover||i.server_max_window_bits&&(r.serverMaxWindowBits===!1||typeof r.serverMaxWindowBits=="number"&&r.serverMaxWindowBits>i.server_max_window_bits)||typeof r.clientMaxWindowBits=="number"&&!i.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return r.serverNoContextTakeover&&(n.server_no_context_takeover=!0),r.clientNoContextTakeover&&(n.client_no_context_takeover=!0),typeof r.serverMaxWindowBits=="number"&&(n.server_max_window_bits=r.serverMaxWindowBits),typeof r.clientMaxWindowBits=="number"?n.client_max_window_bits=r.clientMaxWindowBits:(n.client_max_window_bits===!0||r.clientMaxWindowBits===!1)&&delete n.client_max_window_bits,n}acceptAsClient(e){let r=e[0];if(this._options.clientNoContextTakeover===!1&&r.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!r.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(r.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&r.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return r}normalizeParams(e){return e.forEach(r=>{Object.keys(r).forEach(n=>{let i=r[n];if(i.length>1)throw new Error(`Parameter "${n}" must have only a single value`);if(i=i[0],n==="client_max_window_bits"){if(i!==!0){let s=+i;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=s}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else if(n==="server_max_window_bits"){let s=+i;if(!Number.isInteger(s)||s<8||s>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=s}else if(n==="client_no_context_takeover"||n==="server_no_context_takeover"){if(i!==!0)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else throw new Error(`Unknown parameter "${n}"`);r[n]=i})}),e}decompress(e,r,n){ts.add(i=>{this._decompress(e,r,(s,a)=>{i(),n(s,a)})})}compress(e,r,n){ts.add(i=>{this._compress(e,r,(s,a)=>{i(),n(s,a)})})}_decompress(e,r,n){let i=this._isServer?"client":"server";if(!this._inflate){let s=`${i}_max_window_bits`,a=typeof this.params[s]!="number"?Ln.Z_DEFAULT_WINDOWBITS:this.params[s];this._inflate=Ln.createInflateRaw({...this._options.zlibInflateOptions,windowBits:a}),this._inflate[ns]=this,this._inflate[rt]=0,this._inflate[bt]=[],this._inflate.on("error",Fx),this._inflate.on("data",ky)}this._inflate[qn]=n,this._inflate.write(e),r&&this._inflate.write($x),this._inflate.flush(()=>{let s=this._inflate[rs];if(s){this._inflate.close(),this._inflate=null,n(s);return}let a=zy.concat(this._inflate[bt],this._inflate[rt]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[rt]=0,this._inflate[bt]=[],r&&this.params[`${i}_no_context_takeover`]&&this._inflate.reset()),n(null,a)})}_compress(e,r,n){let i=this._isServer?"server":"client";if(!this._deflate){let s=`${i}_max_window_bits`,a=typeof this.params[s]!="number"?Ln.Z_DEFAULT_WINDOWBITS:this.params[s];this._deflate=Ln.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:a}),this._deflate[rt]=0,this._deflate[bt]=[],this._deflate.on("data",Wx)}this._deflate[qn]=n,this._deflate.write(e),this._deflate.flush(Ln.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let s=zy.concat(this._deflate[bt],this._deflate[rt]);r&&(s=new Vx(s.buffer,s.byteOffset,s.length-4)),this._deflate[qn]=null,this._deflate[rt]=0,this._deflate[bt]=[],r&&this.params[`${i}_no_context_takeover`]&&this._deflate.reset(),n(null,s)})}};o(Jc,"PerMessageDeflate");var Xc=Jc;Py.exports=Xc;function Wx(t){this[bt].push(t),this[rt]+=t.length}o(Wx,"deflateOnData");function ky(t){if(this[rt]+=t.length,this[ns]._maxPayload<1||this[rt]<=this[ns]._maxPayload){this[bt].push(t);return}this[rs]=new RangeError("Max payload size exceeded"),this[rs].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[rs][Ny]=1009,this.removeListener("data",ky),this.reset()}o(ky,"inflateOnData");function Fx(t){this[ns]._inflate=null,t[Ny]=1007,this[qn](t)}o(Fx,"inflateOnError")});var Mn=m((gA,is)=>{"use strict";var{isUtf8:Dy}=require("buffer"),Gx=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function Hx(t){return t>=1e3&&t<=1014&&t!==1004&&t!==1005&&t!==1006||t>=3e3&&t<=4999}o(Hx,"isValidStatusCode");function Zc(t){let e=t.length,r=0;for(;r<e;)if(!(t[r]&128))r++;else if((t[r]&224)===192){if(r+1===e||(t[r+1]&192)!==128||(t[r]&254)===192)return!1;r+=2}else if((t[r]&240)===224){if(r+2>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||t[r]===224&&(t[r+1]&224)===128||t[r]===237&&(t[r+1]&224)===160)return!1;r+=3}else if((t[r]&248)===240){if(r+3>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||(t[r+3]&192)!==128||t[r]===240&&(t[r+1]&240)===128||t[r]===244&&t[r+1]>143||t[r]>244)return!1;r+=4}else return!1;return!0}o(Zc,"_isValidUTF8");is.exports={isValidStatusCode:Hx,isValidUTF8:Zc,tokenChars:Gx};if(Dy)is.exports.isValidUTF8=function(t){return t.length<24?Zc(t):Dy(t)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=require("utf-8-validate");is.exports.isValidUTF8=function(e){return e.length<32?Zc(e):t(e)}}catch{}});var iu=m((bA,jy)=>{"use strict";var{Writable:Yx}=require("stream"),Cy=Bn(),{BINARY_TYPES:Kx,EMPTY_BUFFER:Ly,kStatusCode:Xx,kWebSocket:Jx}=yt(),{concat:Qc,toArrayBuffer:Zx,unmask:Qx}=Cn(),{isValidStatusCode:ev,isValidUTF8:qy}=Mn(),ss=Buffer[Symbol.species],Te=0,By=1,My=2,Uy=3,eu=4,tu=5,os=6,nu=class nu extends Yx{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||Kx[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[Jx]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=Te}_write(e,r,n){if(this._opcode===8&&this._state==Te)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let n=this._buffers[0];return this._buffers[0]=new ss(n.buffer,n.byteOffset+e,n.length-e),new ss(n.buffer,n.byteOffset,e)}let r=Buffer.allocUnsafe(e);do{let n=this._buffers[0],i=r.length-e;e>=n.length?r.set(this._buffers.shift(),i):(r.set(new Uint8Array(n.buffer,n.byteOffset,e),i),this._buffers[0]=new ss(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return r}startLoop(e){this._loop=!0;do switch(this._state){case Te:this.getInfo(e);break;case By:this.getPayloadLength16(e);break;case My:this.getPayloadLength64(e);break;case Uy:this.getMask();break;case eu:this.getData(e);break;case tu:case os:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let r=this.consume(2);if(r[0]&48){let i=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(i);return}let n=(r[0]&64)===64;if(n&&!this._extensions[Cy.extensionName]){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(this._fin=(r[0]&128)===128,this._opcode=r[0]&15,this._payloadLength=r[1]&127,this._opcode===0){if(n){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(!this._fragmented){let i=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let i=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}this._compressed=n}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let i=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(i);return}if(n){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let i=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(i);return}}else{let i=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(r[1]&128)===128,this._isServer){if(!this._masked){let i=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(i);return}}else if(this._masked){let i=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(i);return}this._payloadLength===126?this._state=By:this._payloadLength===127?this._state=My:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let r=this.consume(8),n=r.readUInt32BE(0);if(n>Math.pow(2,21)-1){let i=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(i);return}this._payloadLength=n*Math.pow(2,32)+r.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let r=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(r);return}this._masked?this._state=Uy:this._state=eu}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=eu}getData(e){let r=Ly;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}r=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&Qx(r,this._mask)}if(this._opcode>7){this.controlMessage(r,e);return}if(this._compressed){this._state=tu,this.decompress(r,e);return}r.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(r)),this.dataMessage(e)}decompress(e,r){this._extensions[Cy.extensionName].decompress(e,this._fin,(i,s)=>{if(i)return r(i);if(s.length){if(this._messageLength+=s.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let a=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");r(a);return}this._fragments.push(s)}this.dataMessage(r),this._state===Te&&this.startLoop(r)})}dataMessage(e){if(!this._fin){this._state=Te;return}let r=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let i;this._binaryType==="nodebuffer"?i=Qc(n,r):this._binaryType==="arraybuffer"?i=Zx(Qc(n,r)):i=n,this._allowSynchronousEvents?(this.emit("message",i,!0),this._state=Te):(this._state=os,setImmediate(()=>{this.emit("message",i,!0),this._state=Te,this.startLoop(e)}))}else{let i=Qc(n,r);if(!this._skipUTF8Validation&&!qy(i)){let s=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(s);return}this._state===tu||this._allowSynchronousEvents?(this.emit("message",i,!1),this._state=Te):(this._state=os,setImmediate(()=>{this.emit("message",i,!1),this._state=Te,this.startLoop(e)}))}}controlMessage(e,r){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,Ly),this.end();else{let n=e.readUInt16BE(0);if(!ev(n)){let s=this.createError(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");r(s);return}let i=new ss(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!qy(i)){let s=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");r(s);return}this._loop=!1,this.emit("conclude",n,i),this.end()}this._state=Te;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=Te):(this._state=os,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=Te,this.startLoop(r)}))}createError(e,r,n,i,s){this._loop=!1,this._errored=!0;let a=new e(n?`Invalid WebSocket frame: ${r}`:r);return Error.captureStackTrace(a,this.createError),a.code=s,a[Xx]=i,a}};o(nu,"Receiver");var ru=nu;jy.exports=ru});var ou=m((_A,Wy)=>{"use strict";var{Duplex:mA}=require("stream"),{randomFillSync:tv}=require("crypto"),Vy=Bn(),{EMPTY_BUFFER:rv}=yt(),{isValidStatusCode:nv}=Mn(),{mask:$y,toBuffer:fr}=Cn(),ke=Symbol("kByteLength"),iv=Buffer.alloc(4),as=8*1024,kt,dr=as,nt=class nt{constructor(e,r,n){this._extensions=r||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,r){let n,i=!1,s=2,a=!1;r.mask&&(n=r.maskBuffer||iv,r.generateMask?r.generateMask(n):(dr===as&&(kt===void 0&&(kt=Buffer.alloc(as)),tv(kt,0,as),dr=0),n[0]=kt[dr++],n[1]=kt[dr++],n[2]=kt[dr++],n[3]=kt[dr++]),a=(n[0]|n[1]|n[2]|n[3])===0,s=6);let l;typeof e=="string"?(!r.mask||a)&&r[ke]!==void 0?l=r[ke]:(e=Buffer.from(e),l=e.length):(l=e.length,i=r.mask&&r.readOnly&&!a);let c=l;l>=65536?(s+=8,c=127):l>125&&(s+=2,c=126);let u=Buffer.allocUnsafe(i?l+s:s);return u[0]=r.fin?r.opcode|128:r.opcode,r.rsv1&&(u[0]|=64),u[1]=c,c===126?u.writeUInt16BE(l,2):c===127&&(u[2]=u[3]=0,u.writeUIntBE(l,4,6)),r.mask?(u[1]|=128,u[s-4]=n[0],u[s-3]=n[1],u[s-2]=n[2],u[s-1]=n[3],a?[u,e]:i?($y(e,n,u,s,l),[u]):($y(e,n,e,0,l),[u,e])):[u,e]}close(e,r,n,i){let s;if(e===void 0)s=rv;else{if(typeof e!="number"||!nv(e))throw new TypeError("First argument must be a valid error code number");if(r===void 0||!r.length)s=Buffer.allocUnsafe(2),s.writeUInt16BE(e,0);else{let l=Buffer.byteLength(r);if(l>123)throw new RangeError("The message must not be greater than 123 bytes");s=Buffer.allocUnsafe(2+l),s.writeUInt16BE(e,0),typeof r=="string"?s.write(r,2):s.set(r,2)}}let a={[ke]:s.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,s,!1,a,i]):this.sendFrame(nt.frame(s,a),i)}ping(e,r,n){let i,s;if(typeof e=="string"?(i=Buffer.byteLength(e),s=!1):(e=fr(e),i=e.length,s=fr.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let a={[ke]:i,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:9,readOnly:s,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,a,n]):this.sendFrame(nt.frame(e,a),n)}pong(e,r,n){let i,s;if(typeof e=="string"?(i=Buffer.byteLength(e),s=!1):(e=fr(e),i=e.length,s=fr.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let a={[ke]:i,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:10,readOnly:s,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,a,n]):this.sendFrame(nt.frame(e,a),n)}send(e,r,n){let i=this._extensions[Vy.extensionName],s=r.binary?2:1,a=r.compress,l,c;if(typeof e=="string"?(l=Buffer.byteLength(e),c=!1):(e=fr(e),l=e.length,c=fr.readOnly),this._firstFragment?(this._firstFragment=!1,a&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(a=l>=i._threshold),this._compress=a):(a=!1,s=0),r.fin&&(this._firstFragment=!0),i){let u={[ke]:l,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:c,rsv1:a};this._deflating?this.enqueue([this.dispatch,e,this._compress,u,n]):this.dispatch(e,this._compress,u,n)}else this.sendFrame(nt.frame(e,{[ke]:l,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:s,readOnly:c,rsv1:!1}),n)}dispatch(e,r,n,i){if(!r){this.sendFrame(nt.frame(e,n),i);return}let s=this._extensions[Vy.extensionName];this._bufferedBytes+=n[ke],this._deflating=!0,s.compress(e,n.fin,(a,l)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");typeof i=="function"&&i(c);for(let u=0;u<this._queue.length;u++){let f=this._queue[u],d=f[f.length-1];typeof d=="function"&&d(c)}return}this._bufferedBytes-=n[ke],this._deflating=!1,n.readOnly=!1,this.sendFrame(nt.frame(l,n),i),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][ke],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][ke],this._queue.push(e)}sendFrame(e,r){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],r),this._socket.uncork()):this._socket.write(e[0],r)}};o(nt,"Sender");var su=nt;Wy.exports=su});var Qy=m((EA,Zy)=>{"use strict";var{kForOnEventAttribute:Un,kListener:au}=yt(),Fy=Symbol("kCode"),Gy=Symbol("kData"),Hy=Symbol("kError"),Yy=Symbol("kMessage"),Ky=Symbol("kReason"),hr=Symbol("kTarget"),Xy=Symbol("kType"),Jy=Symbol("kWasClean"),lu=class lu{constructor(e){this[hr]=null,this[Xy]=e}get target(){return this[hr]}get type(){return this[Xy]}};o(lu,"Event");var it=lu;Object.defineProperty(it.prototype,"target",{enumerable:!0});Object.defineProperty(it.prototype,"type",{enumerable:!0});var cu=class cu extends it{constructor(e,r={}){super(e),this[Fy]=r.code===void 0?0:r.code,this[Ky]=r.reason===void 0?"":r.reason,this[Jy]=r.wasClean===void 0?!1:r.wasClean}get code(){return this[Fy]}get reason(){return this[Ky]}get wasClean(){return this[Jy]}};o(cu,"CloseEvent");var Pt=cu;Object.defineProperty(Pt.prototype,"code",{enumerable:!0});Object.defineProperty(Pt.prototype,"reason",{enumerable:!0});Object.defineProperty(Pt.prototype,"wasClean",{enumerable:!0});var uu=class uu extends it{constructor(e,r={}){super(e),this[Hy]=r.error===void 0?null:r.error,this[Yy]=r.message===void 0?"":r.message}get error(){return this[Hy]}get message(){return this[Yy]}};o(uu,"ErrorEvent");var pr=uu;Object.defineProperty(pr.prototype,"error",{enumerable:!0});Object.defineProperty(pr.prototype,"message",{enumerable:!0});var fu=class fu extends it{constructor(e,r={}){super(e),this[Gy]=r.data===void 0?null:r.data}get data(){return this[Gy]}};o(fu,"MessageEvent");var jn=fu;Object.defineProperty(jn.prototype,"data",{enumerable:!0});var sv={addEventListener(t,e,r={}){for(let i of this.listeners(t))if(!r[Un]&&i[au]===e&&!i[Un])return;let n;if(t==="message")n=o(function(s,a){let l=new jn("message",{data:a?s:s.toString()});l[hr]=this,ls(e,this,l)},"onMessage");else if(t==="close")n=o(function(s,a){let l=new Pt("close",{code:s,reason:a.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});l[hr]=this,ls(e,this,l)},"onClose");else if(t==="error")n=o(function(s){let a=new pr("error",{error:s,message:s.message});a[hr]=this,ls(e,this,a)},"onError");else if(t==="open")n=o(function(){let s=new it("open");s[hr]=this,ls(e,this,s)},"onOpen");else return;n[Un]=!!r[Un],n[au]=e,r.once?this.once(t,n):this.on(t,n)},removeEventListener(t,e){for(let r of this.listeners(t))if(r[au]===e&&!r[Un]){this.removeListener(t,r);break}}};Zy.exports={CloseEvent:Pt,ErrorEvent:pr,Event:it,EventTarget:sv,MessageEvent:jn};function ls(t,e,r){typeof t=="object"&&t.handleEvent?t.handleEvent.call(t,r):t.call(e,r)}o(ls,"callListener")});var du=m((vA,eb)=>{"use strict";var{tokenChars:Vn}=Mn();function je(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}o(je,"push");function ov(t){let e=Object.create(null),r=Object.create(null),n=!1,i=!1,s=!1,a,l,c=-1,u=-1,f=-1,d=0;for(;d<t.length;d++)if(u=t.charCodeAt(d),a===void 0)if(f===-1&&Vn[u]===1)c===-1&&(c=d);else if(d!==0&&(u===32||u===9))f===-1&&c!==-1&&(f=d);else if(u===59||u===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${d}`);f===-1&&(f=d);let y=t.slice(c,f);u===44?(je(e,y,r),r=Object.create(null)):a=y,c=f=-1}else throw new SyntaxError(`Unexpected character at index ${d}`);else if(l===void 0)if(f===-1&&Vn[u]===1)c===-1&&(c=d);else if(u===32||u===9)f===-1&&c!==-1&&(f=d);else if(u===59||u===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${d}`);f===-1&&(f=d),je(r,t.slice(c,f),!0),u===44&&(je(e,a,r),r=Object.create(null),a=void 0),c=f=-1}else if(u===61&&c!==-1&&f===-1)l=t.slice(c,d),c=f=-1;else throw new SyntaxError(`Unexpected character at index ${d}`);else if(i){if(Vn[u]!==1)throw new SyntaxError(`Unexpected character at index ${d}`);c===-1?c=d:n||(n=!0),i=!1}else if(s)if(Vn[u]===1)c===-1&&(c=d);else if(u===34&&c!==-1)s=!1,f=d;else if(u===92)i=!0;else throw new SyntaxError(`Unexpected character at index ${d}`);else if(u===34&&t.charCodeAt(d-1)===61)s=!0;else if(f===-1&&Vn[u]===1)c===-1&&(c=d);else if(c!==-1&&(u===32||u===9))f===-1&&(f=d);else if(u===59||u===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${d}`);f===-1&&(f=d);let y=t.slice(c,f);n&&(y=y.replace(/\\/g,""),n=!1),je(r,l,y),u===44&&(je(e,a,r),r=Object.create(null),a=void 0),l=void 0,c=f=-1}else throw new SyntaxError(`Unexpected character at index ${d}`);if(c===-1||s||u===32||u===9)throw new SyntaxError("Unexpected end of input");f===-1&&(f=d);let p=t.slice(c,f);return a===void 0?je(e,p,r):(l===void 0?je(r,p,!0):n?je(r,l,p.replace(/\\/g,"")):je(r,l,p),je(e,a,r)),e}o(ov,"parse");function av(t){return Object.keys(t).map(e=>{let r=t[e];return Array.isArray(r)||(r=[r]),r.map(n=>[e].concat(Object.keys(n).map(i=>{let s=n[i];return Array.isArray(s)||(s=[s]),s.map(a=>a===!0?i:`${i}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")}o(av,"format");eb.exports={format:av,parse:ov}});var bu=m((AA,fb)=>{"use strict";var lv=require("events"),cv=require("https"),uv=require("http"),nb=require("net"),fv=require("tls"),{randomBytes:dv,createHash:hv}=require("crypto"),{Duplex:IA,Readable:RA}=require("stream"),{URL:hu}=require("url"),wt=Bn(),pv=iu(),gv=ou(),{BINARY_TYPES:tb,EMPTY_BUFFER:cs,GUID:yv,kForOnEventAttribute:pu,kListener:bv,kStatusCode:wv,kWebSocket:fe,NOOP:ib}=yt(),{EventTarget:{addEventListener:mv,removeEventListener:_v}}=Qy(),{format:Sv,parse:Ev}=du(),{toBuffer:xv}=Cn(),vv=30*1e3,sb=Symbol("kAborted"),gu=[8,13],st=["CONNECTING","OPEN","CLOSING","CLOSED"],Tv=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,j=class j extends lv{constructor(e,r,n){super(),this._binaryType=tb[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=cs,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=j.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,r===void 0?r=[]:Array.isArray(r)||(typeof r=="object"&&r!==null?(n=r,r=[]):r=[r]),ob(this,e,r,n)):(this._autoPong=n.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){tb.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,r,n){let i=new pv({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new gv(e,this._extensions,n.generateMask),this._receiver=i,this._socket=e,i[fe]=this,e[fe]=this,i.on("conclude",Av),i.on("drain",Ov),i.on("error",zv),i.on("message",Nv),i.on("ping",kv),i.on("pong",Pv),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),r.length>0&&e.unshift(r),e.on("close",lb),e.on("data",fs),e.on("end",cb),e.on("error",ub),this._readyState=j.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=j.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[wt.extensionName]&&this._extensions[wt.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=j.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,r){if(this.readyState!==j.CLOSED){if(this.readyState===j.CONNECTING){_e(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===j.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=j.CLOSING,this._sender.close(e,r,!this._isServer,n=>{n||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),vv)}}pause(){this.readyState===j.CONNECTING||this.readyState===j.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,r,n){if(this.readyState===j.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==j.OPEN){yu(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.ping(e||cs,r,n)}pong(e,r,n){if(this.readyState===j.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==j.OPEN){yu(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.pong(e||cs,r,n)}resume(){this.readyState===j.CONNECTING||this.readyState===j.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,r,n){if(this.readyState===j.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof r=="function"&&(n=r,r={}),typeof e=="number"&&(e=e.toString()),this.readyState!==j.OPEN){yu(this,e,n);return}let i={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...r};this._extensions[wt.extensionName]||(i.compress=!1),this._sender.send(e||cs,i,n)}terminate(){if(this.readyState!==j.CLOSED){if(this.readyState===j.CONNECTING){_e(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=j.CLOSING,this._socket.destroy())}}};o(j,"WebSocket");var H=j;Object.defineProperty(H,"CONNECTING",{enumerable:!0,value:st.indexOf("CONNECTING")});Object.defineProperty(H.prototype,"CONNECTING",{enumerable:!0,value:st.indexOf("CONNECTING")});Object.defineProperty(H,"OPEN",{enumerable:!0,value:st.indexOf("OPEN")});Object.defineProperty(H.prototype,"OPEN",{enumerable:!0,value:st.indexOf("OPEN")});Object.defineProperty(H,"CLOSING",{enumerable:!0,value:st.indexOf("CLOSING")});Object.defineProperty(H.prototype,"CLOSING",{enumerable:!0,value:st.indexOf("CLOSING")});Object.defineProperty(H,"CLOSED",{enumerable:!0,value:st.indexOf("CLOSED")});Object.defineProperty(H.prototype,"CLOSED",{enumerable:!0,value:st.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(t=>{Object.defineProperty(H.prototype,t,{enumerable:!0})});["open","error","close","message"].forEach(t=>{Object.defineProperty(H.prototype,`on${t}`,{enumerable:!0,get(){for(let e of this.listeners(t))if(e[pu])return e[bv];return null},set(e){for(let r of this.listeners(t))if(r[pu]){this.removeListener(t,r);break}typeof e=="function"&&this.addEventListener(t,e,{[pu]:!0})}})});H.prototype.addEventListener=mv;H.prototype.removeEventListener=_v;fb.exports=H;function ob(t,e,r,n){let i={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:gu[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(t._autoPong=i.autoPong,!gu.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${gu.join(", ")})`);let s;if(e instanceof hu)s=e;else try{s=new hu(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}s.protocol==="http:"?s.protocol="ws:":s.protocol==="https:"&&(s.protocol="wss:"),t._url=s.href;let a=s.protocol==="wss:",l=s.protocol==="ws+unix:",c;if(s.protocol!=="ws:"&&!a&&!l?c=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:l&&!s.pathname?c="The URL's pathname is empty":s.hash&&(c="The URL contains a fragment identifier"),c){let g=new SyntaxError(c);if(t._redirects===0)throw g;us(t,g);return}let u=a?443:80,f=dv(16).toString("base64"),d=a?cv.request:uv.request,p=new Set,y;if(i.createConnection=i.createConnection||(a?Rv:Iv),i.defaultPort=i.defaultPort||u,i.port=s.port||u,i.host=s.hostname.startsWith("[")?s.hostname.slice(1,-1):s.hostname,i.headers={...i.headers,"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":f,Connection:"Upgrade",Upgrade:"websocket"},i.path=s.pathname+s.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(y=new wt(i.perMessageDeflate!==!0?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=Sv({[wt.extensionName]:y.offer()})),r.length){for(let g of r){if(typeof g!="string"||!Tv.test(g)||p.has(g))throw new SyntaxError("An invalid or duplicated subprotocol was specified");p.add(g)}i.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(s.username||s.password)&&(i.auth=`${s.username}:${s.password}`),l){let g=i.path.split(":");i.socketPath=g[0],i.path=g[1]}let _;if(i.followRedirects){if(t._redirects===0){t._originalIpc=l,t._originalSecure=a,t._originalHostOrSocketPath=l?i.socketPath:s.host;let g=n&&n.headers;if(n={...n,headers:{}},g)for(let[I,T]of Object.entries(g))n.headers[I.toLowerCase()]=T}else if(t.listenerCount("redirect")===0){let g=l?t._originalIpc?i.socketPath===t._originalHostOrSocketPath:!1:t._originalIpc?!1:s.host===t._originalHostOrSocketPath;(!g||t._originalSecure&&!a)&&(delete i.headers.authorization,delete i.headers.cookie,g||delete i.headers.host,i.auth=void 0)}i.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(i.auth).toString("base64")),_=t._req=d(i),t._redirects&&t.emit("redirect",t.url,_)}else _=t._req=d(i);i.timeout&&_.on("timeout",()=>{_e(t,_,"Opening handshake has timed out")}),_.on("error",g=>{_===null||_[sb]||(_=t._req=null,us(t,g))}),_.on("response",g=>{let I=g.headers.location,T=g.statusCode;if(I&&i.followRedirects&&T>=300&&T<400){if(++t._redirects>i.maxRedirects){_e(t,_,"Maximum redirects exceeded");return}_.abort();let R;try{R=new hu(I,e)}catch{let z=new SyntaxError(`Invalid URL: ${I}`);us(t,z);return}ob(t,R,r,n)}else t.emit("unexpected-response",_,g)||_e(t,_,`Unexpected server response: ${g.statusCode}`)}),_.on("upgrade",(g,I,T)=>{if(t.emit("upgrade",g),t.readyState!==H.CONNECTING)return;_=t._req=null;let R=g.headers.upgrade;if(R===void 0||R.toLowerCase()!=="websocket"){_e(t,I,"Invalid Upgrade header");return}let D=hv("sha1").update(f+yv).digest("base64");if(g.headers["sec-websocket-accept"]!==D){_e(t,I,"Invalid Sec-WebSocket-Accept header");return}let z=g.headers["sec-websocket-protocol"],x;if(z!==void 0?p.size?p.has(z)||(x="Server sent an invalid subprotocol"):x="Server sent a subprotocol but none was requested":p.size&&(x="Server sent no subprotocol"),x){_e(t,I,x);return}z&&(t._protocol=z);let de=g.headers["sec-websocket-extensions"];if(de!==void 0){if(!y){_e(t,I,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let te;try{te=Ev(de)}catch{_e(t,I,"Invalid Sec-WebSocket-Extensions header");return}let Re=Object.keys(te);if(Re.length!==1||Re[0]!==wt.extensionName){_e(t,I,"Server indicated an extension that was not requested");return}try{y.accept(te[wt.extensionName])}catch{_e(t,I,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[wt.extensionName]=y}t.setSocket(I,T,{allowSynchronousEvents:i.allowSynchronousEvents,generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})}),i.finishRequest?i.finishRequest(_,t):_.end()}o(ob,"initAsClient");function us(t,e){t._readyState=H.CLOSING,t.emit("error",e),t.emitClose()}o(us,"emitErrorAndClose");function Iv(t){return t.path=t.socketPath,nb.connect(t)}o(Iv,"netConnect");function Rv(t){return t.path=void 0,!t.servername&&t.servername!==""&&(t.servername=nb.isIP(t.host)?"":t.host),fv.connect(t)}o(Rv,"tlsConnect");function _e(t,e,r){t._readyState=H.CLOSING;let n=new Error(r);Error.captureStackTrace(n,_e),e.setHeader?(e[sb]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(us,t,n)):(e.destroy(n),e.once("error",t.emit.bind(t,"error")),e.once("close",t.emitClose.bind(t)))}o(_e,"abortHandshake");function yu(t,e,r){if(e){let n=xv(e).length;t._socket?t._sender._bufferedBytes+=n:t._bufferedAmount+=n}if(r){let n=new Error(`WebSocket is not open: readyState ${t.readyState} (${st[t.readyState]})`);process.nextTick(r,n)}}o(yu,"sendAfterClose");function Av(t,e){let r=this[fe];r._closeFrameReceived=!0,r._closeMessage=e,r._closeCode=t,r._socket[fe]!==void 0&&(r._socket.removeListener("data",fs),process.nextTick(ab,r._socket),t===1005?r.close():r.close(t,e))}o(Av,"receiverOnConclude");function Ov(){let t=this[fe];t.isPaused||t._socket.resume()}o(Ov,"receiverOnDrain");function zv(t){let e=this[fe];e._socket[fe]!==void 0&&(e._socket.removeListener("data",fs),process.nextTick(ab,e._socket),e.close(t[wv])),e.emit("error",t)}o(zv,"receiverOnError");function rb(){this[fe].emitClose()}o(rb,"receiverOnFinish");function Nv(t,e){this[fe].emit("message",t,e)}o(Nv,"receiverOnMessage");function kv(t){let e=this[fe];e._autoPong&&e.pong(t,!this._isServer,ib),e.emit("ping",t)}o(kv,"receiverOnPing");function Pv(t){this[fe].emit("pong",t)}o(Pv,"receiverOnPong");function ab(t){t.resume()}o(ab,"resume");function lb(){let t=this[fe];this.removeListener("close",lb),this.removeListener("data",fs),this.removeListener("end",cb),t._readyState=H.CLOSING;let e;!this._readableState.endEmitted&&!t._closeFrameReceived&&!t._receiver._writableState.errorEmitted&&(e=t._socket.read())!==null&&t._receiver.write(e),t._receiver.end(),this[fe]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",rb),t._receiver.on("finish",rb))}o(lb,"socketOnClose");function fs(t){this[fe]._receiver.write(t)||this.pause()}o(fs,"socketOnData");function cb(){let t=this[fe];t._readyState=H.CLOSING,t._receiver.end(),this.end()}o(cb,"socketOnEnd");function ub(){let t=this[fe];this.removeListener("error",ub),this.on("error",ib),t&&(t._readyState=H.CLOSING,this.destroy())}o(ub,"socketOnError")});var hb=m((zA,db)=>{"use strict";var{tokenChars:Dv}=Mn();function Cv(t){let e=new Set,r=-1,n=-1,i=0;for(i;i<t.length;i++){let a=t.charCodeAt(i);if(n===-1&&Dv[a]===1)r===-1&&(r=i);else if(i!==0&&(a===32||a===9))n===-1&&r!==-1&&(n=i);else if(a===44){if(r===-1)throw new SyntaxError(`Unexpected character at index ${i}`);n===-1&&(n=i);let l=t.slice(r,n);if(e.has(l))throw new SyntaxError(`The "${l}" subprotocol is duplicated`);e.add(l),r=n=-1}else throw new SyntaxError(`Unexpected character at index ${i}`)}if(r===-1||n!==-1)throw new SyntaxError("Unexpected end of input");let s=t.slice(r,i);if(e.has(s))throw new SyntaxError(`The "${s}" subprotocol is duplicated`);return e.add(s),e}o(Cv,"parse");db.exports={parse:Cv}});var _b=m((PA,mb)=>{"use strict";var Lv=require("events"),ds=require("http"),{Duplex:kA}=require("stream"),{createHash:qv}=require("crypto"),pb=du(),Dt=Bn(),Bv=hb(),Mv=bu(),{GUID:Uv,kWebSocket:jv}=yt(),Vv=/^[+/0-9A-Za-z]{22}==$/,gb=0,yb=1,wb=2,mu=class mu extends Lv{constructor(e,r){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:Mv,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=ds.createServer((n,i)=>{let s=ds.STATUS_CODES[426];i.writeHead(426,{"Content-Length":s.length,"Content-Type":"text/plain"}),i.end(s)}),this._server.listen(e.port,e.host,e.backlog,r)):e.server&&(this._server=e.server),this._server){let n=this.emit.bind(this,"connection");this._removeListeners=$v(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(i,s,a)=>{this.handleUpgrade(i,s,a,n)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=gb}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===wb){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick($n,this);return}if(e&&this.once("close",e),this._state!==yb)if(this._state=yb,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick($n,this):process.nextTick($n,this);else{let r=this._server;this._removeListeners(),this._removeListeners=this._server=null,r.close(()=>{$n(this)})}}shouldHandle(e){if(this.options.path){let r=e.url.indexOf("?");if((r!==-1?e.url.slice(0,r):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,r,n,i){r.on("error",bb);let s=e.headers["sec-websocket-key"],a=e.headers.upgrade,l=+e.headers["sec-websocket-version"];if(e.method!=="GET"){Ct(this,e,r,405,"Invalid HTTP method");return}if(a===void 0||a.toLowerCase()!=="websocket"){Ct(this,e,r,400,"Invalid Upgrade header");return}if(s===void 0||!Vv.test(s)){Ct(this,e,r,400,"Missing or invalid Sec-WebSocket-Key header");return}if(l!==8&&l!==13){Ct(this,e,r,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){Wn(r,400);return}let c=e.headers["sec-websocket-protocol"],u=new Set;if(c!==void 0)try{u=Bv.parse(c)}catch{Ct(this,e,r,400,"Invalid Sec-WebSocket-Protocol header");return}let f=e.headers["sec-websocket-extensions"],d={};if(this.options.perMessageDeflate&&f!==void 0){let p=new Dt(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let y=pb.parse(f);y[Dt.extensionName]&&(p.accept(y[Dt.extensionName]),d[Dt.extensionName]=p)}catch{Ct(this,e,r,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let p={origin:e.headers[`${l===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(p,(y,_,g,I)=>{if(!y)return Wn(r,_||401,g,I);this.completeUpgrade(d,s,u,e,r,n,i)});return}if(!this.options.verifyClient(p))return Wn(r,401)}this.completeUpgrade(d,s,u,e,r,n,i)}completeUpgrade(e,r,n,i,s,a,l){if(!s.readable||!s.writable)return s.destroy();if(s[jv])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>gb)return Wn(s,503);let u=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${qv("sha1").update(r+Uv).digest("base64")}`],f=new this.options.WebSocket(null,void 0,this.options);if(n.size){let d=this.options.handleProtocols?this.options.handleProtocols(n,i):n.values().next().value;d&&(u.push(`Sec-WebSocket-Protocol: ${d}`),f._protocol=d)}if(e[Dt.extensionName]){let d=e[Dt.extensionName].params,p=pb.format({[Dt.extensionName]:[d]});u.push(`Sec-WebSocket-Extensions: ${p}`),f._extensions=e}this.emit("headers",u,i),s.write(u.concat(`\r
`).join(`\r
`)),s.removeListener("error",bb),f.setSocket(s,a,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(f),f.on("close",()=>{this.clients.delete(f),this._shouldEmitClose&&!this.clients.size&&process.nextTick($n,this)})),l(f,i)}};o(mu,"WebSocketServer");var wu=mu;mb.exports=wu;function $v(t,e){for(let r of Object.keys(e))t.on(r,e[r]);return o(function(){for(let n of Object.keys(e))t.removeListener(n,e[n])},"removeListeners")}o($v,"addListeners");function $n(t){t._state=wb,t.emit("close")}o($n,"emitClose");function bb(){this.destroy()}o(bb,"socketOnError");function Wn(t,e,r,n){r=r||ds.STATUS_CODES[e],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},t.once("finish",t.destroy),t.end(`HTTP/1.1 ${e} ${ds.STATUS_CODES[e]}\r
`+Object.keys(n).map(i=>`${i}: ${n[i]}`).join(`\r
`)+`\r
\r
`+r)}o(Wn,"abortHandshake");function Ct(t,e,r,n,i){if(t.listenerCount("wsClientError")){let s=new Error(i);Error.captureStackTrace(s,Ct),t.emit("wsClientError",s,r,e)}else Wn(r,n,i)}o(Ct,"abortHandshakeOrEmitwsClientError")});var Tb={};Xu(Tb,{Receiver:()=>Eb.default,Sender:()=>xb.default,WebSocket:()=>_u.default,WebSocketServer:()=>vb.default,createWebSocketStream:()=>Sb.default,default:()=>Wv});var Sb,Eb,xb,_u,vb,Wv,Ib=ie(()=>{Sb=Pe(xy(),1),Eb=Pe(iu(),1),xb=Pe(ou(),1),_u=Pe(bu(),1),vb=Pe(_b(),1),Wv=_u.default});var Pb=m((CA,kb)=>{"use strict";var{Buffer:hs}=require("buffer"),Fv=Gf(),Su=Hp(),Ve=_t(),{DeferredPromise:Gv}=Ve,ps=pl(),{graphBinaryReader:Hv,graphBinaryWriter:Yv}=by(),Fn=jc(),Eu=Wc(),xu={success:200,noContent:204,partialContent:206,authenticationChallenge:407},Kv="application/vnd.gremlin-v3.0+json",Rb="application/vnd.gremlin-v2.0+json",Ab="application/vnd.graphbinary-v1.0",Ob="[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",ys,zb,bs,Nb,Gn,Hn,Yn,Kn,Xn,Tu,gr,gs,Iu=class Iu extends Fv{constructor(r,n){super();Ge(this,ys);Ge(this,bs);Ge(this,Xn);Ge(this,gr);Ge(this,Gn,o(()=>{this._openPromise.resolve(),this.isOpen=!0},"#handleOpen"));Ge(this,Hn,o(({error:r})=>{this._openPromise.reject(r),this.emit("log",`ws error ${r}`),ot(this,Xn,Tu).call(this,r),this.emit("socketError",r)},"#handleError"));Ge(this,Yn,o(({code:r,message:n})=>{this.emit("log",`ws close code=${r} message=${n}`),ot(this,Xn,Tu).call(this),this._closeCallback&&this._closeCallback(),this.emit("close",r,n)},"#handleClose"));Ge(this,Kn,o(({data:r})=>{let n=r instanceof ArrayBuffer?hs.from(r):r,i=this._reader.readResponse(n);if(i.requestId===null||i.requestId===void 0){Object.keys(this._responseHandlers).forEach(l=>{let c=this._responseHandlers[l];return ot(this,gr,gs).call(this,l),i.status!==void 0&&i.status.message?c.callback(new Eu(`Server error (no request information): ${i.status.message} (${i.status.code})`,i.status)):c.callback(new Eu(`Server error (no request information): ${JSON.stringify(i)}`,i.status))});return}i.requestId=i.requestId.toLowerCase();let s=this._responseHandlers[i.requestId];if(!s)return;if(i.status.code===xu.authenticationChallenge&&this._authenticator){this._authenticator.evaluateChallenge(i.result.data).then(l=>this.submit(void 0,"authentication",l,i.requestId)).catch(s.callback);return}else if(i.status.code>=400)return s.callback(new Eu(`Server error: ${i.status.message} (${i.status.code})`,i.status));let a=s.result instanceof Su.Readable;switch(i.status.code){case xu.noContent:return ot(this,gr,gs).call(this,i.requestId),a?(s.result.push(new Fn(Ve.emptyArray,i.status.attributes)),s.callback(null)):s.callback(null,new Fn(Ve.emptyArray,i.status.attributes));case xu.partialContent:if(a){s.result.push(new Fn(i.result.data,i.status.attributes));break}s.result=s.result||[],s.result.push.apply(s.result,i.result.data);break;default:return a?(s.result.push(new Fn(i.result.data,i.status.attributes)),s.callback(null)):(s.result?s.result.push.apply(s.result,i.result.data):s.result=i.result.data,ot(this,gr,gs).call(this,i.requestId),s.callback(null,new Fn(s.result,i.status.attributes)))}},"#handleMessage"));this.url=r,this.options=n=n||{},this.mimeType=n.mimeType||Kv,this._responseHandlers={},this._reader=n.reader||ot(this,ys,zb).call(this,this.mimeType),this._writer=n.writer||ot(this,bs,Nb).call(this,this.mimeType),this._openPromise=null,this._openCallback=null,this._closePromise=null,this._closeCallback=null,this._header=String.fromCharCode(this.mimeType.length)+this.mimeType,this._header_buf=hs.from(this._header),this.isOpen=!1,this.traversalSource=n.traversalSource||"g",this._authenticator=n.authenticator,this._enableUserAgentOnConnect=n.enableUserAgentOnConnect!==!1}async open(){if(this.isOpen)return;if(this._openPromise)return this._openPromise;this._openPromise=Gv(),this.emit("log","ws open");let r=this.options.headers;this._enableUserAgentOnConnect&&(r||(r=[]),await Ve.getUserAgent()!==void 0&&(r[Ve.getUserAgentHeader()]=await Ve.getUserAgent()));let n=globalThis.WebSocket??(await Promise.resolve().then(()=>(Ib(),Tb))).default;return this._ws=new n(this.url,globalThis.WebSocket===void 0?{headers:r,ca:this.options.ca,cert:this.options.cert,pfx:this.options.pfx,rejectUnauthorized:this.options.rejectUnauthorized,agent:this.options.agent}:void 0),"binaryType"in this._ws&&(this._ws.binaryType="arraybuffer"),this._ws.addEventListener("open",Fe(this,Gn)),this._ws.addEventListener("error",Fe(this,Hn)),this._ws.addEventListener("message",Fe(this,Kn)),this._ws.addEventListener("close",Fe(this,Yn)),await this._openPromise}submit(r,n,i,s){let a=(s||Ve.getUuid()).toLowerCase();if(!a.match(Ob))throw new Error('Provided requestId "'+a+'" is not a valid UUID.');return this.open().then(()=>new Promise((l,c)=>{n!=="authentication"&&(this._responseHandlers[a]={callback:(p,y)=>p?c(p):l(y),result:null});let u={requestId:a,op:n||"bytecode",processor:!r&&n!=="eval"?"traversal":r,args:i||{}},f=this._writer.writeRequest(u),d=Ve.toArrayBuffer(hs.concat([this._header_buf,f]));this._ws.send(d)}))}stream(r,n,i,s){let a=(s||Ve.getUuid()).toLowerCase();if(!a.match(Ob))throw new Error('Provided requestId "'+a+'" is not a valid UUID.');let l=new Su.Readable({objectMode:!0,read(){}});return this._responseHandlers[a]={callback:c=>c?l.destroy(c):l.push(null),result:l},this.open().then(()=>{let c={requestId:a,op:n||"bytecode",processor:!r&&n!=="eval"?"traversal":r,args:i||{}},u=this._writer.writeRequest(c),f=Ve.toArrayBuffer(hs.concat([this._header_buf,u]));this._ws.send(f)}).catch(c=>l.destroy(c)),l}close(){return this.isOpen===!1?Promise.resolve():(this._closePromise||(this._closePromise=new Promise(r=>{this._closeCallback=r,this._ws.close()})),this._closePromise)}};ys=new WeakSet,zb=o(function(r){return r===Ab?Hv:r===Rb?new ps.GraphSON2Reader:new ps.GraphSONReader},"#getDefaultReader"),bs=new WeakSet,Nb=o(function(r){return r===Ab?Yv:r===Rb?new ps.GraphSON2Writer:new ps.GraphSONWriter},"#getDefaultWriter"),Gn=new WeakMap,Hn=new WeakMap,Yn=new WeakMap,Kn=new WeakMap,Xn=new WeakSet,Tu=o(function(r){Object.keys(this._responseHandlers).forEach(n=>{let i=this._responseHandlers[n];if(i.result instanceof Su.Readable)i.callback(null);else{let a=r||new Error("Connection has been closed.");i.callback(a)}}),this._ws.removeEventListener("open",Fe(this,Gn)),this._ws.removeEventListener("error",Fe(this,Hn)),this._ws.removeEventListener("message",Fe(this,Kn)),this._ws.removeEventListener("close",Fe(this,Yn)),this._openPromise=null,this._closePromise=null,this.isOpen=!1},"#cleanupWebsocket"),gr=new WeakSet,gs=o(function(r){delete this._responseHandlers[r]},"#clearHandler"),o(Iu,"Connection");var vu=Iu;kb.exports=vu});var Ou=m((qA,Cb)=>{"use strict";var Xv=_t(),Jv=Pb(),Db=De(),Au=class Au{constructor(e,r={}){this._options=r,this._options.processor==="session"&&(this._options.session=r.session||Xv.getUuid()),this._options.session&&(this._options.processor=r.processor||"session"),this._connection=new Jv(e,r)}open(){return this._connection.open()}get isOpen(){return this._connection.isOpen}submit(e,r,n){let i=n&&n.requestId;i&&delete n.requestId;let s=Object.assign({gremlin:e,aliases:{g:this._options.traversalSource||"g"}},n);if(this._options.session&&this._options.processor==="session"&&(s.session=this._options.session),e instanceof Db)return this._options.session&&this._options.processor==="session"?this._connection.submit("session","bytecode",s,i):this._connection.submit("traversal","bytecode",s,i);if(typeof e=="string")return s.bindings=r,s.language="gremlin-groovy",s.accept=this._connection.mimeType,this._connection.submit(this._options.processor||"","eval",s,i);throw new TypeError("message must be of type Bytecode or string")}stream(e,r,n){let i=n&&n.requestId;i&&delete n.requestId;let s=Object.assign({gremlin:e,aliases:{g:this._options.traversalSource||"g"}},n);if(this._options.session&&this._options.processor==="session"&&(s.session=this._options.session),e instanceof Db)return this._options.session&&this._options.processor==="session"?this._connection.stream("session","bytecode",s,i):this._connection.stream("traversal","bytecode",s,i);if(typeof e=="string")return s.bindings=r,s.language="gremlin-groovy",s.accept=this._connection.mimeType,this._connection.stream(this._options.processor||"","eval",s,i);throw new TypeError("message must be of type Bytecode or string")}close(){if(this._options.session&&this._options.processor==="session"){let e={session:this._options.session};return this._connection.submit(this._options.processor,"close",e,null).then(()=>this._connection.close())}return this._connection.close()}addListener(e,r){this._connection.on(e,r)}removeListener(e,r){this._connection.removeListener(e,r)}};o(Au,"Client");var Ru=Au;Cb.exports=Ru});var Mb=m((MA,Bb)=>{"use strict";var qb=wr(),Zv=qb.RemoteConnection,Qv=qb.RemoteTraversal,eT=_t(),tT=Ou(),Lb=De(),rT=Ye().OptionsStrategy,ws=class ws extends Zv{constructor(e,r={}){super(e,r),this._client=new tT(e,r)}open(){return this._client.open()}get isOpen(){return this._client.isOpen}submit(e){let r=e.sourceInstructions.find(s=>s[0]==="withStrategies"&&s[1]instanceof rT),n=["evaluationTimeout","scriptEvaluationTimeout","batchSize","requestId","userAgent","materializeProperties"],i;if(r!==void 0){i={};let s=r[1].configuration;for(let a in s)s.hasOwnProperty(a)&&n.indexOf(a)>-1&&(i[a]=s[a])}return this._client.submit(e,null,i).then(s=>new Qv(s.toArray()))}createSession(){if(this.isSessionBound)throw new Error("Connection is already bound to a session - child sessions are not allowed");let e=Object.assign({},this.options);return e.session=eT.getUuid(),new ws(this.url,e)}get isSessionBound(){return this.options.session}commit(){return this._client.submit(Lb.GraphOp.commit,null)}rollback(){return this._client.submit(Lb.GraphOp.rollback,null)}close(){return this._client.close()}addListener(...e){return this._client.addListener(...e)}removeListener(...e){return this._client.removeListener(...e)}};o(ws,"DriverRemoteConnection");var zu=ws;Bb.exports=zu});var Pu=m((jA,Ub)=>{"use strict";var ku=class ku{constructor(e){this._options=e}evaluateChallenge(e){throw new Error("evaluateChallenge should be implemented")}};o(ku,"Authenticator");var Nu=ku;Ub.exports=Nu});var Vb=m(($A,jb)=>{"use strict";var Cu=class Cu{constructor(e){this.setopts(e)}get name(){return null}setopts(e){this._options=e}evaluateChallenge(e){throw new Error("evaluateChallenge should be implemented")}};o(Cu,"SaslMechanismBase");var Du=Cu;jb.exports=Du});var Wb=m((FA,$b)=>{"use strict";var{Buffer:nT}=require("buffer"),iT=Vb(),qu=class qu extends iT{constructor(e){if(super(e),this._options.username===void 0||this._options.username===null||this._options.username.length===0||this._options.password===void 0||this._options.password===null||this._options.password.length===0)throw new Error("Missing credentials for SASL PLAIN mechanism")}get name(){return"PLAIN"}evaluateChallenge(e){return this._hasInitialResponse(e)?Promise.resolve({saslMechanism:this.name,sasl:this._saslArgument(this._options.authzid,this._options.username,this._options.password)}):Promise.resolve({sasl:this._saslArgument(this._options.authzid,this._options.username,this._options.password)})}_saslArgument(e,r,n){return e==null&&(e=""),r==null&&(r=""),(n===void 0||n.length===null)&&(n=""),nT.from(`${e}\0${r}\0${n}`).toString("base64")}_hasInitialResponse(e){return e!=null}};o(qu,"SaslMechanismPlain");var Lu=qu;$b.exports=Lu});var Gb=m((HA,Fb)=>{"use strict";var sT=Pu(),oT=Wb(),Mu=class Mu extends sT{constructor(e,r,n){let i={mechanism:new oT({username:e,password:r,authzid:n})};super(i)}evaluateChallenge(e){return this._options.mechanism.evaluateChallenge(e)}};o(Mu,"PlainTextSaslAuthenticator");var Bu=Mu;Fb.exports=Bu});var Yb=m((KA,Hb)=>{"use strict";var aT=ri(),lT=Ye().TraversalStrategies,cT=aT.GraphTraversalSource,uT=Ke().Graph,ms=class ms{constructor(e){this.traversalSourceClass=e}static traversal(e){return new ms(e||cT)}withRemote(e){return this.withGraph(new uT).withRemote(e)}withGraph(e){return new this.traversalSourceClass(e,new lT)}};o(ms,"AnonymousTraversalSource");var Uu=ms;Hb.exports=Uu});var Zb=m((JA,Jb)=>{"use strict";var ee=me(),ju=ri(),Kb=Ye(),yr=Ke(),fT=pl(),Vu=wr(),dT=De(),hT=Wf(),pT=_t(),gT=Mb(),yT=Wc(),bT=Ou(),wT=jc(),mT=Pu(),_T=Gb(),Xb=Yb();Jb.exports={driver:{RemoteConnection:Vu.RemoteConnection,RemoteStrategy:Vu.RemoteStrategy,RemoteTraversal:Vu.RemoteTraversal,ResponseError:yT,DriverRemoteConnection:gT,Client:bT,ResultSet:wT,auth:{Authenticator:mT,PlainTextSaslAuthenticator:_T}},process:{Bytecode:dT,EnumValue:ee.EnumValue,P:ee.P,TextP:ee.TextP,Traversal:ee.Traversal,TraversalSideEffects:ee.TraversalSideEffects,TraversalStrategies:Kb.TraversalStrategies,TraversalStrategy:Kb.TraversalStrategy,Traverser:ee.Traverser,barrier:ee.barrier,cardinality:ee.cardinality,column:ee.column,direction:ee.direction,dt:ee.dt,merge:ee.merge,operator:ee.operator,order:ee.order,pick:ee.pick,pop:ee.pop,scope:ee.scope,t:ee.t,GraphTraversal:ju.GraphTraversal,GraphTraversalSource:ju.GraphTraversalSource,statics:ju.statics,Translator:hT,traversal:Xb.traversal,AnonymousTraversalSource:Xb,withOptions:ee.withOptions},structure:{io:fT,Edge:yr.Edge,Graph:yr.Graph,Path:yr.Path,Property:yr.Property,Vertex:yr.Vertex,VertexProperty:yr.VertexProperty,toLong:pT.toLong}}});var tw=m((ZA,ew)=>{"use strict";var $u=require("fs"),Qb=Zb(),Wu=!1,J,Ie="g",Fu="single";ew.exports=t=>{let e=o(async(h,w)=>{if(h.ssh){let{options:E}=await w.openTunnel({sshAuthMethod:h.ssh_method==="privateKey"?"IDENTITY_FILE":"USER_PASSWORD",sshTunnelHostname:h.ssh_host,sshTunnelPort:h.ssh_port,sshTunnelUsername:h.ssh_user,sshTunnelPassword:h.ssh_password,sshTunnelIdentityFile:h.ssh_key_file,sshTunnelPassphrase:h.ssh_key_passphrase,host:h.host,port:h.port});Wu=!0,h={...h,...E}}return r(h)},"connect"),r=o(h=>new Promise((w,E)=>{let v=h.host,O=h.port,A=h.username,k=h.password,G=h.traversalSource||"g",ge=A&&k,K=yw(h),ne=t.isEmpty(K)?"ws":"wss",$e=ge?new Qb.driver.auth.PlainTextSaslAuthenticator(A,k):void 0;J=new Qb.driver.Client(`${ne}://${v}:${O}/gremlin`,Object.assign({authenticator:$e,traversalSource:G},K)),J.open().then(We=>{Ie=G,w()}).catch(We=>{E(We)})}),"connectToInstance"),n=o(()=>J?J.submit(`${Ie}.V().next()`):Promise.reject("Connection error"),"testConnection"),i=o(async h=>{J&&(J.close(),J=null),Wu&&(await h.closeConsumer(),Wu=!1)},"close"),s=o(()=>J.submit(`${Ie}.V().label().dedup().toList()`).then(h=>h.toArray()),"getLabels"),a=o((h,w=100)=>Promise.all(h.map(E=>J.submit(`${Ie}.V().hasLabel('${E}').outE().limit(${w}).as('edge').inV().as('end')
				.select('edge', 'end').by(label).dedup().toList()`).then(v=>{let O=t.first(v.toArray());return O?{start:E,relationship:O.get("edge"),end:O.get("end")}:{}}))),"getRelationshipSchema"),l=o(()=>Promise.resolve(Ie),"getDatabaseName"),c=o(h=>Array.from(h).reduce((w,[E,v])=>{if(!t.isString(E))return w;let O=t.isArray(v)?t.first(v):v;return t.isMap(O)?Object.assign(w,{[E]:u(O)}):Object.assign(w,{[E]:O})},{}),"getItemProperties"),u=o(h=>Array.from(h).reduce((w,[E,v])=>t.isMap(v)?Object.assign(w,{[E]:u(v)}):Object.assign(w,{[E]:v}),{}),"handleMap"),f=o((h,w=100)=>J.submit(`${Ie}.V().hasLabel('${h}').limit(${w}).valueMap(true).toList()`).then(E=>E.toArray().map(c)),"getNodes"),d=o((h,w,E,v=100)=>J.submit(`${Ie}.E().hasLabel('${w}').where(and(
				outV().label().is(eq('${h}')),
				inV().label().is(eq('${E}')))
			).limit(${v}).valueMap(true).toList()`).then(O=>O.toArray().map(c)).then(O=>Ku("E",O,w,v)),"getRelationshipData"),p=o(h=>J.submit(`${Ie}.V().hasLabel('${h}').count().next()`).then(w=>w.first()),"getNodesCount"),y=o((h,w,E)=>J.submit(`${Ie}.E().hasLabel('${w}').where(and(
			outV().label().is(eq('${h}')),
			inV().label().is(eq('${E}')))
		).count().next()`).then(v=>v.toArray()),"getCountRelationshipsData"),_=o(()=>Promise.all([J.submit("graph.getIndexedKeys(Vertex)"),J.submit("graph.getIndexedKeys(Edge)")]).then(h=>{let w=h[0].toArray(),E=h[1].toArray(),v=w.map(A=>({name:A,elementType:"Vertex",propertyName:A})),O=E.map(A=>({name:A,elementType:"Edge",propertyName:A}));return v.concat(O)}),"getIndexes"),g=o(()=>J.submit("graph.features()").then(h=>{let w=h.first();return t.isString(w)?w.slice(9):""}),"getFeatures"),I=o(()=>T("").then(h=>{Fu=h}),"setDefaultCardinality"),T=o(h=>J.submit(`graph.features().vertex().getCardinality("${h}")`).then(w=>{let E=["single","list","set"],v=w.first();return E.includes(v)?v:"single"},()=>Fu),"getCardinality"),R=o(()=>J.submit("graph.variables().asMap()").then(h=>h.toArray().map(u).map(O=>{let A=t.first(Object.keys(O)),k=O[A],G=t.isString(k)?k:JSON.stringify(O[A]);return{graphVariableKey:A,GraphVariableValue:G}})),"getVariables"),D=o((h,w)=>{let E=w["@value"];if(w["@type"]!=="g:List"||!t.isArray(E))return Object.assign({},qt(w),{propCardinality:h});if(E.length===1)return Object.assign({},qt(t.first(E)),{propCardinality:h});let v=h==="single"?"list":h;return{type:"multi-property",items:E.map(O=>Object.assign({},qt(O),{propCardinality:v})),propCardinality:v}},"convertRootPropertyValue"),z=o(h=>h.oneOf,"isChoice"),x=o((h,w)=>{let E=!1,v=h.oneOf.map(O=>O.type===w.type?(E=!0,Ee(O,w)):O);return E?Object.assign({},h,{oneOf:v}):Object.assign({},h,{oneOf:v.concat(w)})},"addSubtype"),de=o(h=>({type:"choice",oneOf:[h]}),"convertToChoice"),te=o(h=>w=>{if(t.get(w,"@type")!=="g:Map")return{};let E=w["@value"],{keys:v,values:O}=E.reduce(({keys:A,values:k},G,ge)=>{if(ge%2){let K=t.get(h,t.last(A),Fu);return{keys:A,values:[...k,D(K,G)]}}return t.isObject(G)?{keys:A,values:k}:{keys:[...A,G+""],values:k}},{keys:[],values:[]});return{properties:v.reduce((A,k,G)=>Object.assign({},A,{[k]:O[G]||{}}),{})}},"convertRootGraphSON"),Re=o(h=>h.reduce(Ee,{}),"mergeJsonSchemas"),Y=o((h,w)=>t.isEmpty(h.properties)&&t.isEmpty(w.properties)?{}:(t.isEmpty(h.properties)&&(h.properties={}),t.isEmpty(w.properties)&&(w.properties={}),{properties:t.uniq([...Object.keys(h.properties),...Object.keys(w.properties)]).reduce((O,A)=>{let k=Ee(h.properties[A],w.properties[A]);return Object.assign({},O,{[A]:k})},{})}),"getMergedProperties"),we=o((h,w)=>t.isEmpty(h.items)&&t.isEmpty(w.items)?{}:(t.isEmpty(h.items)&&(h.items=[]),t.isEmpty(w.items)&&(w.items=[]),{items:t.uniqBy(h.items.concat(w.items),"type")}),"getMergedItems"),Lt=o(h=>{let w=h.type;return w?["list","set","map"].includes(w):!1},"isComplexType"),Ss=o((h,w)=>{if(z(h))return x(h,w);if(t.isArray(h.type)&&!Lt(w))return h.type.includes(w.type)?h:Object.assign({},h,{type:h.type.concat(w.type)});if(!t.isComplexType(h)&&!Lt(w))return Object.assign({},h,{type:[h.type,w.type]});let E=de(h);return x(E,w)},"mergeTypes"),Ee=o((h,w)=>{t.isEmpty(h)&&(h={}),t.isEmpty(w)&&(w={});let E=Y(h,w),v=we(h,w),A=h.type&&w.type&&h.type!==w.type?Ss(h,w):Object.assign({},h,w);return Object.assign({},A,v,E)},"mergeSchemas"),Hu=o((h,w="")=>({type:"choice",choice:"oneOf",items:h.oneOf.map(E=>({type:"subschema",properties:{[w]:E}}))}),"handleChoice"),iw=o(h=>{if(!h.properties)return h;let w=Object.keys(h.properties).reduce((E,v)=>{let O=h.properties[v],A=Jn(O);return z(O)?Object.assign({},E,{[v]:Hu(A,v)}):Object.assign({},E,{[v]:Jn(A)})},{});return Object.assign({},h,{properties:w})},"handleChoicesInProperties"),sw=o(h=>{if(!h.items)return h;let w=h.items.map(E=>{let v=Jn(E);return z(v)?Hu(v):v});return Object.assign({},h,{items:w})},"handleChoicesInItems"),ow=o(h=>t.isUndefined(h)?"":t.isString(h)?h:JSON.stringify(h),"convertMetaPropertySample"),aw=o(h=>{if(t.get(h,"@type")!=="g:Map")return{};let w=h["@value"],E=w[1],v=w[3];if(t.get(v,"@type")!=="g:Map")return{};let{keys:O,values:A,samples:k}=v["@value"].reduce(({keys:K,values:ne,samples:$e},We,Es)=>Es%2?{keys:K,values:[...ne,qt(We)],samples:[...$e,ow(We["@value"])]}:t.isObject(We)?{keys:K,values:ne,samples:$e}:{keys:[...K,We+""],values:ne,samples:$e},{keys:[],values:[],samples:[]}),G=A.map(K=>K.type),ge=O.map((K,ne)=>({metaPropName:K,metaPropType:G[ne]||"map",metaPropSample:k[ne]}));return{[E]:ge}},"convertMetaProperty"),lw=o((h,w)=>{let E=h.properties,v=w.reduce((A,k)=>{let G=Object.keys(k).reduce((ge,K)=>{let ne=t.get(ge,K,[]);return Object.assign({},ge,{[K]:ne.concat(k[K])})},{});return t.merge({},A,G)},{}),O=Object.keys(v).reduce((A,k)=>{let G=v[k];if(t.isEmpty(G)||!A[k])return A;if(A[k].type!=="multi-property"){let ne=t.get(A[k],"metaProperties",[]);return Object.assign({},A,{[k]:Object.assign({},A[k],{metaProperties:ne.concat(G)})})}let ge=t.get(A,[k,"items"],[]);if(t.isEmpty(ge))return A;let K=ge.map(ne=>{let $e=t.get(ne,"metaProperties",[]);return Object.assign({},ne,{metaProperties:$e.concat(G)})});return Object.assign({},A,{[k]:Object.assign({},A[k],{items:K})})},E);return Object.assign({},h,{properties:O})},"addMetaProperties"),Jn=t.flow([iw,sw]),Yu=o(h=>J.submit(`GraphSONMapper.build().version(GraphSONVersion.V3_0).create().createMapper().writeValueAsString(${h})`),"submitGraphSONDataScript"),cw=o((h,w,E)=>`${Ie}.${h}().hasLabel('${w}').limit(${E}).valueMap().toList()`,"getDataQuery"),uw=o((h,w)=>`${Ie}.V().hasLabel('${h}').limit(${w}).properties().as('properties').
			as('metaProperties').select('properties','metaProperties').by(label).by(valueMap()).dedup().toList()`,"getMetaPropertiesDataQuery"),fw=o((h,w,E)=>h!=="V"?Promise.resolve({first:()=>({})}):Yu(uw(w,E)),"getMetaPropertiesData"),dw=o(h=>I().then(()=>Promise.all(h.map(w=>T(w).then(E=>({[w]:E}))))),"getPropertiesCardinality"),Ku=o((h,w,E,v=100)=>Yu(cw(h,E,v)).then(O=>fw(h,E,v).then(A=>J.submit(`${Ie}.${h}().hasLabel('${E}').limit(${v}).properties().order().by(id).label().dedup().toList()`).then(k=>({metaProperties:A.first(),documentsGraphSONSchema:O.first(),template:k.toArray()})).catch(k=>({metaProperties:A.first(),documentsGraphSONSchema:O.first(),template:[]})))).then(({documentsGraphSONSchema:O,metaProperties:A,template:k})=>dw(k).then(G=>({propertiesCardinality:Object.assign({},...G),documentsGraphSONSchema:O,metaProperties:A,template:k}),()=>({}))).then(({documentsGraphSONSchema:O,metaProperties:A,template:k,propertiesCardinality:G})=>{try{let ge=JSON.parse(O)["@value"],K=JSON.parse(A)["@value"],ne=ge.map(te(G)),$e=K.map(aw),We=Re(ne),Es=lw(We,$e);return{documents:w,schema:Jn(Es),template:k}}catch{return{documents:w,schema:{},template:[]}}}),"getSchema"),hw=o(h=>{switch(h){case"g:List":return{type:"list"};case"g:Map":return{type:"map"};case"g:Set":return{type:"set"};case"g:Double":return{type:"number",mode:"double"};case"g:Int32":return{type:"number",mode:"integer"};case"g:Int64":return{type:"number",mode:"long"};case"g:Float":return{type:"number",mode:"float"};case"g:Timestamp":return{type:"timestamp"};case"g:Date":return{type:"date"};case"g:UUID":return{type:"uuid"};default:return{type:"map"}}},"getType"),pw=o(h=>{let{keys:w,values:E}=h.reduce(({keys:v,values:O},A,k)=>k%2?{keys:v,values:[...O,qt(A)]}:{keys:[...v,A+""],values:O},{keys:[],values:[]});return w.reduce((v,O,A)=>Object.assign({},v,{[O]:E[A]||{}}),{})},"groupPropertiesForMap"),gw=o(h=>h.map(qt),"getItems"),qt=o(h=>{if(!t.isPlainObject(h))return{type:typeof h,sample:h};let w=h["@type"],{type:E,mode:v}=hw(w),O=h["@value"];if(w==="g:Map"){let A=pw(O);return{type:E,properties:A}}if(w==="g:List"||w==="g:Set"){let A=gw(O);return{type:E,items:A}}return v?{type:E,mode:v,sample:O}:{type:E,sample:O}},"convertGraphSonToSchema"),yw=o(h=>{let w={rejectUnauthorized:!1};switch(h.sslType){case"TRUST_ALL_CERTIFICATES":case"TRUST_SYSTEM_CA_SIGNED_CERTIFICATES":return w;case"TRUST_CUSTOM_CA_SIGNED_CERTIFICATES":{let E=$u.readFileSync(h.certAuthority,"utf8");return w.ca=[E],w}case"TRUST_SERVER_CLIENT_CERTIFICATES":{let E=$u.readFileSync(h.pfx),v=$u.readFileSync(h.certAuthority,"utf8");return w.ca=[v],w.pfx=E,w}case"Off":default:return{}}},"getSSLConfig");return{connect:e,testConnection:n,close:i,getLabels:s,getRelationshipData:d,getRelationshipSchema:a,getDatabaseName:l,getNodes:f,getNodesCount:p,getCountRelationshipsData:y,getIndexes:_,getFeatures:g,getVariables:R,getSchema:Ku}}});var _s,F,Se=tw();module.exports={connect:function(t,e,r,n,i){n.clear(),n.log("info",e,"connectionInfo",e.hiddenKeys),Se(t).connect(e,r).then(i,i)},disconnect:function(t,e,r){let n=r.require("@hackolade/ssh-service");Se(F).close(n),e()},testConnection:function(t,e,r,n){let i=n.require("@hackolade/ssh-service");F=n.require("lodash"),this.connect(F,t,i,e,s=>{if(s){r({message:"Connection error",stack:s.stack});return}Se(F).testConnection().then(()=>{this.disconnect(t,()=>{},n),r()}).catch(a=>{this.disconnect(t,()=>{},n),e.log("error",Gu(a)),r({message:"Connection error",stack:a.stack})})})},getDatabases:function(t,e,r){r()},getDocumentKinds:function(t,e,r){r()},getDbCollectionsNames:function(t,e,r,n){let i=n.require("@hackolade/ssh-service");F=n.require("lodash");let s={dbName:"",dbCollections:""},a=Se(F);a.connect(t,i).then(()=>a.getLabels(),l=>r({message:"Connection error",stack:l.stack})).then(l=>{s.dbCollections=l}).then(()=>a.getDatabaseName()).then(l=>{s.dbName=l,r(null,[s])}).catch(l=>{r(l||"error")})},getDbCollectionsData:function(t,e,r,n){F=n.require("lodash"),_s=n.require("async"),e.clear(),e.log("info",t,"connectionInfo",t.hiddenKeys);let i=t.collectionData.collections,s=t.collectionData.dataBaseNames,a=t.fieldInference,l=t.includeEmptyCollection,c=t.recordSamplingSettings,u={labels:[],relationships:[]};_s.map(s,(f,d)=>{let p=i[f],y={};Se(F).getFeatures().then(_=>{y.features=_}).then(()=>Se(F).getVariables()).then(_=>{y.variables=_}).then(()=>Se(F).getIndexes()).then(_=>(e.progress({message:"Indexes successfully retrieved",containerName:f,entityName:""}),y.indexes=_,y)).then(_=>ET(f,p,e,{recordSamplingSettings:c,fieldInference:a,includeEmptyCollection:l,indexes:_.indexes,features:_.features,variables:_.variables})).then(_=>(u.labels.push(_),p=_.reduce((g,I)=>g.concat([I.collectionName]),[]),Se(F).getRelationshipSchema(p))).then(_=>_.filter(g=>p.indexOf(g.start)!==-1&&p.indexOf(g.end)!==-1)).then(_=>vT(_,f,c,a)).then(_=>{u.relationships.push(_),d(null)}).catch(_=>{e.log("error",Gu(_),"Error"),d(Gu(_))})},f=>{r(f,u.labels,{},[].concat.apply([],u.relationships))})}};var rw=o((t,e)=>{if(e.active==="absolute")return Number(e.absolute.value);let r=Math.ceil(t*e.relative.value/100);return Math.min(r,e.maxValue)},"getSampleDocSize"),ST=o(t=>Array.isArray(t)?t.reduce((e,r)=>e&&F.isEmpty(r),!0):!0,"isEmptyLabel"),nw=o((t,e=[])=>{let r=e.reduce((n,i)=>Object.assign({},n,{[i]:{}}),{});return F.isArray(t)?t.reduce((n,i)=>F.merge(n,i),r):r},"getTemplate"),ET=o((t,e,r,n)=>new Promise((i,s)=>{let a=[];_s.map(e,(l,c)=>{r.progress({message:"Start sampling data",containerName:t,entityName:l}),Se(F).getNodesCount(l).then(u=>{r.progress({message:"Start getting data from graph",containerName:t,entityName:l});let f=rw(u,n.recordSamplingSettings);return Se(F).getNodes(l,f).then(d=>({limit:f,documents:d}))}).then(({documents:u,limit:f})=>Se(F).getSchema("V",u,l,f)).then(({documents:u,schema:f,template:d})=>{r.progress({message:"Data successfully retrieved",containerName:t,entityName:l});let p=TT({dbName:t,labelName:l,documents:u,schema:f,template:d,includeEmptyCollection:n.includeEmptyCollection,fieldInference:n.fieldInference,indexes:n.indexes,features:n.features,variables:n.variables});p&&a.push(p),c(null)}).catch(c)},l=>{if(l)s(l);else{let c=xT(e,a);i(c)}})}),"getNodesData"),xT=o((t,e)=>[...e].sort((r,n)=>{let i=F.indexOf(t,r.collectionName),s=F.indexOf(t,n.collectionName);return F.isUndefined(i)?1:F.isUndefined(s)?-1:i-s}),"sortPackagesByLabels"),vT=o((t,e,r,n)=>new Promise((i,s)=>{_s.map(t,(a,l)=>{Se(F).getCountRelationshipsData(a.start,a.relationship,a.end).then(c=>{let u=rw(c,r);return Se(F).getRelationshipData(a.start,a.relationship,a.end,u)}).then(({documents:c,schema:u,template:f})=>{let d={dbName:e,parentCollection:a.start,relationshipName:a.relationship,childCollection:a.end,documents:c,validation:{jsonSchema:u}};n.active==="field"&&(d.documentTemplate=nw(c,f)),l(null,d)}).catch(l)},(a,l)=>{a?s(a):i(l)})}),"getRelationshipData"),TT=o(({dbName:t,labelName:e,documents:r,template:n,schema:i,includeEmptyCollection:s,fieldInference:a,indexes:l,features:c,variables:u})=>{let f={dbName:t,collectionName:e,documents:r,views:[],emptyBucket:!1,validation:{jsonSchema:i},bucketInfo:{indexes:l,features:c,graphVariables:u,traversalSource:t}};return a.active==="field"&&(f.documentTemplate=nw(r,n)),s||!ST(r)?f:null},"getLabelPackage"),Gu=o(t=>({message:t.message,stack:t.stack}),"prepareError");
